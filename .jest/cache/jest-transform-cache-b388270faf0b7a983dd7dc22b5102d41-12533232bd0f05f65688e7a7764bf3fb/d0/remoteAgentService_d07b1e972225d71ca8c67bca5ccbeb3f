0558f69ab44e166112749ce7dbeb0b79
/* istanbul ignore next */
function cov_gmjs4kpfh() {
  var path = "/home/user/Desktop/MintMind/src/vs/workbench/services/remote/common/remoteAgentService.ts";
  var hash = "ef263ac632f32b6b89a5db2355a4b5b491c9c2d7";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "/home/user/Desktop/MintMind/src/vs/workbench/services/remote/common/remoteAgentService.ts",
    statementMap: {
      "0": {
        start: {
          line: 7,
          column: 35
        },
        end: {
          line: 7,
          column: 72
        }
      },
      "1": {
        start: {
          line: 8,
          column: 47
        },
        end: {
          line: 71,
          column: 1
        }
      },
      "2": {
        start: {
          line: 9,
          column: 21
        },
        end: {
          line: 9,
          column: 22
        }
      },
      "3": {
        start: {
          line: 10,
          column: 18
        },
        end: {
          line: 10,
          column: 22
        }
      },
      "4": {
        start: {
          line: 11,
          column: 14
        },
        end: {
          line: 11,
          column: 16
        }
      },
      "5": {
        start: {
          line: 12,
          column: 22
        },
        end: {
          line: 12,
          column: 23
        }
      },
      "6": {
        start: {
          line: 13,
          column: 14
        },
        end: {
          line: 13,
          column: 16
        }
      },
      "7": {
        start: {
          line: 14,
          column: 22
        },
        end: {
          line: 14,
          column: 25
        }
      },
      "8": {
        start: {
          line: 15,
          column: 26
        },
        end: {
          line: 15,
          column: 27
        }
      },
      "9": {
        start: {
          line: 16,
          column: 30
        },
        end: {
          line: 16,
          column: 33
        }
      },
      "10": {
        start: {
          line: 17,
          column: 30
        },
        end: {
          line: 17,
          column: 34
        }
      },
      "11": {
        start: {
          line: 18,
          column: 22
        },
        end: {
          line: 18,
          column: 31
        }
      },
      "12": {
        start: {
          line: 19,
          column: 20
        },
        end: {
          line: 19,
          column: 48
        }
      },
      "13": {
        start: {
          line: 21,
          column: 29
        },
        end: {
          line: 21,
          column: 37
        }
      },
      "14": {
        start: {
          line: 23,
          column: 8
        },
        end: {
          line: 30,
          column: 9
        }
      },
      "15": {
        start: {
          line: 23,
          column: 21
        },
        end: {
          line: 23,
          column: 22
        }
      },
      "16": {
        start: {
          line: 24,
          column: 24
        },
        end: {
          line: 24,
          column: 67
        }
      },
      "17": {
        start: {
          line: 25,
          column: 12
        },
        end: {
          line: 27,
          column: 13
        }
      },
      "18": {
        start: {
          line: 26,
          column: 16
        },
        end: {
          line: 26,
          column: 33
        }
      },
      "19": {
        start: {
          line: 28,
          column: 12
        },
        end: {
          line: 28,
          column: 111
        }
      },
      "20": {
        start: {
          line: 29,
          column: 12
        },
        end: {
          line: 29,
          column: 44
        }
      },
      "21": {
        start: {
          line: 32,
          column: 8
        },
        end: {
          line: 32,
          column: 42
        }
      },
      "22": {
        start: {
          line: 33,
          column: 8
        },
        end: {
          line: 35,
          column: 9
        }
      },
      "23": {
        start: {
          line: 34,
          column: 12
        },
        end: {
          line: 34,
          column: 33
        }
      },
      "24": {
        start: {
          line: 37,
          column: 29
        },
        end: {
          line: 37,
          column: 38
        }
      },
      "25": {
        start: {
          line: 38,
          column: 8
        },
        end: {
          line: 43,
          column: 9
        }
      },
      "26": {
        start: {
          line: 39,
          column: 12
        },
        end: {
          line: 39,
          column: 46
        }
      },
      "27": {
        start: {
          line: 42,
          column: 12
        },
        end: {
          line: 42,
          column: 103
        }
      },
      "28": {
        start: {
          line: 42,
          column: 65
        },
        end: {
          line: 42,
          column: 76
        }
      },
      "29": {
        start: {
          line: 45,
          column: 8
        },
        end: {
          line: 68,
          column: 10
        }
      },
      "30": {
        start: {
          line: 48,
          column: 57
        },
        end: {
          line: 48,
          column: 68
        }
      },
      "31": {
        start: {
          line: 57,
          column: 16
        },
        end: {
          line: 59,
          column: 17
        }
      },
      "32": {
        start: {
          line: 58,
          column: 20
        },
        end: {
          line: 58,
          column: 33
        }
      },
      "33": {
        start: {
          line: 60,
          column: 16
        },
        end: {
          line: 62,
          column: 17
        }
      },
      "34": {
        start: {
          line: 61,
          column: 20
        },
        end: {
          line: 61,
          column: 32
        }
      },
      "35": {
        start: {
          line: 63,
          column: 16
        },
        end: {
          line: 65,
          column: 17
        }
      },
      "36": {
        start: {
          line: 64,
          column: 20
        },
        end: {
          line: 64,
          column: 32
        }
      },
      "37": {
        start: {
          line: 66,
          column: 16
        },
        end: {
          line: 66,
          column: 29
        }
      },
      "38": {
        start: {
          line: 69,
          column: 8
        },
        end: {
          line: 69,
          column: 36
        }
      }
    },
    fnMap: {
      "0": {
        name: "(anonymous_0)",
        decl: {
          start: {
            line: 19,
            column: 4
          },
          end: {
            line: 19,
            column: 5
          }
        },
        loc: {
          start: {
            line: 19,
            column: 18
          },
          end: {
            line: 19,
            column: 50
          }
        },
        line: 19
      },
      "1": {
        name: "(anonymous_1)",
        decl: {
          start: {
            line: 20,
            column: 4
          },
          end: {
            line: 20,
            column: 5
          }
        },
        loc: {
          start: {
            line: 20,
            column: 38
          },
          end: {
            line: 70,
            column: 5
          }
        },
        line: 20
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 42,
            column: 49
          },
          end: {
            line: 42,
            column: 50
          }
        },
        loc: {
          start: {
            line: 42,
            column: 65
          },
          end: {
            line: 42,
            column: 76
          }
        },
        line: 42
      },
      "3": {
        name: "(anonymous_3)",
        decl: {
          start: {
            line: 48,
            column: 41
          },
          end: {
            line: 48,
            column: 42
          }
        },
        loc: {
          start: {
            line: 48,
            column: 57
          },
          end: {
            line: 48,
            column: 68
          }
        },
        line: 48
      },
      "4": {
        name: "(anonymous_4)",
        decl: {
          start: {
            line: 49,
            column: 19
          },
          end: {
            line: 49,
            column: 20
          }
        },
        loc: {
          start: {
            line: 49,
            column: 25
          },
          end: {
            line: 67,
            column: 13
          }
        },
        line: 49
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 25,
            column: 12
          },
          end: {
            line: 27,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 25,
            column: 12
          },
          end: {
            line: 27,
            column: 13
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 25
      },
      "1": {
        loc: {
          start: {
            line: 33,
            column: 8
          },
          end: {
            line: 35,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 33,
            column: 8
          },
          end: {
            line: 35,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 33
      },
      "2": {
        loc: {
          start: {
            line: 38,
            column: 8
          },
          end: {
            line: 43,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 38,
            column: 8
          },
          end: {
            line: 43,
            column: 9
          }
        }, {
          start: {
            line: 41,
            column: 13
          },
          end: {
            line: 43,
            column: 9
          }
        }],
        line: 38
      },
      "3": {
        loc: {
          start: {
            line: 57,
            column: 16
          },
          end: {
            line: 59,
            column: 17
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 57,
            column: 16
          },
          end: {
            line: 59,
            column: 17
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 57
      },
      "4": {
        loc: {
          start: {
            line: 60,
            column: 16
          },
          end: {
            line: 62,
            column: 17
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 60,
            column: 16
          },
          end: {
            line: 62,
            column: 17
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 60
      },
      "5": {
        loc: {
          start: {
            line: 63,
            column: 16
          },
          end: {
            line: 65,
            column: 17
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 63,
            column: 16
          },
          end: {
            line: 65,
            column: 17
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 63
      },
      "6": {
        loc: {
          start: {
            line: 63,
            column: 20
          },
          end: {
            line: 63,
            column: 127
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 63,
            column: 20
          },
          end: {
            line: 63,
            column: 65
          }
        }, {
          start: {
            line: 63,
            column: 69
          },
          end: {
            line: 63,
            column: 127
          }
        }],
        line: 63
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0,
      "24": 0,
      "25": 0,
      "26": 0,
      "27": 0,
      "28": 0,
      "29": 0,
      "30": 0,
      "31": 0,
      "32": 0,
      "33": 0,
      "34": 0,
      "35": 0,
      "36": 0,
      "37": 0,
      "38": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0],
      "2": [0, 0],
      "3": [0, 0],
      "4": [0, 0],
      "5": [0, 0],
      "6": [0, 0]
    },
    inputSourceMap: {
      file: "/home/user/Desktop/MintMind/src/vs/workbench/services/remote/common/remoteAgentService.ts",
      mappings: "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",
      names: [],
      sources: ["/home/user/Desktop/MintMind/src/vs/workbench/services/remote/common/remoteAgentService.ts"],
      sourcesContent: ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { RemoteAgentConnectionContext, IRemoteAgentEnvironment } from '../../../../platform/remote/common/remoteAgentEnvironment.js';\nimport { IChannel, IServerChannel } from '../../../../base/parts/ipc/common/ipc.js';\nimport { IDiagnosticInfoOptions, IDiagnosticInfo } from '../../../../platform/diagnostics/common/diagnostics.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { PersistentConnectionEvent } from '../../../../platform/remote/common/remoteAgentConnection.js';\nimport { ITelemetryData, TelemetryLevel } from '../../../../platform/telemetry/common/telemetry.js';\nimport { timeout } from '../../../../base/common/async.js';\n\nexport const IRemoteAgentService = createDecorator<IRemoteAgentService>('remoteAgentService');\n\nexport interface IRemoteAgentService {\n\treadonly _serviceBrand: undefined;\n\n\tgetConnection(): IRemoteAgentConnection | null;\n\t/**\n\t * Get the remote environment. In case of an error, returns `null`.\n\t */\n\tgetEnvironment(): Promise<IRemoteAgentEnvironment | null>;\n\t/**\n\t * Get the remote environment. Can return an error.\n\t */\n\tgetRawEnvironment(): Promise<IRemoteAgentEnvironment | null>;\n\t/**\n\t * Get exit information for a remote extension host.\n\t */\n\tgetExtensionHostExitInfo(reconnectionToken: string): Promise<IExtensionHostExitInfo | null>;\n\n\t/**\n\t * Gets the round trip time from the remote extension host. Note that this\n\t * may be delayed if the extension host is busy.\n\t */\n\tgetRoundTripTime(): Promise<number | undefined>;\n\n\t/**\n\t * Gracefully ends the current connection, if any.\n\t */\n\tendConnection(): Promise<void>;\n\n\tgetDiagnosticInfo(options: IDiagnosticInfoOptions): Promise<IDiagnosticInfo | undefined>;\n\tupdateTelemetryLevel(telemetryLevel: TelemetryLevel): Promise<void>;\n\tlogTelemetry(eventName: string, data?: ITelemetryData): Promise<void>;\n\tflushTelemetry(): Promise<void>;\n}\n\nexport interface IExtensionHostExitInfo {\n\tcode: number;\n\tsignal: string;\n}\n\nexport interface IRemoteAgentConnection {\n\treadonly remoteAuthority: string;\n\n\treadonly onReconnecting: Event<void>;\n\treadonly onDidStateChange: Event<PersistentConnectionEvent>;\n\n\tend(): Promise<void>;\n\tdispose(): void;\n\tgetChannel<T extends IChannel>(channelName: string): T;\n\twithChannel<T extends IChannel, R>(channelName: string, callback: (channel: T) => Promise<R>): Promise<R>;\n\tregisterChannel<T extends IServerChannel<RemoteAgentConnectionContext>>(channelName: string, channel: T): void;\n\tgetInitialConnectionTimeMs(): Promise<number>;\n}\n\nexport interface IRemoteConnectionLatencyMeasurement {\n\n\treadonly initial: number | undefined;\n\treadonly current: number;\n\treadonly average: number;\n\n\treadonly high: boolean;\n}\n\nexport const remoteConnectionLatencyMeasurer = new class {\n\n\treadonly maxSampleCount = 5;\n\treadonly sampleDelay = 2000;\n\n\treadonly initial: number[] = [];\n\treadonly maxInitialCount = 3;\n\n\treadonly average: number[] = [];\n\treadonly maxAverageCount = 100;\n\n\treadonly highLatencyMultiple = 2;\n\treadonly highLatencyMinThreshold = 500;\n\treadonly highLatencyMaxThreshold = 1500;\n\n\tlastMeasurement: IRemoteConnectionLatencyMeasurement | undefined = undefined;\n\tget latency() { return this.lastMeasurement; }\n\n\tasync measure(remoteAgentService: IRemoteAgentService): Promise<IRemoteConnectionLatencyMeasurement | undefined> {\n\t\tlet currentLatency = Infinity;\n\n\t\t// Measure up to samples count\n\t\tfor (let i = 0; i < this.maxSampleCount; i++) {\n\t\t\tconst rtt = await remoteAgentService.getRoundTripTime();\n\t\t\tif (rtt === undefined) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tcurrentLatency = Math.min(currentLatency, rtt / 2 /* we want just one way, not round trip time */);\n\t\t\tawait timeout(this.sampleDelay);\n\t\t}\n\n\t\t// Keep track of average latency\n\t\tthis.average.push(currentLatency);\n\t\tif (this.average.length > this.maxAverageCount) {\n\t\t\tthis.average.shift();\n\t\t}\n\n\t\t// Keep track of initial latency\n\t\tlet initialLatency: number | undefined = undefined;\n\t\tif (this.initial.length < this.maxInitialCount) {\n\t\t\tthis.initial.push(currentLatency);\n\t\t} else {\n\t\t\tinitialLatency = this.initial.reduce((sum, value) => sum + value, 0) / this.initial.length;\n\t\t}\n\n\t\t// Remember as last measurement\n\t\tthis.lastMeasurement = {\n\t\t\tinitial: initialLatency,\n\t\t\tcurrent: currentLatency,\n\t\t\taverage: this.average.reduce((sum, value) => sum + value, 0) / this.average.length,\n\t\t\thigh: (() => {\n\n\t\t\t\t// based on the initial, average and current latency, try to decide\n\t\t\t\t// if the connection has high latency\n\t\t\t\t// Some rules:\n\t\t\t\t// - we require the initial latency to be computed\n\t\t\t\t// - we only consider latency above highLatencyMinThreshold as potentially high\n\t\t\t\t// - we require the current latency to be above the average latency by a factor of highLatencyMultiple\n\t\t\t\t// - but not if the latency is actually above highLatencyMaxThreshold\n\n\t\t\t\tif (typeof initialLatency === 'undefined') {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (currentLatency > this.highLatencyMaxThreshold) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tif (currentLatency > this.highLatencyMinThreshold && currentLatency > initialLatency * this.highLatencyMultiple) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t})()\n\t\t};\n\n\t\treturn this.lastMeasurement;\n\t}\n};\n"],
      version: 3
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "ef263ac632f32b6b89a5db2355a4b5b491c9c2d7"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_gmjs4kpfh = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_gmjs4kpfh();
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
import { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';
import { timeout } from '../../../../base/common/async.js';
export const IRemoteAgentService =
/* istanbul ignore next */
(cov_gmjs4kpfh().s[0]++, createDecorator('remoteAgentService'));
export const remoteConnectionLatencyMeasurer =
/* istanbul ignore next */
(cov_gmjs4kpfh().s[1]++, new class {
  maxSampleCount =
  /* istanbul ignore next */
  (cov_gmjs4kpfh().s[2]++, 5);
  sampleDelay =
  /* istanbul ignore next */
  (cov_gmjs4kpfh().s[3]++, 2000);
  initial =
  /* istanbul ignore next */
  (cov_gmjs4kpfh().s[4]++, []);
  maxInitialCount =
  /* istanbul ignore next */
  (cov_gmjs4kpfh().s[5]++, 3);
  average =
  /* istanbul ignore next */
  (cov_gmjs4kpfh().s[6]++, []);
  maxAverageCount =
  /* istanbul ignore next */
  (cov_gmjs4kpfh().s[7]++, 100);
  highLatencyMultiple =
  /* istanbul ignore next */
  (cov_gmjs4kpfh().s[8]++, 2);
  highLatencyMinThreshold =
  /* istanbul ignore next */
  (cov_gmjs4kpfh().s[9]++, 500);
  highLatencyMaxThreshold =
  /* istanbul ignore next */
  (cov_gmjs4kpfh().s[10]++, 1500);
  lastMeasurement =
  /* istanbul ignore next */
  (cov_gmjs4kpfh().s[11]++, undefined);
  get latency() {
    /* istanbul ignore next */
    cov_gmjs4kpfh().f[0]++;
    cov_gmjs4kpfh().s[12]++;
    return this.lastMeasurement;
  }
  async measure(remoteAgentService) {
    /* istanbul ignore next */
    cov_gmjs4kpfh().f[1]++;
    let currentLatency =
    /* istanbul ignore next */
    (cov_gmjs4kpfh().s[13]++, Infinity);
    // Measure up to samples count
    /* istanbul ignore next */
    cov_gmjs4kpfh().s[14]++;
    for (let i =
    /* istanbul ignore next */
    (cov_gmjs4kpfh().s[15]++, 0); i < this.maxSampleCount; i++) {
      const rtt =
      /* istanbul ignore next */
      (cov_gmjs4kpfh().s[16]++, await remoteAgentService.getRoundTripTime());
      /* istanbul ignore next */
      cov_gmjs4kpfh().s[17]++;
      if (rtt === undefined) {
        /* istanbul ignore next */
        cov_gmjs4kpfh().b[0][0]++;
        cov_gmjs4kpfh().s[18]++;
        return undefined;
      } else
      /* istanbul ignore next */
      {
        cov_gmjs4kpfh().b[0][1]++;
      }
      cov_gmjs4kpfh().s[19]++;
      currentLatency = Math.min(currentLatency, rtt / 2 /* we want just one way, not round trip time */);
      /* istanbul ignore next */
      cov_gmjs4kpfh().s[20]++;
      await timeout(this.sampleDelay);
    }
    // Keep track of average latency
    /* istanbul ignore next */
    cov_gmjs4kpfh().s[21]++;
    this.average.push(currentLatency);
    /* istanbul ignore next */
    cov_gmjs4kpfh().s[22]++;
    if (this.average.length > this.maxAverageCount) {
      /* istanbul ignore next */
      cov_gmjs4kpfh().b[1][0]++;
      cov_gmjs4kpfh().s[23]++;
      this.average.shift();
    } else
    /* istanbul ignore next */
    {
      cov_gmjs4kpfh().b[1][1]++;
    }
    // Keep track of initial latency
    let initialLatency =
    /* istanbul ignore next */
    (cov_gmjs4kpfh().s[24]++, undefined);
    /* istanbul ignore next */
    cov_gmjs4kpfh().s[25]++;
    if (this.initial.length < this.maxInitialCount) {
      /* istanbul ignore next */
      cov_gmjs4kpfh().b[2][0]++;
      cov_gmjs4kpfh().s[26]++;
      this.initial.push(currentLatency);
    } else {
      /* istanbul ignore next */
      cov_gmjs4kpfh().b[2][1]++;
      cov_gmjs4kpfh().s[27]++;
      initialLatency = this.initial.reduce((sum, value) => {
        /* istanbul ignore next */
        cov_gmjs4kpfh().f[2]++;
        cov_gmjs4kpfh().s[28]++;
        return sum + value;
      }, 0) / this.initial.length;
    }
    // Remember as last measurement
    /* istanbul ignore next */
    cov_gmjs4kpfh().s[29]++;
    this.lastMeasurement = {
      initial: initialLatency,
      current: currentLatency,
      average: this.average.reduce((sum, value) => {
        /* istanbul ignore next */
        cov_gmjs4kpfh().f[3]++;
        cov_gmjs4kpfh().s[30]++;
        return sum + value;
      }, 0) / this.average.length,
      high: (() => {
        /* istanbul ignore next */
        cov_gmjs4kpfh().f[4]++;
        cov_gmjs4kpfh().s[31]++;
        // based on the initial, average and current latency, try to decide
        // if the connection has high latency
        // Some rules:
        // - we require the initial latency to be computed
        // - we only consider latency above highLatencyMinThreshold as potentially high
        // - we require the current latency to be above the average latency by a factor of highLatencyMultiple
        // - but not if the latency is actually above highLatencyMaxThreshold
        if (typeof initialLatency === 'undefined') {
          /* istanbul ignore next */
          cov_gmjs4kpfh().b[3][0]++;
          cov_gmjs4kpfh().s[32]++;
          return false;
        } else
        /* istanbul ignore next */
        {
          cov_gmjs4kpfh().b[3][1]++;
        }
        cov_gmjs4kpfh().s[33]++;
        if (currentLatency > this.highLatencyMaxThreshold) {
          /* istanbul ignore next */
          cov_gmjs4kpfh().b[4][0]++;
          cov_gmjs4kpfh().s[34]++;
          return true;
        } else
        /* istanbul ignore next */
        {
          cov_gmjs4kpfh().b[4][1]++;
        }
        cov_gmjs4kpfh().s[35]++;
        if (
        /* istanbul ignore next */
        (cov_gmjs4kpfh().b[6][0]++, currentLatency > this.highLatencyMinThreshold) &&
        /* istanbul ignore next */
        (cov_gmjs4kpfh().b[6][1]++, currentLatency > initialLatency * this.highLatencyMultiple)) {
          /* istanbul ignore next */
          cov_gmjs4kpfh().b[5][0]++;
          cov_gmjs4kpfh().s[36]++;
          return true;
        } else
        /* istanbul ignore next */
        {
          cov_gmjs4kpfh().b[5][1]++;
        }
        cov_gmjs4kpfh().s[37]++;
        return false;
      })()
    };
    /* istanbul ignore next */
    cov_gmjs4kpfh().s[38]++;
    return this.lastMeasurement;
  }
}());
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfZ21qczRrcGZoIiwiYWN0dWFsQ292ZXJhZ2UiLCJjcmVhdGVEZWNvcmF0b3IiLCJ0aW1lb3V0IiwiSVJlbW90ZUFnZW50U2VydmljZSIsInMiLCJyZW1vdGVDb25uZWN0aW9uTGF0ZW5jeU1lYXN1cmVyIiwibWF4U2FtcGxlQ291bnQiLCJzYW1wbGVEZWxheSIsImluaXRpYWwiLCJtYXhJbml0aWFsQ291bnQiLCJhdmVyYWdlIiwibWF4QXZlcmFnZUNvdW50IiwiaGlnaExhdGVuY3lNdWx0aXBsZSIsImhpZ2hMYXRlbmN5TWluVGhyZXNob2xkIiwiaGlnaExhdGVuY3lNYXhUaHJlc2hvbGQiLCJsYXN0TWVhc3VyZW1lbnQiLCJ1bmRlZmluZWQiLCJsYXRlbmN5IiwiZiIsIm1lYXN1cmUiLCJyZW1vdGVBZ2VudFNlcnZpY2UiLCJjdXJyZW50TGF0ZW5jeSIsIkluZmluaXR5IiwiaSIsInJ0dCIsImdldFJvdW5kVHJpcFRpbWUiLCJiIiwiTWF0aCIsIm1pbiIsInB1c2giLCJsZW5ndGgiLCJzaGlmdCIsImluaXRpYWxMYXRlbmN5IiwicmVkdWNlIiwic3VtIiwidmFsdWUiLCJjdXJyZW50IiwiaGlnaCJdLCJzb3VyY2VzIjpbIi9ob21lL3VzZXIvRGVza3RvcC9NaW50TWluZC9zcmMvdnMvd29ya2JlbmNoL3NlcnZpY2VzL3JlbW90ZS9jb21tb24vcmVtb3RlQWdlbnRTZXJ2aWNlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiAgQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKiAgTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLiBTZWUgTGljZW5zZS50eHQgaW4gdGhlIHByb2plY3Qgcm9vdCBmb3IgbGljZW5zZSBpbmZvcm1hdGlvbi5cbiAqLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5pbXBvcnQgeyBjcmVhdGVEZWNvcmF0b3IgfSBmcm9tICcuLi8uLi8uLi8uLi9wbGF0Zm9ybS9pbnN0YW50aWF0aW9uL2NvbW1vbi9pbnN0YW50aWF0aW9uLmpzJztcbmltcG9ydCB7IFJlbW90ZUFnZW50Q29ubmVjdGlvbkNvbnRleHQsIElSZW1vdGVBZ2VudEVudmlyb25tZW50IH0gZnJvbSAnLi4vLi4vLi4vLi4vcGxhdGZvcm0vcmVtb3RlL2NvbW1vbi9yZW1vdGVBZ2VudEVudmlyb25tZW50LmpzJztcbmltcG9ydCB7IElDaGFubmVsLCBJU2VydmVyQ2hhbm5lbCB9IGZyb20gJy4uLy4uLy4uLy4uL2Jhc2UvcGFydHMvaXBjL2NvbW1vbi9pcGMuanMnO1xuaW1wb3J0IHsgSURpYWdub3N0aWNJbmZvT3B0aW9ucywgSURpYWdub3N0aWNJbmZvIH0gZnJvbSAnLi4vLi4vLi4vLi4vcGxhdGZvcm0vZGlhZ25vc3RpY3MvY29tbW9uL2RpYWdub3N0aWNzLmpzJztcbmltcG9ydCB7IEV2ZW50IH0gZnJvbSAnLi4vLi4vLi4vLi4vYmFzZS9jb21tb24vZXZlbnQuanMnO1xuaW1wb3J0IHsgUGVyc2lzdGVudENvbm5lY3Rpb25FdmVudCB9IGZyb20gJy4uLy4uLy4uLy4uL3BsYXRmb3JtL3JlbW90ZS9jb21tb24vcmVtb3RlQWdlbnRDb25uZWN0aW9uLmpzJztcbmltcG9ydCB7IElUZWxlbWV0cnlEYXRhLCBUZWxlbWV0cnlMZXZlbCB9IGZyb20gJy4uLy4uLy4uLy4uL3BsYXRmb3JtL3RlbGVtZXRyeS9jb21tb24vdGVsZW1ldHJ5LmpzJztcbmltcG9ydCB7IHRpbWVvdXQgfSBmcm9tICcuLi8uLi8uLi8uLi9iYXNlL2NvbW1vbi9hc3luYy5qcyc7XG5cbmV4cG9ydCBjb25zdCBJUmVtb3RlQWdlbnRTZXJ2aWNlID0gY3JlYXRlRGVjb3JhdG9yPElSZW1vdGVBZ2VudFNlcnZpY2U+KCdyZW1vdGVBZ2VudFNlcnZpY2UnKTtcblxuZXhwb3J0IGludGVyZmFjZSBJUmVtb3RlQWdlbnRTZXJ2aWNlIHtcblx0cmVhZG9ubHkgX3NlcnZpY2VCcmFuZDogdW5kZWZpbmVkO1xuXG5cdGdldENvbm5lY3Rpb24oKTogSVJlbW90ZUFnZW50Q29ubmVjdGlvbiB8IG51bGw7XG5cdC8qKlxuXHQgKiBHZXQgdGhlIHJlbW90ZSBlbnZpcm9ubWVudC4gSW4gY2FzZSBvZiBhbiBlcnJvciwgcmV0dXJucyBgbnVsbGAuXG5cdCAqL1xuXHRnZXRFbnZpcm9ubWVudCgpOiBQcm9taXNlPElSZW1vdGVBZ2VudEVudmlyb25tZW50IHwgbnVsbD47XG5cdC8qKlxuXHQgKiBHZXQgdGhlIHJlbW90ZSBlbnZpcm9ubWVudC4gQ2FuIHJldHVybiBhbiBlcnJvci5cblx0ICovXG5cdGdldFJhd0Vudmlyb25tZW50KCk6IFByb21pc2U8SVJlbW90ZUFnZW50RW52aXJvbm1lbnQgfCBudWxsPjtcblx0LyoqXG5cdCAqIEdldCBleGl0IGluZm9ybWF0aW9uIGZvciBhIHJlbW90ZSBleHRlbnNpb24gaG9zdC5cblx0ICovXG5cdGdldEV4dGVuc2lvbkhvc3RFeGl0SW5mbyhyZWNvbm5lY3Rpb25Ub2tlbjogc3RyaW5nKTogUHJvbWlzZTxJRXh0ZW5zaW9uSG9zdEV4aXRJbmZvIHwgbnVsbD47XG5cblx0LyoqXG5cdCAqIEdldHMgdGhlIHJvdW5kIHRyaXAgdGltZSBmcm9tIHRoZSByZW1vdGUgZXh0ZW5zaW9uIGhvc3QuIE5vdGUgdGhhdCB0aGlzXG5cdCAqIG1heSBiZSBkZWxheWVkIGlmIHRoZSBleHRlbnNpb24gaG9zdCBpcyBidXN5LlxuXHQgKi9cblx0Z2V0Um91bmRUcmlwVGltZSgpOiBQcm9taXNlPG51bWJlciB8IHVuZGVmaW5lZD47XG5cblx0LyoqXG5cdCAqIEdyYWNlZnVsbHkgZW5kcyB0aGUgY3VycmVudCBjb25uZWN0aW9uLCBpZiBhbnkuXG5cdCAqL1xuXHRlbmRDb25uZWN0aW9uKCk6IFByb21pc2U8dm9pZD47XG5cblx0Z2V0RGlhZ25vc3RpY0luZm8ob3B0aW9uczogSURpYWdub3N0aWNJbmZvT3B0aW9ucyk6IFByb21pc2U8SURpYWdub3N0aWNJbmZvIHwgdW5kZWZpbmVkPjtcblx0dXBkYXRlVGVsZW1ldHJ5TGV2ZWwodGVsZW1ldHJ5TGV2ZWw6IFRlbGVtZXRyeUxldmVsKTogUHJvbWlzZTx2b2lkPjtcblx0bG9nVGVsZW1ldHJ5KGV2ZW50TmFtZTogc3RyaW5nLCBkYXRhPzogSVRlbGVtZXRyeURhdGEpOiBQcm9taXNlPHZvaWQ+O1xuXHRmbHVzaFRlbGVtZXRyeSgpOiBQcm9taXNlPHZvaWQ+O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIElFeHRlbnNpb25Ib3N0RXhpdEluZm8ge1xuXHRjb2RlOiBudW1iZXI7XG5cdHNpZ25hbDogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIElSZW1vdGVBZ2VudENvbm5lY3Rpb24ge1xuXHRyZWFkb25seSByZW1vdGVBdXRob3JpdHk6IHN0cmluZztcblxuXHRyZWFkb25seSBvblJlY29ubmVjdGluZzogRXZlbnQ8dm9pZD47XG5cdHJlYWRvbmx5IG9uRGlkU3RhdGVDaGFuZ2U6IEV2ZW50PFBlcnNpc3RlbnRDb25uZWN0aW9uRXZlbnQ+O1xuXG5cdGVuZCgpOiBQcm9taXNlPHZvaWQ+O1xuXHRkaXNwb3NlKCk6IHZvaWQ7XG5cdGdldENoYW5uZWw8VCBleHRlbmRzIElDaGFubmVsPihjaGFubmVsTmFtZTogc3RyaW5nKTogVDtcblx0d2l0aENoYW5uZWw8VCBleHRlbmRzIElDaGFubmVsLCBSPihjaGFubmVsTmFtZTogc3RyaW5nLCBjYWxsYmFjazogKGNoYW5uZWw6IFQpID0+IFByb21pc2U8Uj4pOiBQcm9taXNlPFI+O1xuXHRyZWdpc3RlckNoYW5uZWw8VCBleHRlbmRzIElTZXJ2ZXJDaGFubmVsPFJlbW90ZUFnZW50Q29ubmVjdGlvbkNvbnRleHQ+PihjaGFubmVsTmFtZTogc3RyaW5nLCBjaGFubmVsOiBUKTogdm9pZDtcblx0Z2V0SW5pdGlhbENvbm5lY3Rpb25UaW1lTXMoKTogUHJvbWlzZTxudW1iZXI+O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIElSZW1vdGVDb25uZWN0aW9uTGF0ZW5jeU1lYXN1cmVtZW50IHtcblxuXHRyZWFkb25seSBpbml0aWFsOiBudW1iZXIgfCB1bmRlZmluZWQ7XG5cdHJlYWRvbmx5IGN1cnJlbnQ6IG51bWJlcjtcblx0cmVhZG9ubHkgYXZlcmFnZTogbnVtYmVyO1xuXG5cdHJlYWRvbmx5IGhpZ2g6IGJvb2xlYW47XG59XG5cbmV4cG9ydCBjb25zdCByZW1vdGVDb25uZWN0aW9uTGF0ZW5jeU1lYXN1cmVyID0gbmV3IGNsYXNzIHtcblxuXHRyZWFkb25seSBtYXhTYW1wbGVDb3VudCA9IDU7XG5cdHJlYWRvbmx5IHNhbXBsZURlbGF5ID0gMjAwMDtcblxuXHRyZWFkb25seSBpbml0aWFsOiBudW1iZXJbXSA9IFtdO1xuXHRyZWFkb25seSBtYXhJbml0aWFsQ291bnQgPSAzO1xuXG5cdHJlYWRvbmx5IGF2ZXJhZ2U6IG51bWJlcltdID0gW107XG5cdHJlYWRvbmx5IG1heEF2ZXJhZ2VDb3VudCA9IDEwMDtcblxuXHRyZWFkb25seSBoaWdoTGF0ZW5jeU11bHRpcGxlID0gMjtcblx0cmVhZG9ubHkgaGlnaExhdGVuY3lNaW5UaHJlc2hvbGQgPSA1MDA7XG5cdHJlYWRvbmx5IGhpZ2hMYXRlbmN5TWF4VGhyZXNob2xkID0gMTUwMDtcblxuXHRsYXN0TWVhc3VyZW1lbnQ6IElSZW1vdGVDb25uZWN0aW9uTGF0ZW5jeU1lYXN1cmVtZW50IHwgdW5kZWZpbmVkID0gdW5kZWZpbmVkO1xuXHRnZXQgbGF0ZW5jeSgpIHsgcmV0dXJuIHRoaXMubGFzdE1lYXN1cmVtZW50OyB9XG5cblx0YXN5bmMgbWVhc3VyZShyZW1vdGVBZ2VudFNlcnZpY2U6IElSZW1vdGVBZ2VudFNlcnZpY2UpOiBQcm9taXNlPElSZW1vdGVDb25uZWN0aW9uTGF0ZW5jeU1lYXN1cmVtZW50IHwgdW5kZWZpbmVkPiB7XG5cdFx0bGV0IGN1cnJlbnRMYXRlbmN5ID0gSW5maW5pdHk7XG5cblx0XHQvLyBNZWFzdXJlIHVwIHRvIHNhbXBsZXMgY291bnRcblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubWF4U2FtcGxlQ291bnQ7IGkrKykge1xuXHRcdFx0Y29uc3QgcnR0ID0gYXdhaXQgcmVtb3RlQWdlbnRTZXJ2aWNlLmdldFJvdW5kVHJpcFRpbWUoKTtcblx0XHRcdGlmIChydHQgPT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRyZXR1cm4gdW5kZWZpbmVkO1xuXHRcdFx0fVxuXG5cdFx0XHRjdXJyZW50TGF0ZW5jeSA9IE1hdGgubWluKGN1cnJlbnRMYXRlbmN5LCBydHQgLyAyIC8qIHdlIHdhbnQganVzdCBvbmUgd2F5LCBub3Qgcm91bmQgdHJpcCB0aW1lICovKTtcblx0XHRcdGF3YWl0IHRpbWVvdXQodGhpcy5zYW1wbGVEZWxheSk7XG5cdFx0fVxuXG5cdFx0Ly8gS2VlcCB0cmFjayBvZiBhdmVyYWdlIGxhdGVuY3lcblx0XHR0aGlzLmF2ZXJhZ2UucHVzaChjdXJyZW50TGF0ZW5jeSk7XG5cdFx0aWYgKHRoaXMuYXZlcmFnZS5sZW5ndGggPiB0aGlzLm1heEF2ZXJhZ2VDb3VudCkge1xuXHRcdFx0dGhpcy5hdmVyYWdlLnNoaWZ0KCk7XG5cdFx0fVxuXG5cdFx0Ly8gS2VlcCB0cmFjayBvZiBpbml0aWFsIGxhdGVuY3lcblx0XHRsZXQgaW5pdGlhbExhdGVuY3k6IG51bWJlciB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZDtcblx0XHRpZiAodGhpcy5pbml0aWFsLmxlbmd0aCA8IHRoaXMubWF4SW5pdGlhbENvdW50KSB7XG5cdFx0XHR0aGlzLmluaXRpYWwucHVzaChjdXJyZW50TGF0ZW5jeSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGluaXRpYWxMYXRlbmN5ID0gdGhpcy5pbml0aWFsLnJlZHVjZSgoc3VtLCB2YWx1ZSkgPT4gc3VtICsgdmFsdWUsIDApIC8gdGhpcy5pbml0aWFsLmxlbmd0aDtcblx0XHR9XG5cblx0XHQvLyBSZW1lbWJlciBhcyBsYXN0IG1lYXN1cmVtZW50XG5cdFx0dGhpcy5sYXN0TWVhc3VyZW1lbnQgPSB7XG5cdFx0XHRpbml0aWFsOiBpbml0aWFsTGF0ZW5jeSxcblx0XHRcdGN1cnJlbnQ6IGN1cnJlbnRMYXRlbmN5LFxuXHRcdFx0YXZlcmFnZTogdGhpcy5hdmVyYWdlLnJlZHVjZSgoc3VtLCB2YWx1ZSkgPT4gc3VtICsgdmFsdWUsIDApIC8gdGhpcy5hdmVyYWdlLmxlbmd0aCxcblx0XHRcdGhpZ2g6ICgoKSA9PiB7XG5cblx0XHRcdFx0Ly8gYmFzZWQgb24gdGhlIGluaXRpYWwsIGF2ZXJhZ2UgYW5kIGN1cnJlbnQgbGF0ZW5jeSwgdHJ5IHRvIGRlY2lkZVxuXHRcdFx0XHQvLyBpZiB0aGUgY29ubmVjdGlvbiBoYXMgaGlnaCBsYXRlbmN5XG5cdFx0XHRcdC8vIFNvbWUgcnVsZXM6XG5cdFx0XHRcdC8vIC0gd2UgcmVxdWlyZSB0aGUgaW5pdGlhbCBsYXRlbmN5IHRvIGJlIGNvbXB1dGVkXG5cdFx0XHRcdC8vIC0gd2Ugb25seSBjb25zaWRlciBsYXRlbmN5IGFib3ZlIGhpZ2hMYXRlbmN5TWluVGhyZXNob2xkIGFzIHBvdGVudGlhbGx5IGhpZ2hcblx0XHRcdFx0Ly8gLSB3ZSByZXF1aXJlIHRoZSBjdXJyZW50IGxhdGVuY3kgdG8gYmUgYWJvdmUgdGhlIGF2ZXJhZ2UgbGF0ZW5jeSBieSBhIGZhY3RvciBvZiBoaWdoTGF0ZW5jeU11bHRpcGxlXG5cdFx0XHRcdC8vIC0gYnV0IG5vdCBpZiB0aGUgbGF0ZW5jeSBpcyBhY3R1YWxseSBhYm92ZSBoaWdoTGF0ZW5jeU1heFRocmVzaG9sZFxuXG5cdFx0XHRcdGlmICh0eXBlb2YgaW5pdGlhbExhdGVuY3kgPT09ICd1bmRlZmluZWQnKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKGN1cnJlbnRMYXRlbmN5ID4gdGhpcy5oaWdoTGF0ZW5jeU1heFRocmVzaG9sZCkge1xuXHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKGN1cnJlbnRMYXRlbmN5ID4gdGhpcy5oaWdoTGF0ZW5jeU1pblRocmVzaG9sZCAmJiBjdXJyZW50TGF0ZW5jeSA+IGluaXRpYWxMYXRlbmN5ICogdGhpcy5oaWdoTGF0ZW5jeU11bHRpcGxlKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9KSgpXG5cdFx0fTtcblxuXHRcdHJldHVybiB0aGlzLmxhc3RNZWFzdXJlbWVudDtcblx0fVxufTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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