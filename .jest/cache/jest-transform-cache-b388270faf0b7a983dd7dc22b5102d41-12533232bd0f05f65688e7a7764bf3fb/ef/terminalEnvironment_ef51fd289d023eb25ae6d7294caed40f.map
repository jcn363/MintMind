{"version":3,"names":["cov_1msc6nattq","actualCoverage","OS","escapeNonWindowsPath","path","shellType","f","newPath","s","includes","b","replace","escapeConfig","bothQuotes","singleQuotes","noSingleQuotes","bannedChars","collapseTildePath","userHome","separator","match","slice","length","normalizedPath","toLowerCase","normalizedUserHome","sanitizeCwd","cwd","substring","toUpperCase","shouldUseEnvironmentVariableCollection","slc","strictEnv"],"sources":["/home/user/Desktop/MintMind/src/vs/platform/terminal/common/terminalEnvironment.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { OperatingSystem, OS } from '../../../base/common/platform.js';\nimport { IShellLaunchConfig, TerminalShellType, PosixShellType, WindowsShellType, GeneralShellType } from './terminal.js';\n\n/**\n * Aggressively escape non-windows paths to prepare for being sent to a shell. This will do some\n * escaping inaccurately to be careful about possible script injection via the file path. For\n * example, we're trying to prevent this sort of attack: `/foo/file$(echo evil)`.\n */\nexport function escapeNonWindowsPath(path: string, shellType?: TerminalShellType): string {\n\tlet newPath = path;\n\tif (newPath.includes('\\\\')) {\n\t\tnewPath = newPath.replace(/\\\\/g, '\\\\\\\\');\n\t}\n\n\t// Define shell-specific escaping rules\n\tinterface ShellEscapeConfig {\n\t\t// How to handle paths with both single and double quotes\n\t\tbothQuotes: (path: string) => string;\n\t\t// How to handle paths with only single quotes\n\t\tsingleQuotes: (path: string) => string;\n\t\t// How to handle paths with no single quotes (may have double quotes)\n\t\tnoSingleQuotes: (path: string) => string;\n\t}\n\n\tlet escapeConfig: ShellEscapeConfig;\n\tswitch (shellType) {\n\t\tcase PosixShellType.Bash:\n\t\tcase PosixShellType.Sh:\n\t\tcase PosixShellType.Zsh:\n\t\tcase WindowsShellType.GitBash:\n\t\t\tescapeConfig = {\n\t\t\t\tbothQuotes: (path) => `$'${path.replace(/'/g, '\\\\\\'')}'`,\n\t\t\t\tsingleQuotes: (path) => `'${path.replace(/'/g, '\\\\\\'')}'`,\n\t\t\t\tnoSingleQuotes: (path) => `'${path}'`\n\t\t\t};\n\t\t\tbreak;\n\t\tcase PosixShellType.Fish:\n\t\t\tescapeConfig = {\n\t\t\t\tbothQuotes: (path) => `\"${path.replace(/\"/g, '\\\\\"')}\"`,\n\t\t\t\tsingleQuotes: (path) => `'${path.replace(/'/g, '\\\\\\'')}'`,\n\t\t\t\tnoSingleQuotes: (path) => `'${path}'`\n\t\t\t};\n\t\t\tbreak;\n\t\tcase GeneralShellType.PowerShell:\n\t\t\t// PowerShell should be handled separately in preparePathForShell\n\t\t\t// but if we get here, use PowerShell escaping\n\t\t\tescapeConfig = {\n\t\t\t\tbothQuotes: (path) => `\"${path.replace(/\"/g, '`\"')}\"`,\n\t\t\t\tsingleQuotes: (path) => `'${path.replace(/'/g, '\\'\\'')}'`,\n\t\t\t\tnoSingleQuotes: (path) => `'${path}'`\n\t\t\t};\n\t\t\tbreak;\n\t\tdefault:\n\t\t\t// Default to POSIX shell escaping for unknown shells\n\t\t\tescapeConfig = {\n\t\t\t\tbothQuotes: (path) => `$'${path.replace(/'/g, '\\\\\\'')}'`,\n\t\t\t\tsingleQuotes: (path) => `'${path.replace(/'/g, '\\\\\\'')}'`,\n\t\t\t\tnoSingleQuotes: (path) => `'${path}'`\n\t\t\t};\n\t\t\tbreak;\n\t}\n\n\t// Remove dangerous characters except single and double quotes, which we'll escape properly\n\tconst bannedChars = /[\\`\\$\\|\\&\\>\\~\\#\\!\\^\\*\\;\\<]/g;\n\tnewPath = newPath.replace(bannedChars, '');\n\n\t// Apply shell-specific escaping based on quote content\n\tif (newPath.includes('\\'') && newPath.includes('\"')) {\n\t\treturn escapeConfig.bothQuotes(newPath);\n\t} else if (newPath.includes('\\'')) {\n\t\treturn escapeConfig.singleQuotes(newPath);\n\t} else {\n\t\treturn escapeConfig.noSingleQuotes(newPath);\n\t}\n}\n\n/**\n * Collapses the user's home directory into `~` if it exists within the path, this gives a shorter\n * path that is more suitable within the context of a terminal.\n */\nexport function collapseTildePath(path: string | undefined, userHome: string | undefined, separator: string): string {\n\tif (!path) {\n\t\treturn '';\n\t}\n\tif (!userHome) {\n\t\treturn path;\n\t}\n\t// Trim the trailing separator from the end if it exists\n\tif (userHome.match(/[\\/\\\\]$/)) {\n\t\tuserHome = userHome.slice(0, userHome.length - 1);\n\t}\n\tconst normalizedPath = path.replace(/\\\\/g, '/').toLowerCase();\n\tconst normalizedUserHome = userHome.replace(/\\\\/g, '/').toLowerCase();\n\tif (!normalizedPath.includes(normalizedUserHome)) {\n\t\treturn path;\n\t}\n\treturn `~${separator}${path.slice(userHome.length + 1)}`;\n}\n\n/**\n * Sanitizes a cwd string, removing any wrapping quotes and making the Windows drive letter\n * uppercase.\n * @param cwd The directory to sanitize.\n */\nexport function sanitizeCwd(cwd: string): string {\n\t// Sanity check that the cwd is not wrapped in quotes (see #160109)\n\tif (cwd.match(/^['\"].*['\"]$/)) {\n\t\tcwd = cwd.substring(1, cwd.length - 1);\n\t}\n\t// Make the drive letter uppercase on Windows (see #9448)\n\tif (OS === OperatingSystem.Windows && cwd && cwd[1] === ':') {\n\t\treturn cwd[0].toUpperCase() + cwd.substring(1);\n\t}\n\treturn cwd;\n}\n\n/**\n * Determines whether the given shell launch config should use the environment variable collection.\n * @param slc The shell launch config to check.\n */\nexport function shouldUseEnvironmentVariableCollection(slc: IShellLaunchConfig): boolean {\n\treturn !slc.strictEnv;\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}