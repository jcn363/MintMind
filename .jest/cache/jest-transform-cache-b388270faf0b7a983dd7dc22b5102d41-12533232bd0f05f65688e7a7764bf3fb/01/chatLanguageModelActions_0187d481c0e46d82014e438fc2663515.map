{"version":3,"names":["cov_2gkuu47j5b","actualCoverage","Action2","MenuId","registerAction2","IQuickInputService","ILanguageModelsService","IAuthenticationAccessService","localize","localize2","INTERNAL_AUTH_PROVIDER_PREFIX","IDialogService","CHAT_CATEGORY","IExtensionService","IExtensionsWorkbenchService","IProductService","Codicon","ThemeIcon","ChatContextKeys","ManageModelsAction","ManageLanguageModelAuthenticationAction","ID","s","constructor","f","id","title","category","precondition","enabled","menu","AccountsContext","order","f1","run","accessor","quickInputService","get","languageModelsService","authenticationAccessService","dialogService","extensionService","extensionsWorkbenchService","productService","modelIds","getLanguageModelIds","extensionAuth","Map","ownerToAccountLabel","modelId","model","lookupLanguageModel","auth","b","ownerId","extension","value","has","providerId","accountLabel","set","allowedExtensions","readAllowedExtensions","filter","ext","trusted","trustedExtensionAuthAccess","Array","isArray","trustedExtensions","index","findIndex","a","splice","getExtension","push","name","displayName","allowed","filteredExtensions","error","size","prompt","type","message","detail","items","label","buttons","iconClass","asClassName","info","tooltip","addedTrustedSeparator","length","allowedExt","picked","disabled","description","pickable","result","pick","canPickMany","sortByLabel","onDidTriggerSeparatorButton","context","extId","separator","open","onDidTriggerItemButton","item","placeHolder","allowedSet","Set","map","updateAllowedExtensions","registerLanguageModelActions"],"sources":["/home/user/Desktop/MintMind/src/vs/workbench/contrib/chat/browser/actions/chatLanguageModelActions.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Action2, MenuId, registerAction2 } from '../../../../../platform/actions/common/actions.js';\nimport { ServicesAccessor } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IQuickInputService, IQuickPickItem, QuickPickInput } from '../../../../../platform/quickinput/common/quickInput.js';\nimport { ILanguageModelsService } from '../../common/languageModels.js';\nimport { IAuthenticationAccessService } from '../../../../services/authentication/browser/authenticationAccessService.js';\nimport { localize, localize2 } from '../../../../../nls.js';\nimport { AllowedExtension, INTERNAL_AUTH_PROVIDER_PREFIX } from '../../../../services/authentication/common/authentication.js';\nimport { IDialogService } from '../../../../../platform/dialogs/common/dialogs.js';\nimport { CHAT_CATEGORY } from './chatActions.js';\nimport { IExtensionService } from '../../../../services/extensions/common/extensions.js';\nimport { IExtensionsWorkbenchService } from '../../../extensions/common/extensions.js';\nimport { IProductService } from '../../../../../platform/product/common/productService.js';\nimport { Codicon } from '../../../../../base/common/codicons.js';\nimport { ThemeIcon } from '../../../../../base/common/themables.js';\nimport { ChatContextKeys } from '../../common/chatContextKeys.js';\nimport { ManageModelsAction } from './manageModelsActions.js';\n\nclass ManageLanguageModelAuthenticationAction extends Action2 {\n\tstatic readonly ID = 'workbench.action.chat.manageLanguageModelAuthentication';\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: ManageLanguageModelAuthenticationAction.ID,\n\t\t\ttitle: localize2('manageLanguageModelAuthentication', 'Manage Language Model Access...'),\n\t\t\tcategory: CHAT_CATEGORY,\n\t\t\tprecondition: ChatContextKeys.enabled,\n\t\t\tmenu: [{\n\t\t\t\tid: MenuId.AccountsContext,\n\t\t\t\torder: 100,\n\t\t\t}],\n\t\t\tf1: true\n\t\t});\n\t}\n\n\tasync run(accessor: ServicesAccessor): Promise<void> {\n\t\tconst quickInputService = accessor.get(IQuickInputService);\n\t\tconst languageModelsService = accessor.get(ILanguageModelsService);\n\t\tconst authenticationAccessService = accessor.get(IAuthenticationAccessService);\n\t\tconst dialogService = accessor.get(IDialogService);\n\t\tconst extensionService = accessor.get(IExtensionService);\n\t\tconst extensionsWorkbenchService = accessor.get(IExtensionsWorkbenchService);\n\t\tconst productService = accessor.get(IProductService);\n\n\t\t// Get all registered language models\n\t\tconst modelIds = languageModelsService.getLanguageModelIds();\n\n\t\t// Group models by owning extension and collect all allowed extensions\n\t\tconst extensionAuth = new Map<string, AllowedExtension[]>();\n\n\t\tconst ownerToAccountLabel = new Map<string, string>();\n\t\tfor (const modelId of modelIds) {\n\t\t\tconst model = languageModelsService.lookupLanguageModel(modelId);\n\t\t\tif (!model?.auth) {\n\t\t\t\tcontinue; // Skip if model is not found\n\t\t\t}\n\t\t\tconst ownerId = model.extension.value;\n\t\t\tif (extensionAuth.has(ownerId)) {\n\t\t\t\t// If the owner already exists, just continue\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// Get allowed extensions for this model's auth provider\n\t\t\ttry {\n\t\t\t\t// Use providerLabel as the providerId and accountLabel (or default)\n\t\t\t\tconst providerId = INTERNAL_AUTH_PROVIDER_PREFIX + ownerId;\n\t\t\t\tconst accountLabel = model.auth.accountLabel || 'Language Models';\n\t\t\t\townerToAccountLabel.set(ownerId, accountLabel);\n\t\t\t\tconst allowedExtensions = authenticationAccessService.readAllowedExtensions(\n\t\t\t\t\tproviderId,\n\t\t\t\t\taccountLabel\n\t\t\t\t).filter(ext => !ext.trusted); // Filter out trusted extensions because those should not be modified\n\n\t\t\t\tif (productService.trustedExtensionAuthAccess && !Array.isArray(productService.trustedExtensionAuthAccess)) {\n\t\t\t\t\tconst trustedExtensions = productService.trustedExtensionAuthAccess[providerId];\n\t\t\t\t\t// If the provider is trusted, add all trusted extensions to the allowed list\n\t\t\t\t\tfor (const ext of trustedExtensions) {\n\t\t\t\t\t\tconst index = allowedExtensions.findIndex(a => a.id === ext);\n\t\t\t\t\t\tif (index !== -1) {\n\t\t\t\t\t\t\tallowedExtensions.splice(index, 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst extension = await extensionService.getExtension(ext);\n\t\t\t\t\t\tif (!extension) {\n\t\t\t\t\t\t\tcontinue; // Skip if the extension is not found\n\t\t\t\t\t\t}\n\t\t\t\t\t\tallowedExtensions.push({\n\t\t\t\t\t\t\tid: ext,\n\t\t\t\t\t\t\tname: extension.displayName || extension.name,\n\t\t\t\t\t\t\tallowed: true, // Assume trusted extensions are allowed by default\n\t\t\t\t\t\t\ttrusted: true // Mark as trusted\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Only grab extensions that are gettable from the extension service\n\t\t\t\tconst filteredExtensions = new Array<AllowedExtension>();\n\t\t\t\tfor (const ext of allowedExtensions) {\n\t\t\t\t\tif (await extensionService.getExtension(ext.id)) {\n\t\t\t\t\t\tfilteredExtensions.push(ext);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\textensionAuth.set(ownerId, filteredExtensions);\n\t\t\t\t// Add all allowed extensions to the set for this owner\n\t\t\t} catch (error) {\n\t\t\t\t// Handle error by ensuring the owner is in the map\n\t\t\t\tif (!extensionAuth.has(ownerId)) {\n\t\t\t\t\textensionAuth.set(ownerId, []);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (extensionAuth.size === 0) {\n\t\t\tdialogService.prompt({\n\t\t\t\ttype: 'info',\n\t\t\t\tmessage: localize('noLanguageModels', 'No language models requiring authentication found.'),\n\t\t\t\tdetail: localize('noLanguageModelsDetail', 'There are currently no language models that require authentication.')\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\tconst items: QuickPickInput<IQuickPickItem & { extension?: AllowedExtension; ownerId?: string }>[] = [];\n\t\t// Create QuickPick items grouped by owner extension\n\t\tfor (const [ownerId, allowedExtensions] of extensionAuth) {\n\t\t\tconst extension = await extensionService.getExtension(ownerId);\n\t\t\tif (!extension) {\n\t\t\t\t// If the extension is not found, skip it\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t// Add separator for the owning extension\n\t\t\titems.push({\n\t\t\t\ttype: 'separator',\n\t\t\t\tid: ownerId,\n\t\t\t\tlabel: localize('extensionOwner', '{0}', extension.displayName || extension.name),\n\t\t\t\tbuttons: [{\n\t\t\t\t\ticonClass: ThemeIcon.asClassName(Codicon.info),\n\t\t\t\t\ttooltip: localize('openExtension', 'Open Extension'),\n\t\t\t\t}]\n\t\t\t});\n\n\t\t\t// Add allowed extensions as checkboxes (visual representation)\n\t\t\tlet addedTrustedSeparator = false;\n\t\t\tif (allowedExtensions.length > 0) {\n\t\t\t\tfor (const allowedExt of allowedExtensions) {\n\t\t\t\t\tif (allowedExt.trusted && !addedTrustedSeparator) {\n\t\t\t\t\t\titems.push({\n\t\t\t\t\t\t\ttype: 'separator',\n\t\t\t\t\t\t\tlabel: localize('trustedExtension', 'Trusted by Microsoft'),\n\t\t\t\t\t\t});\n\t\t\t\t\t\taddedTrustedSeparator = true;\n\t\t\t\t\t}\n\t\t\t\t\titems.push({\n\t\t\t\t\t\tlabel: allowedExt.name,\n\t\t\t\t\t\townerId,\n\t\t\t\t\t\tid: allowedExt.id,\n\t\t\t\t\t\tpicked: allowedExt.allowed ?? false,\n\t\t\t\t\t\textension: allowedExt,\n\t\t\t\t\t\tdisabled: allowedExt.trusted, // Don't allow toggling trusted extensions\n\t\t\t\t\t\tbuttons: [{\n\t\t\t\t\t\t\ticonClass: ThemeIcon.asClassName(Codicon.info),\n\t\t\t\t\t\t\ttooltip: localize('openExtension', 'Open Extension'),\n\t\t\t\t\t\t}]\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\titems.push({\n\t\t\t\t\tlabel: localize('noAllowedExtensions', 'No extensions have access'),\n\t\t\t\t\tdescription: localize('noAccessDescription', 'No extensions are currently allowed to use models from {0}', ownerId),\n\t\t\t\t\tpickable: false\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\t// Show the QuickPick\n\t\tconst result = await quickInputService.pick(\n\t\t\titems,\n\t\t\t{\n\t\t\t\tcanPickMany: true,\n\t\t\t\tsortByLabel: true,\n\t\t\t\tonDidTriggerSeparatorButton(context) {\n\t\t\t\t\t// Handle separator button clicks\n\t\t\t\t\tconst extId = context.separator.id;\n\t\t\t\t\tif (extId) {\n\t\t\t\t\t\t// Open the extension in the editor\n\t\t\t\t\t\tvoid extensionsWorkbenchService.open(extId);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonDidTriggerItemButton(context) {\n\t\t\t\t\t// Handle item button clicks\n\t\t\t\t\tconst extId = context.item.id;\n\t\t\t\t\tif (extId) {\n\t\t\t\t\t\t// Open the extension in the editor\n\t\t\t\t\t\tvoid extensionsWorkbenchService.open(extId);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ttitle: localize('languageModelAuthTitle', 'Manage Language Model Access'),\n\t\t\t\tplaceHolder: localize('languageModelAuthPlaceholder', 'Choose which extensions can access language models'),\n\t\t\t}\n\t\t);\n\t\tif (!result) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const [ownerId, allowedExtensions] of extensionAuth) {\n\t\t\t// diff with result to find out which extensions are allowed or not\n\t\t\t// but we need to only look at the result items that have the ownerId\n\t\t\tconst allowedSet = new Set(result\n\t\t\t\t.filter(item => item.ownerId === ownerId)\n\t\t\t\t// only save items that are not trusted automatically\n\t\t\t\t.filter(item => !item.extension?.trusted)\n\t\t\t\t.map(item => item.id!));\n\n\t\t\tfor (const allowedExt of allowedExtensions) {\n\t\t\t\tallowedExt.allowed = allowedSet.has(allowedExt.id);\n\t\t\t}\n\n\t\t\tauthenticationAccessService.updateAllowedExtensions(\n\t\t\t\tINTERNAL_AUTH_PROVIDER_PREFIX + ownerId,\n\t\t\t\townerToAccountLabel.get(ownerId) || 'Language Models',\n\t\t\t\tallowedExtensions\n\t\t\t);\n\t\t}\n\n\t}\n}\n\nexport function registerLanguageModelActions() {\n\tregisterAction2(ManageLanguageModelAuthenticationAction);\n\tregisterAction2(ManageModelsAction);\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}