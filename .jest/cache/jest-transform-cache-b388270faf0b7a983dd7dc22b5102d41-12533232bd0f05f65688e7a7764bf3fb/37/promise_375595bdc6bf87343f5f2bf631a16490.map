{"version":3,"names":["transaction","derived","observableValue","ObservableLazy","_computeValue","_value","cov_1f40cuwe0p","s","undefined","cachedValue","f","constructor","getValue","v","get","b","set","ObservablePromise","fromFn","fn","resolved","value","Promise","resolve","promise","promiseResult","then","tx","PromiseResult","error","resolvedValue","reader","result","read","getDataOrThrow","data","ObservableLazyPromise","_computePromise","_lazyValue","cachedPromiseResult","getPromise"],"sources":["/home/user/Desktop/MintMind/src/vs/base/common/observableInternal/utils/promise.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { IObservable } from '../base.js';\nimport { transaction } from '../transaction.js';\nimport { derived } from '../observables/derived.js';\nimport { observableValue } from '../observables/observableValue.js';\n\nexport class ObservableLazy<T> {\n\tprivate readonly _value = observableValue<T | undefined>(this, undefined);\n\n\t/**\n\t * The cached value.\n\t * Does not force a computation of the value.\n\t */\n\tpublic get cachedValue(): IObservable<T | undefined> { return this._value; }\n\n\tconstructor(private readonly _computeValue: () => T) {\n\t}\n\n\t/**\n\t * Returns the cached value.\n\t * Computes the value if the value has not been cached yet.\n\t */\n\tpublic getValue(): T {\n\t\tlet v = this._value.get();\n\t\tif (!v) {\n\t\t\tv = this._computeValue();\n\t\t\tthis._value.set(v, undefined);\n\t\t}\n\t\treturn v;\n\t}\n}\n\n/**\n * A promise whose state is observable.\n */\nexport class ObservablePromise<T> {\n\tpublic static fromFn<T>(fn: () => Promise<T>): ObservablePromise<T> {\n\t\treturn new ObservablePromise(fn());\n\t}\n\n\tpublic static resolved<T>(value: T): ObservablePromise<T> {\n\t\treturn new ObservablePromise(Promise.resolve(value));\n\t}\n\n\tprivate readonly _value = observableValue<PromiseResult<T> | undefined>(this, undefined);\n\n\t/**\n\t * The promise that this object wraps.\n\t */\n\tpublic readonly promise: Promise<T>;\n\n\t/**\n\t * The current state of the promise.\n\t * Is `undefined` if the promise didn't resolve yet.\n\t */\n\tpublic readonly promiseResult: IObservable<PromiseResult<T> | undefined> = this._value;\n\n\tconstructor(promise: Promise<T>) {\n\t\tthis.promise = promise.then(value => {\n\t\t\ttransaction(tx => {\n\t\t\t\t/** @description onPromiseResolved */\n\t\t\t\tthis._value.set(new PromiseResult(value, undefined), tx);\n\t\t\t});\n\t\t\treturn value;\n\t\t}, error => {\n\t\t\ttransaction(tx => {\n\t\t\t\t/** @description onPromiseRejected */\n\t\t\t\tthis._value.set(new PromiseResult<T>(undefined, error), tx);\n\t\t\t});\n\t\t\tthrow error;\n\t\t});\n\t}\n\n\tpublic readonly resolvedValue = derived(this, reader => {\n\t\tconst result = this.promiseResult.read(reader);\n\t\tif (!result) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn result.getDataOrThrow();\n\t});\n}\n\nexport class PromiseResult<T> {\n\tconstructor(\n\t\t/**\n\t\t * The value of the resolved promise.\n\t\t * Undefined if the promise rejected.\n\t\t */\n\t\tpublic readonly data: T | undefined,\n\n\t\t/**\n\t\t * The error in case of a rejected promise.\n\t\t * Undefined if the promise resolved.\n\t\t */\n\t\tpublic readonly error: unknown | undefined,\n\t) {\n\t}\n\n\t/**\n\t * Returns the value if the promise resolved, otherwise throws the error.\n\t */\n\tpublic getDataOrThrow(): T {\n\t\tif (this.error) {\n\t\t\tthrow this.error;\n\t\t}\n\t\treturn this.data!;\n\t}\n}\n\n/**\n * A lazy promise whose state is observable.\n */\nexport class ObservableLazyPromise<T> {\n\tprivate readonly _lazyValue = new ObservableLazy(() => new ObservablePromise(this._computePromise()));\n\n\t/**\n\t * Does not enforce evaluation of the promise compute function.\n\t * Is undefined if the promise has not been computed yet.\n\t */\n\tpublic readonly cachedPromiseResult = derived(this, reader => this._lazyValue.cachedValue.read(reader)?.promiseResult.read(reader));\n\n\tconstructor(private readonly _computePromise: () => Promise<T>) {\n\t}\n\n\tpublic getPromise(): Promise<T> {\n\t\treturn this._lazyValue.getValue().promise;\n\t}\n}\n"],"mappings":"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","ignoreList":[]}