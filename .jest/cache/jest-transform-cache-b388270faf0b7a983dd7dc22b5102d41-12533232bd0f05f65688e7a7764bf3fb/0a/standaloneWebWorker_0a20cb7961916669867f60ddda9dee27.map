{"version":3,"names":["cov_13w7os5lj4","actualCoverage","EditorWorkerClient","createWebWorker","modelService","opts","f","s","MonacoWebWorkerImpl","_foreignModuleHost","_foreignProxy","constructor","worker","b","keepIdleModels","host","_getProxy","then","proxy","Proxy","get","target","prop","receiver","undefined","Error","args","$fmr","fhr","method","Promise","reject","resolve","apply","e","getProxy","withSyncedResources","resources","workerWithSyncedResources","_"],"sources":["/home/user/Desktop/MintMind/src/vs/editor/standalone/browser/standaloneWebWorker.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { URI } from '../../../base/common/uri.js';\nimport { EditorWorkerClient } from '../../browser/services/editorWorkerService.js';\nimport { IModelService } from '../../common/services/model.js';\n\n/**\n * Create a new web worker that has model syncing capabilities built in.\n * Specify an AMD module to load that will `create` an object that will be proxied.\n */\nexport function createWebWorker<T extends object>(modelService: IModelService, opts: IInternalWebWorkerOptions): MonacoWebWorker<T> {\n\treturn new MonacoWebWorkerImpl<T>(modelService, opts);\n}\n\n/**\n * A web worker that can provide a proxy to an arbitrary file.\n */\nexport interface MonacoWebWorker<T> {\n\t/**\n\t * Terminate the web worker, thus invalidating the returned proxy.\n\t */\n\tdispose(): void;\n\t/**\n\t * Get a proxy to the arbitrary loaded code.\n\t */\n\tgetProxy(): Promise<T>;\n\t/**\n\t * Synchronize (send) the models at `resources` to the web worker,\n\t * making them available in the monaco.worker.getMirrorModels().\n\t */\n\twithSyncedResources(resources: URI[]): Promise<T>;\n}\n\nexport interface IInternalWebWorkerOptions {\n\t/**\n\t * The worker.\n\t */\n\tworker: Worker | Promise<Worker>;\n\t/**\n\t * An object that can be used by the web worker to make calls back to the main thread.\n\t */\n\thost?: Record<string, Function>;\n\t/**\n\t * Keep idle models.\n\t * Defaults to false, which means that idle models will stop syncing after a while.\n\t */\n\tkeepIdleModels?: boolean;\n}\n\nclass MonacoWebWorkerImpl<T extends object> extends EditorWorkerClient implements MonacoWebWorker<T> {\n\n\tprivate readonly _foreignModuleHost: { [method: string]: Function } | null;\n\tprivate _foreignProxy: Promise<T>;\n\n\tconstructor(modelService: IModelService, opts: IInternalWebWorkerOptions) {\n\t\tsuper(opts.worker, opts.keepIdleModels || false, modelService);\n\t\tthis._foreignModuleHost = opts.host || null;\n\t\tthis._foreignProxy = this._getProxy().then(proxy => {\n\t\t\treturn new Proxy({}, {\n\t\t\t\tget(target, prop, receiver) {\n\t\t\t\t\tif (prop === 'then') {\n\t\t\t\t\t\t// Don't forward the call when the proxy is returned in an async function and the runtime tries to .then it.\n\t\t\t\t\t\treturn undefined;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof prop !== 'string') {\n\t\t\t\t\t\tthrow new Error(`Not supported`);\n\t\t\t\t\t}\n\t\t\t\t\treturn (...args: unknown[]) => {\n\t\t\t\t\t\treturn proxy.$fmr(prop, args);\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}) as T;\n\t\t});\n\t}\n\n\t// foreign host request\n\tpublic override fhr(method: string, args: unknown[]): Promise<unknown> {\n\t\tif (!this._foreignModuleHost || typeof this._foreignModuleHost[method] !== 'function') {\n\t\t\treturn Promise.reject(new Error('Missing method ' + method + ' or missing main thread foreign host.'));\n\t\t}\n\n\t\ttry {\n\t\t\treturn Promise.resolve(this._foreignModuleHost[method].apply(this._foreignModuleHost, args));\n\t\t} catch (e) {\n\t\t\treturn Promise.reject(e);\n\t\t}\n\t}\n\n\tpublic getProxy(): Promise<T> {\n\t\treturn this._foreignProxy;\n\t}\n\n\tpublic withSyncedResources(resources: URI[]): Promise<T> {\n\t\treturn this.workerWithSyncedResources(resources).then(_ => this.getProxy());\n\t}\n}\n"],"mappings":"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","ignoreList":[]}