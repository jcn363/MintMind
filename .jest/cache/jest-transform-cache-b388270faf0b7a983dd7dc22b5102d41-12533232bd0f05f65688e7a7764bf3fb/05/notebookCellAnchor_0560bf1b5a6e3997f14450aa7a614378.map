{"version":3,"names":["cov_1hf272d6z5","actualCoverage","CellFocusMode","CellKind","NotebookCellExecutionState","NotebookSetting","NotebookCellAnchor","notebookExecutionStateService","configurationService","scrollEvent","stopAnchoring","s","executionWatcher","scrollWatcher","constructor","f","shouldAnchor","cellListView","focusedIndex","heightDelta","executingCellUri","element","focusMode","Editor","b","newFocusBottom","elementTop","elementHeight","viewBottom","renderHeight","getScrollTop","focusStillVisible","allowScrolling","getValue","scrollToRevealCell","growing","autoAnchor","watchAchorDuringExecution","executingCell","cellKind","Code","executionState","getCellExecution","uri","state","Executing","onDidStopExecution","dispose","undefined","scrollTop","oldScrollTop"],"sources":["/home/user/Desktop/MintMind/src/vs/workbench/contrib/notebook/browser/view/notebookCellAnchor.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IDisposable } from '../../../../../base/common/lifecycle.js';\nimport { CellFocusMode, ICellViewModel } from '../notebookBrowser.js';\nimport { CodeCellViewModel } from '../viewModel/codeCellViewModel.js';\nimport { CellKind, NotebookCellExecutionState, NotebookSetting } from '../../common/notebookCommon.js';\nimport { INotebookExecutionStateService } from '../../common/notebookExecutionStateService.js';\nimport { Event } from '../../../../../base/common/event.js';\nimport { ScrollEvent } from '../../../../../base/common/scrollable.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { IListView } from '../../../../../base/browser/ui/list/listView.js';\nimport { CellViewModel } from '../viewModel/notebookViewModelImpl.js';\n\n\nexport class NotebookCellAnchor implements IDisposable {\n\n\tprivate stopAnchoring = false;\n\tprivate executionWatcher: IDisposable | undefined;\n\tprivate scrollWatcher: IDisposable | undefined;\n\n\tconstructor(\n\t\tprivate readonly notebookExecutionStateService: INotebookExecutionStateService,\n\t\tprivate readonly configurationService: IConfigurationService,\n\t\tprivate readonly scrollEvent: Event<ScrollEvent>) {\n\t}\n\n\tpublic shouldAnchor(cellListView: IListView<CellViewModel>, focusedIndex: number, heightDelta: number, executingCellUri: ICellViewModel) {\n\t\tif (cellListView.element(focusedIndex).focusMode === CellFocusMode.Editor) {\n\t\t\treturn true;\n\t\t}\n\t\tif (this.stopAnchoring) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst newFocusBottom = cellListView.elementTop(focusedIndex) + cellListView.elementHeight(focusedIndex) + heightDelta;\n\t\tconst viewBottom = cellListView.renderHeight + cellListView.getScrollTop();\n\t\tconst focusStillVisible = viewBottom > newFocusBottom;\n\t\tconst allowScrolling = this.configurationService.getValue(NotebookSetting.scrollToRevealCell) !== 'none';\n\t\tconst growing = heightDelta > 0;\n\t\tconst autoAnchor = allowScrolling && growing && !focusStillVisible;\n\n\t\tif (autoAnchor) {\n\t\t\tthis.watchAchorDuringExecution(executingCellUri);\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tpublic watchAchorDuringExecution(executingCell: ICellViewModel) {\n\t\t// anchor while the cell is executing unless the user scrolls up.\n\t\tif (!this.executionWatcher && executingCell.cellKind === CellKind.Code) {\n\t\t\tconst executionState = this.notebookExecutionStateService.getCellExecution(executingCell.uri);\n\t\t\tif (executionState && executionState.state === NotebookCellExecutionState.Executing) {\n\t\t\t\tthis.executionWatcher = (executingCell as CodeCellViewModel).onDidStopExecution(() => {\n\t\t\t\t\tthis.executionWatcher?.dispose();\n\t\t\t\t\tthis.executionWatcher = undefined;\n\t\t\t\t\tthis.scrollWatcher?.dispose();\n\t\t\t\t\tthis.stopAnchoring = false;\n\t\t\t\t});\n\t\t\t\tthis.scrollWatcher = this.scrollEvent((scrollEvent) => {\n\t\t\t\t\tif (scrollEvent.scrollTop < scrollEvent.oldScrollTop) {\n\t\t\t\t\t\tthis.stopAnchoring = true;\n\t\t\t\t\t\tthis.scrollWatcher?.dispose();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tdispose(): void {\n\t\tthis.executionWatcher?.dispose();\n\t\tthis.scrollWatcher?.dispose();\n\t}\n}\n"],"mappings":"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","ignoreList":[]}