{"version":3,"names":["cov_1m6a312e31","actualCoverage","MainContext","Emitter","createDecorator","ExtHostStorage","_logService","_serviceBrand","_proxy","_onDidChangeStorage","s","onDidChangeStorage","event","constructor","mainContext","f","getProxy","MainThreadStorage","registerExtensionStorageKeysToSync","extension","keys","$registerExtensionStorageKeysToSync","initializeExtensionStorage","shared","key","defaultValue","value","$initializeExtensionStorage","parsedValue","b","safeParseValue","setValue","$setValue","$acceptValue","fire","JSON","parse","error","undefined","IExtHostStorage"],"sources":["/home/user/Desktop/MintMind/src/vs/workbench/api/common/extHostStorage.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { MainContext, MainThreadStorageShape, ExtHostStorageShape } from './extHost.protocol.js';\nimport { Emitter } from '../../../base/common/event.js';\nimport { IExtHostRpcService } from './extHostRpcService.js';\nimport { createDecorator } from '../../../platform/instantiation/common/instantiation.js';\nimport { IExtensionIdWithVersion } from '../../../platform/extensionManagement/common/extensionStorage.js';\nimport { ILogService } from '../../../platform/log/common/log.js';\n\nexport interface IStorageChangeEvent {\n\tshared: boolean;\n\tkey: string;\n\tvalue: object;\n}\n\nexport class ExtHostStorage implements ExtHostStorageShape {\n\n\treadonly _serviceBrand: undefined;\n\n\tprivate _proxy: MainThreadStorageShape;\n\n\tprivate readonly _onDidChangeStorage = new Emitter<IStorageChangeEvent>();\n\treadonly onDidChangeStorage = this._onDidChangeStorage.event;\n\n\tconstructor(\n\t\tmainContext: IExtHostRpcService,\n\t\tprivate readonly _logService: ILogService\n\t) {\n\t\tthis._proxy = mainContext.getProxy(MainContext.MainThreadStorage);\n\t}\n\n\tregisterExtensionStorageKeysToSync(extension: IExtensionIdWithVersion, keys: string[]): void {\n\t\tthis._proxy.$registerExtensionStorageKeysToSync(extension, keys);\n\t}\n\n\tasync initializeExtensionStorage(shared: boolean, key: string, defaultValue?: object): Promise<object | undefined> {\n\t\tconst value = await this._proxy.$initializeExtensionStorage(shared, key);\n\n\t\tlet parsedValue: object | undefined;\n\t\tif (value) {\n\t\t\tparsedValue = this.safeParseValue(shared, key, value);\n\t\t}\n\n\t\treturn parsedValue || defaultValue;\n\t}\n\n\tsetValue(shared: boolean, key: string, value: object): Promise<void> {\n\t\treturn this._proxy.$setValue(shared, key, value);\n\t}\n\n\t$acceptValue(shared: boolean, key: string, value: string): void {\n\t\tconst parsedValue = this.safeParseValue(shared, key, value);\n\t\tif (parsedValue) {\n\t\t\tthis._onDidChangeStorage.fire({ shared, key, value: parsedValue });\n\t\t}\n\t}\n\n\tprivate safeParseValue(shared: boolean, key: string, value: string): object | undefined {\n\t\ttry {\n\t\t\treturn JSON.parse(value);\n\t\t} catch (error) {\n\t\t\t// Do not fail this call but log it for diagnostics\n\t\t\t// https://github.com/microsoft/vscode/issues/132777\n\t\t\tthis._logService.error(`[extHostStorage] unexpected error parsing storage contents (extensionId: ${key}, global: ${shared}): ${error}`);\n\t\t}\n\n\t\treturn undefined;\n\t}\n}\n\nexport interface IExtHostStorage extends ExtHostStorage { }\nexport const IExtHostStorage = createDecorator<IExtHostStorage>('IExtHostStorage');\n"],"mappings":"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","ignoreList":[]}