{"version":3,"names":["cov_2rnugvz2jy","actualCoverage","createSingleCallFunction","CustomEditorModelManager","_references","s","Map","getAllModels","resource","f","keyStart","toString","models","key","entry","b","startsWith","model","push","get","viewType","tryRetain","undefined","counter","then","object","dispose","x","delete","add","existing","Error","set","disposeAllModelsForView","value"],"sources":["/home/user/Desktop/MintMind/src/vs/workbench/contrib/customEditor/common/customEditorModelManager.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { createSingleCallFunction } from '../../../../base/common/functional.js';\nimport { IReference } from '../../../../base/common/lifecycle.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { ICustomEditorModel, ICustomEditorModelManager } from './customEditor.js';\n\nexport class CustomEditorModelManager implements ICustomEditorModelManager {\n\n\tprivate readonly _references = new Map<string, {\n\t\treadonly viewType: string;\n\t\treadonly model: Promise<ICustomEditorModel>;\n\t\tcounter: number;\n\t}>();\n\n\tpublic async getAllModels(resource: URI): Promise<ICustomEditorModel[]> {\n\t\tconst keyStart = `${resource.toString()}@@@`;\n\t\tconst models = [];\n\t\tfor (const [key, entry] of this._references) {\n\t\t\tif (key.startsWith(keyStart) && entry.model) {\n\t\t\t\tmodels.push(await entry.model);\n\t\t\t}\n\t\t}\n\t\treturn models;\n\t}\n\tpublic async get(resource: URI, viewType: string): Promise<ICustomEditorModel | undefined> {\n\t\tconst key = this.key(resource, viewType);\n\t\tconst entry = this._references.get(key);\n\t\treturn entry?.model;\n\t}\n\n\tpublic tryRetain(resource: URI, viewType: string): Promise<IReference<ICustomEditorModel>> | undefined {\n\t\tconst key = this.key(resource, viewType);\n\n\t\tconst entry = this._references.get(key);\n\t\tif (!entry) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tentry.counter++;\n\n\t\treturn entry.model.then(model => {\n\t\t\treturn {\n\t\t\t\tobject: model,\n\t\t\t\tdispose: createSingleCallFunction(() => {\n\t\t\t\t\tif (--entry.counter <= 0) {\n\t\t\t\t\t\tentry.model.then(x => x.dispose());\n\t\t\t\t\t\tthis._references.delete(key);\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t};\n\t\t});\n\t}\n\n\tpublic add(resource: URI, viewType: string, model: Promise<ICustomEditorModel>): Promise<IReference<ICustomEditorModel>> {\n\t\tconst key = this.key(resource, viewType);\n\t\tconst existing = this._references.get(key);\n\t\tif (existing) {\n\t\t\tthrow new Error('Model already exists');\n\t\t}\n\n\t\tthis._references.set(key, { viewType, model, counter: 0 });\n\t\treturn this.tryRetain(resource, viewType)!;\n\t}\n\n\tpublic disposeAllModelsForView(viewType: string): void {\n\t\tfor (const [key, value] of this._references) {\n\t\t\tif (value.viewType === viewType) {\n\t\t\t\tvalue.model.then(x => x.dispose());\n\t\t\t\tthis._references.delete(key);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate key(resource: URI, viewType: string): string {\n\t\treturn `${resource.toString()}@@@${viewType}`;\n\t}\n}\n"],"mappings":"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","ignoreList":[]}