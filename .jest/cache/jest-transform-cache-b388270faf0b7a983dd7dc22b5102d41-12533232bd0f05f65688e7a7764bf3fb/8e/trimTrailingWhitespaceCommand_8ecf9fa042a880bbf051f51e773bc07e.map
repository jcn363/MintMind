{"version":3,"names":["cov_8u886f9fs","actualCoverage","strings","EditOperation","Range","TrimTrailingWhitespaceCommand","_selection","_selectionId","_cursors","_trimInRegexesAndStrings","constructor","selection","cursors","trimInRegexesAndStrings","f","s","getEditOperations","model","builder","ops","trimTrailingWhitespace","i","len","length","op","addEditOperation","range","text","trackSelection","computeCursorState","helper","getTrackedSelection","sort","a","b","lineNumber","column","splice","r","rLen","cursorIndex","cursorLen","lineCount","getLineCount","lineContent","getLineContent","maxLineColumn","minEditColumn","lastNonWhitespaceIndex","fromColumn","tokenization","hasAccurateTokensForLine","lineTokens","getLineTokens","fromColumnType","getStandardTokenType","findTokenIndexAtOffset","Math","max","delete"],"sources":["/home/user/Desktop/MintMind/src/vs/editor/common/commands/trimTrailingWhitespaceCommand.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as strings from '../../../base/common/strings.js';\nimport { EditOperation, ISingleEditOperation } from '../core/editOperation.js';\nimport { Position } from '../core/position.js';\nimport { Range } from '../core/range.js';\nimport { Selection } from '../core/selection.js';\nimport { ICommand, ICursorStateComputerData, IEditOperationBuilder } from '../editorCommon.js';\nimport { StandardTokenType } from '../encodedTokenAttributes.js';\nimport { ITextModel } from '../model.js';\n\nexport class TrimTrailingWhitespaceCommand implements ICommand {\n\n\tprivate readonly _selection: Selection;\n\tprivate _selectionId: string | null;\n\tprivate readonly _cursors: Position[];\n\tprivate readonly _trimInRegexesAndStrings: boolean;\n\n\tconstructor(selection: Selection, cursors: Position[], trimInRegexesAndStrings: boolean) {\n\t\tthis._selection = selection;\n\t\tthis._cursors = cursors;\n\t\tthis._selectionId = null;\n\t\tthis._trimInRegexesAndStrings = trimInRegexesAndStrings;\n\t}\n\n\tpublic getEditOperations(model: ITextModel, builder: IEditOperationBuilder): void {\n\t\tconst ops = trimTrailingWhitespace(model, this._cursors, this._trimInRegexesAndStrings);\n\t\tfor (let i = 0, len = ops.length; i < len; i++) {\n\t\t\tconst op = ops[i];\n\n\t\t\tbuilder.addEditOperation(op.range, op.text);\n\t\t}\n\n\t\tthis._selectionId = builder.trackSelection(this._selection);\n\t}\n\n\tpublic computeCursorState(model: ITextModel, helper: ICursorStateComputerData): Selection {\n\t\treturn helper.getTrackedSelection(this._selectionId!);\n\t}\n}\n\n/**\n * Generate commands for trimming trailing whitespace on a model and ignore lines on which cursors are sitting.\n */\nexport function trimTrailingWhitespace(model: ITextModel, cursors: Position[], trimInRegexesAndStrings: boolean): ISingleEditOperation[] {\n\t// Sort cursors ascending\n\tcursors.sort((a, b) => {\n\t\tif (a.lineNumber === b.lineNumber) {\n\t\t\treturn a.column - b.column;\n\t\t}\n\t\treturn a.lineNumber - b.lineNumber;\n\t});\n\n\t// Reduce multiple cursors on the same line and only keep the last one on the line\n\tfor (let i = cursors.length - 2; i >= 0; i--) {\n\t\tif (cursors[i].lineNumber === cursors[i + 1].lineNumber) {\n\t\t\t// Remove cursor at `i`\n\t\t\tcursors.splice(i, 1);\n\t\t}\n\t}\n\n\tconst r: ISingleEditOperation[] = [];\n\tlet rLen = 0;\n\tlet cursorIndex = 0;\n\tconst cursorLen = cursors.length;\n\n\tfor (let lineNumber = 1, lineCount = model.getLineCount(); lineNumber <= lineCount; lineNumber++) {\n\t\tconst lineContent = model.getLineContent(lineNumber);\n\t\tconst maxLineColumn = lineContent.length + 1;\n\t\tlet minEditColumn = 0;\n\n\t\tif (cursorIndex < cursorLen && cursors[cursorIndex].lineNumber === lineNumber) {\n\t\t\tminEditColumn = cursors[cursorIndex].column;\n\t\t\tcursorIndex++;\n\t\t\tif (minEditColumn === maxLineColumn) {\n\t\t\t\t// The cursor is at the end of the line => no edits for sure on this line\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\n\t\tif (lineContent.length === 0) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tconst lastNonWhitespaceIndex = strings.lastNonWhitespaceIndex(lineContent);\n\n\t\tlet fromColumn = 0;\n\t\tif (lastNonWhitespaceIndex === -1) {\n\t\t\t// Entire line is whitespace\n\t\t\tfromColumn = 1;\n\t\t} else if (lastNonWhitespaceIndex !== lineContent.length - 1) {\n\t\t\t// There is trailing whitespace\n\t\t\tfromColumn = lastNonWhitespaceIndex + 2;\n\t\t} else {\n\t\t\t// There is no trailing whitespace\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (!trimInRegexesAndStrings) {\n\t\t\tif (!model.tokenization.hasAccurateTokensForLine(lineNumber)) {\n\t\t\t\t// We don't want to force line tokenization, as that can be expensive, but we also don't want to trim\n\t\t\t\t// trailing whitespace in lines that are not tokenized yet, as that can be wrong and trim whitespace from\n\t\t\t\t// lines that the user requested we don't. So we bail out if the tokens are not accurate for this line.\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst lineTokens = model.tokenization.getLineTokens(lineNumber);\n\t\t\tconst fromColumnType = lineTokens.getStandardTokenType(lineTokens.findTokenIndexAtOffset(fromColumn));\n\n\t\t\tif (fromColumnType === StandardTokenType.String || fromColumnType === StandardTokenType.RegEx) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\n\t\tfromColumn = Math.max(minEditColumn, fromColumn);\n\t\tr[rLen++] = EditOperation.delete(new Range(\n\t\t\tlineNumber, fromColumn,\n\t\t\tlineNumber, maxLineColumn\n\t\t));\n\t}\n\n\treturn r;\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAwBM;IAAAA,aAAA,YAAAA,CAAA;MAAA,OAA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","ignoreList":[]}