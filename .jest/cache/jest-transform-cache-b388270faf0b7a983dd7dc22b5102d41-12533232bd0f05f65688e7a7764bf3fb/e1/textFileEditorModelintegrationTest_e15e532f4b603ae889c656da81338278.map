{"version":3,"names":["cov_8j4x5u40j","actualCoverage","assert","TextFileEditorModel","workbenchInstantiationService","TestServiceAccessor","ensureNoDisposablesAreLeakedInTestSuite","toResource","createTextBufferFactoryFromStream","CancellationToken","bufferToStream","VSBuffer","DisposableStore","toDisposable","s","suite","f","disposables","instantiationService","accessor","content","setup","undefined","createInstance","fileService","getContent","add","setContent","textFileService","files","teardown","clear","test","testBackupAndRestore","call","largeContent","repeat","resourceA","resourceB","contents","originalModel","resolve","getDecodedStream","fromString","strictEqual","textEditorModel","getValue","backup","None","modelRestoredIdentifier","typeId","resource","workingCopyBackupService","modelRestored","isDirty"],"sources":["/home/user/Desktop/MintMind/src/vs/workbench/services/textfile/test/browser/textFileEditorModel.integrationTest.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport assert from 'assert';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { TextFileEditorModel } from '../../common/textFileEditorModel.js';\nimport { workbenchInstantiationService, TestServiceAccessor } from '../../../../test/browser/workbenchTestServices.js';\nimport { ensureNoDisposablesAreLeakedInTestSuite, toResource } from '../../../../../base/test/common/utils.js';\nimport { TextFileEditorModelManager } from '../../common/textFileEditorModelManager.js';\nimport { createTextBufferFactoryFromStream } from '../../../../../editor/common/model/textModel.js';\nimport { CancellationToken } from '../../../../../base/common/cancellation.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { bufferToStream, VSBuffer } from '../../../../../base/common/buffer.js';\nimport { DisposableStore, toDisposable } from '../../../../../base/common/lifecycle.js';\n\nsuite('Files - TextFileEditorModel (integration)', () => {\n\n\tconst disposables = new DisposableStore();\n\n\tlet instantiationService: IInstantiationService;\n\tlet accessor: TestServiceAccessor;\n\tlet content: string;\n\n\tsetup(() => {\n\t\tinstantiationService = workbenchInstantiationService(undefined, disposables);\n\t\taccessor = instantiationService.createInstance(TestServiceAccessor);\n\t\tcontent = accessor.fileService.getContent();\n\t\tdisposables.add(toDisposable(() => accessor.fileService.setContent(content)));\n\t\tdisposables.add(<TextFileEditorModelManager>accessor.textFileService.files);\n\t});\n\n\tteardown(() => {\n\t\tdisposables.clear();\n\t});\n\n\ttest('backup and restore (simple)', async function () {\n\t\treturn testBackupAndRestore(toResource.call(this, '/path/index_async.txt'), toResource.call(this, '/path/index_async2.txt'), 'Some very small file text content.');\n\t});\n\n\ttest('backup and restore (large, #121347)', async function () {\n\t\tconst largeContent = '국어한\\n'.repeat(100000);\n\t\treturn testBackupAndRestore(toResource.call(this, '/path/index_async.txt'), toResource.call(this, '/path/index_async2.txt'), largeContent);\n\t});\n\n\tasync function testBackupAndRestore(resourceA: URI, resourceB: URI, contents: string): Promise<void> {\n\t\tconst originalModel: TextFileEditorModel = disposables.add(instantiationService.createInstance(TextFileEditorModel, resourceA, 'utf8', undefined));\n\t\tawait originalModel.resolve({\n\t\t\tcontents: await createTextBufferFactoryFromStream(await accessor.textFileService.getDecodedStream(resourceA, bufferToStream(VSBuffer.fromString(contents))))\n\t\t});\n\n\t\tassert.strictEqual(originalModel.textEditorModel?.getValue(), contents);\n\n\t\tconst backup = await originalModel.backup(CancellationToken.None);\n\t\tconst modelRestoredIdentifier = { typeId: originalModel.typeId, resource: resourceB };\n\t\tawait accessor.workingCopyBackupService.backup(modelRestoredIdentifier, backup.content);\n\n\t\tconst modelRestored: TextFileEditorModel = disposables.add(instantiationService.createInstance(TextFileEditorModel, modelRestoredIdentifier.resource, 'utf8', undefined));\n\t\tawait modelRestored.resolve();\n\n\t\tassert.strictEqual(modelRestored.textEditorModel?.getValue(), contents);\n\t\tassert.strictEqual(modelRestored.isDirty(), true);\n\t}\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n});\n"],"mappings":"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","ignoreList":[]}