{"version":3,"names":["cov_1rt75cmozm","actualCoverage","derivedHandleChanges","observableValue","runOnChange","autorun","derived","StringEdit","StringReplacement","EditSources","ObservableWorkspace","getFirstOpenDocument","f","s","documents","get","getDocument","documentId","find","d","uri","toString","_version","onDidOpenDocumentChange","owner","changeTracker","createChangeSummary","didChange","handleChange","ctx","changeSummary","b","reader","docs","read","value","lastActiveDocument","obs","undefined","store","add","set","flatten","StringEditWithReason","reason","replace","range","newText","source","unknown","constructor","replacements"],"sources":["/home/user/Desktop/MintMind/src/vs/workbench/contrib/editTelemetry/browser/helpers/observableWorkspace.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IObservableWithChange, derivedHandleChanges, observableValue, runOnChange, IObservable, autorun, derived } from '../../../../../base/common/observable.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { StringEdit, StringReplacement } from '../../../../../editor/common/core/edits/stringEdit.js';\nimport { OffsetRange } from '../../../../../editor/common/core/ranges/offsetRange.js';\nimport { StringText } from '../../../../../editor/common/core/text/abstractText.js';\nimport { EditSources, TextModelEditSource } from '../../../../../editor/common/textModelEditSource.js';\n\nexport abstract class ObservableWorkspace {\n\tabstract get documents(): IObservable<readonly IObservableDocument[]>;\n\n\n\tgetFirstOpenDocument(): IObservableDocument | undefined {\n\t\treturn this.documents.get()[0];\n\t}\n\n\tgetDocument(documentId: URI): IObservableDocument | undefined {\n\t\treturn this.documents.get().find(d => d.uri.toString() === documentId.toString());\n\t}\n\n\tprivate _version = 0;\n\n\t/**\n\t * Is fired when any open document changes.\n\t*/\n\tpublic readonly onDidOpenDocumentChange = derivedHandleChanges({\n\t\towner: this,\n\t\tchangeTracker: {\n\t\t\tcreateChangeSummary: () => ({ didChange: false }),\n\t\t\thandleChange: (ctx, changeSummary) => {\n\t\t\t\tif (!ctx.didChange(this.documents)) {\n\t\t\t\t\tchangeSummary.didChange = true; // A document changed\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}, (reader, changeSummary) => {\n\t\tconst docs = this.documents.read(reader);\n\t\tfor (const d of docs) {\n\t\t\td.value.read(reader); // add dependency\n\t\t}\n\t\tif (changeSummary.didChange) {\n\t\t\tthis._version++; // to force a change\n\t\t}\n\t\treturn this._version;\n\n\t\t// TODO@hediet make this work:\n\t\t/*\n\t\tconst docs = this.openDocuments.read(reader);\n\t\tfor (const d of docs) {\n\t\t\tif (reader.readChangesSinceLastRun(d.value).length > 0) {\n\t\t\t\treader.reportChange(d);\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t\t*/\n\t});\n\n\tpublic readonly lastActiveDocument = derived((reader) => {\n\t\tconst obs = observableValue('lastActiveDocument', undefined as IObservableDocument | undefined);\n\t\treader.store.add(autorun((reader) => {\n\t\t\tconst docs = this.documents.read(reader);\n\t\t\tfor (const d of docs) {\n\t\t\t\treader.store.add(runOnChange(d.value, () => {\n\t\t\t\t\tobs.set(d, undefined);\n\t\t\t\t}));\n\t\t\t}\n\t\t}));\n\t\treturn obs;\n\t}).flatten();\n}\n\nexport interface IObservableDocument {\n\treadonly uri: URI;\n\treadonly value: IObservableWithChange<StringText, StringEditWithReason>;\n\n\t/**\n\t * Increases whenever the value changes. Is also used to reference document states from the past.\n\t*/\n\treadonly version: IObservable<number>;\n\treadonly languageId: IObservable<string>;\n}\n\nexport class StringEditWithReason extends StringEdit {\n\tpublic static override replace(range: OffsetRange, newText: string, source: TextModelEditSource = EditSources.unknown({})): StringEditWithReason {\n\t\treturn new StringEditWithReason([new StringReplacement(range, newText)], source);\n\t}\n\n\tconstructor(\n\t\treplacements: StringEdit['replacements'],\n\t\tpublic readonly reason: TextModelEditSource,\n\t) {\n\t\tsuper(replacements);\n\t}\n}\n"],"mappings":"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","ignoreList":[]}