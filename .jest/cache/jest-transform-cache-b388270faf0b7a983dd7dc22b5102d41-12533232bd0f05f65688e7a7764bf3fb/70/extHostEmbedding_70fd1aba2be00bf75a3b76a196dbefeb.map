{"version":3,"names":["cov_712oauy46","actualCoverage","CancellationToken","Emitter","toDisposable","MainContext","ExtHostEmbeddings","_proxy","_provider","s","Map","_onDidChange","onDidChange","event","_allKnownModels","Set","_handlePool","constructor","mainContext","f","getProxy","MainThreadEmbeddings","registerEmbeddingsProvider","_extension","embeddingsModel","provider","has","b","Error","handle","$registerEmbeddingProvider","set","id","delete","$unregisterEmbeddingProvider","computeEmbeddings","input","token","None","returnSingle","result","$computeEmbeddings","length","$provideEmbeddings","data","get","provideEmbeddings","embeddingsModels","Array","from","$acceptEmbeddingModels","models","fire"],"sources":["/home/user/Desktop/MintMind/src/vs/workbench/api/common/extHostEmbedding.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CancellationToken } from '../../../base/common/cancellation.js';\nimport { Emitter, Event } from '../../../base/common/event.js';\nimport { IDisposable, toDisposable } from '../../../base/common/lifecycle.js';\nimport { IExtensionDescription } from '../../../platform/extensions/common/extensions.js';\nimport { ExtHostEmbeddingsShape, IMainContext, MainContext, MainThreadEmbeddingsShape } from './extHost.protocol.js';\nimport type * as vscode from 'vscode';\n\n\nexport class ExtHostEmbeddings implements ExtHostEmbeddingsShape {\n\n\tprivate readonly _proxy: MainThreadEmbeddingsShape;\n\tprivate readonly _provider = new Map<number, { id: string; provider: vscode.EmbeddingsProvider }>();\n\n\tprivate readonly _onDidChange = new Emitter<void>();\n\treadonly onDidChange: Event<void> = this._onDidChange.event;\n\n\tprivate _allKnownModels = new Set<string>();\n\tprivate _handlePool: number = 0;\n\n\tconstructor(\n\t\tmainContext: IMainContext\n\t) {\n\t\tthis._proxy = mainContext.getProxy(MainContext.MainThreadEmbeddings);\n\t}\n\n\tregisterEmbeddingsProvider(_extension: IExtensionDescription, embeddingsModel: string, provider: vscode.EmbeddingsProvider): IDisposable {\n\t\tif (this._allKnownModels.has(embeddingsModel)) {\n\t\t\tthrow new Error('An embeddings provider for this model is already registered');\n\t\t}\n\n\t\tconst handle = this._handlePool++;\n\n\t\tthis._proxy.$registerEmbeddingProvider(handle, embeddingsModel);\n\t\tthis._provider.set(handle, { id: embeddingsModel, provider });\n\n\t\treturn toDisposable(() => {\n\t\t\tthis._allKnownModels.delete(embeddingsModel);\n\t\t\tthis._proxy.$unregisterEmbeddingProvider(handle);\n\t\t\tthis._provider.delete(handle);\n\t\t});\n\t}\n\n\tasync computeEmbeddings(embeddingsModel: string, input: string, token?: vscode.CancellationToken): Promise<vscode.Embedding>;\n\tasync computeEmbeddings(embeddingsModel: string, input: string[], token?: vscode.CancellationToken): Promise<vscode.Embedding[]>;\n\tasync computeEmbeddings(embeddingsModel: string, input: string | string[], token?: vscode.CancellationToken): Promise<vscode.Embedding[] | vscode.Embedding> {\n\n\t\ttoken ??= CancellationToken.None;\n\n\t\tlet returnSingle = false;\n\t\tif (typeof input === 'string') {\n\t\t\tinput = [input];\n\t\t\treturnSingle = true;\n\t\t}\n\t\tconst result = await this._proxy.$computeEmbeddings(embeddingsModel, input, token);\n\t\tif (result.length !== input.length) {\n\t\t\tthrow new Error();\n\t\t}\n\t\tif (returnSingle) {\n\t\t\tif (result.length !== 1) {\n\t\t\t\tthrow new Error();\n\t\t\t}\n\t\t\treturn result[0];\n\t\t}\n\t\treturn result;\n\n\t}\n\n\tasync $provideEmbeddings(handle: number, input: string[], token: CancellationToken): Promise<{ values: number[] }[]> {\n\t\tconst data = this._provider.get(handle);\n\t\tif (!data) {\n\t\t\treturn [];\n\t\t}\n\t\tconst result = await data.provider.provideEmbeddings(input, token);\n\t\tif (!result) {\n\t\t\treturn [];\n\t\t}\n\t\treturn result;\n\t}\n\n\tget embeddingsModels(): string[] {\n\t\treturn Array.from(this._allKnownModels);\n\t}\n\n\t$acceptEmbeddingModels(models: string[]): void {\n\t\tthis._allKnownModels = new Set(models);\n\t\tthis._onDidChange.fire();\n\t}\n}\n"],"mappings":"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","ignoreList":[]}