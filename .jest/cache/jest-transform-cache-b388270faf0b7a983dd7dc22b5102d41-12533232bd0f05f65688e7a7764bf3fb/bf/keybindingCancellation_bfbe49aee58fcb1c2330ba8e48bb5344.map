{"version":3,"names":["cov_su1zghx5m","actualCoverage","EditorCommand","registerEditorCommand","IContextKeyService","RawContextKey","CancellationTokenSource","LinkedList","createDecorator","registerSingleton","localize","IEditorCancellationTokens","s","ctxCancellableOperation","_tokens","WeakMap","add","editor","cts","f","data","get","b","invokeWithinContext","accessor","key","bindTo","tokens","set","removeFn","push","isEmpty","undefined","cancel","pop","EditorKeybindingCancellationTokenSource","_unregister","constructor","parent","dispose","id","kbOpts","weight","primary","precondition","runEditorCommand"],"sources":["/home/user/Desktop/MintMind/src/vs/editor/contrib/editorState/browser/keybindingCancellation.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { KeyCode } from '../../../../base/common/keyCodes.js';\nimport { EditorCommand, registerEditorCommand } from '../../../browser/editorExtensions.js';\nimport { ICodeEditor } from '../../../browser/editorBrowser.js';\nimport { IContextKeyService, RawContextKey, IContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { KeybindingWeight } from '../../../../platform/keybinding/common/keybindingsRegistry.js';\nimport { CancellationTokenSource, CancellationToken } from '../../../../base/common/cancellation.js';\nimport { LinkedList } from '../../../../base/common/linkedList.js';\nimport { createDecorator, ServicesAccessor } from '../../../../platform/instantiation/common/instantiation.js';\nimport { InstantiationType, registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { localize } from '../../../../nls.js';\n\n\nconst IEditorCancellationTokens = createDecorator<IEditorCancellationTokens>('IEditorCancelService');\n\ninterface IEditorCancellationTokens {\n\treadonly _serviceBrand: undefined;\n\tadd(editor: ICodeEditor, cts: CancellationTokenSource): () => void;\n\tcancel(editor: ICodeEditor): void;\n}\n\nconst ctxCancellableOperation = new RawContextKey('cancellableOperation', false, localize('cancellableOperation', 'Whether the editor runs a cancellable operation, e.g. like \\'Peek References\\''));\n\nregisterSingleton(IEditorCancellationTokens, class implements IEditorCancellationTokens {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate readonly _tokens = new WeakMap<ICodeEditor, { key: IContextKey<boolean>; tokens: LinkedList<CancellationTokenSource> }>();\n\n\tadd(editor: ICodeEditor, cts: CancellationTokenSource): () => void {\n\t\tlet data = this._tokens.get(editor);\n\t\tif (!data) {\n\t\t\tdata = editor.invokeWithinContext(accessor => {\n\t\t\t\tconst key = ctxCancellableOperation.bindTo(accessor.get(IContextKeyService));\n\t\t\t\tconst tokens = new LinkedList<CancellationTokenSource>();\n\t\t\t\treturn { key, tokens };\n\t\t\t});\n\t\t\tthis._tokens.set(editor, data);\n\t\t}\n\n\t\tlet removeFn: Function | undefined;\n\n\t\tdata.key.set(true);\n\t\tremoveFn = data.tokens.push(cts);\n\n\t\treturn () => {\n\t\t\t// remove w/o cancellation\n\t\t\tif (removeFn) {\n\t\t\t\tremoveFn();\n\t\t\t\tdata.key.set(!data.tokens.isEmpty());\n\t\t\t\tremoveFn = undefined;\n\t\t\t}\n\t\t};\n\t}\n\n\tcancel(editor: ICodeEditor): void {\n\t\tconst data = this._tokens.get(editor);\n\t\tif (!data) {\n\t\t\treturn;\n\t\t}\n\t\t// remove with cancellation\n\t\tconst cts = data.tokens.pop();\n\t\tif (cts) {\n\t\t\tcts.cancel();\n\t\t\tdata.key.set(!data.tokens.isEmpty());\n\t\t}\n\t}\n\n}, InstantiationType.Delayed);\n\nexport class EditorKeybindingCancellationTokenSource extends CancellationTokenSource {\n\n\tprivate readonly _unregister: Function;\n\n\tconstructor(readonly editor: ICodeEditor, parent?: CancellationToken) {\n\t\tsuper(parent);\n\t\tthis._unregister = editor.invokeWithinContext(accessor => accessor.get(IEditorCancellationTokens).add(editor, this));\n\t}\n\n\toverride dispose(): void {\n\t\tthis._unregister();\n\t\tsuper.dispose();\n\t}\n}\n\nregisterEditorCommand(new class extends EditorCommand {\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'editor.cancelOperation',\n\t\t\tkbOpts: {\n\t\t\t\tweight: KeybindingWeight.EditorContrib,\n\t\t\t\tprimary: KeyCode.Escape\n\t\t\t},\n\t\t\tprecondition: ctxCancellableOperation\n\t\t});\n\t}\n\n\trunEditorCommand(accessor: ServicesAccessor, editor: ICodeEditor): void {\n\t\taccessor.get(IEditorCancellationTokens).cancel(editor);\n\t}\n});\n"],"mappings":"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","ignoreList":[]}