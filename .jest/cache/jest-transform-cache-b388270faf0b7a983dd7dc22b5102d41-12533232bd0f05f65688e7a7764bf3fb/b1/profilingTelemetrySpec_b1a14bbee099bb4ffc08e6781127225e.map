{"version":3,"names":["cov_13d4nagr95","actualCoverage","errorHandler","reportSample","data","telemetryService","logService","sendAsErrorTelemtry","f","sample","perfBaseline","source","s","publicLog2","selfTime","totalTime","percentage","functionName","location","callers","caller","map","c","join","callersAnnotated","fakeError","PerformanceError","b","onUnexpectedError","error","Error","constructor","hasOwnProperty","Err","stackTraceLimit","name","trace","absLocation","stack"],"sources":["/home/user/Desktop/MintMind/src/vs/platform/profiling/common/profilingTelemetrySpec.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ILogService } from '../../log/common/log.js';\nimport { BottomUpSample } from './profilingModel.js';\nimport { ITelemetryService } from '../../telemetry/common/telemetry.js';\nimport { errorHandler } from '../../../base/common/errors.js';\n\ntype TelemetrySampleData = {\n\tselfTime: number;\n\ttotalTime: number;\n\tpercentage: number;\n\tperfBaseline: number;\n\tfunctionName: string;\n\tcallers: string;\n\tcallersAnnotated: string;\n\tsource: string;\n};\n\ntype TelemetrySampleDataClassification = {\n\towner: 'jrieken';\n\tcomment: 'A callstack that took a long time to execute';\n\tselfTime: { classification: 'SystemMetaData'; purpose: 'PerformanceAndHealth'; comment: 'Self time of the sample' };\n\ttotalTime: { classification: 'SystemMetaData'; purpose: 'PerformanceAndHealth'; comment: 'Total time of the sample' };\n\tpercentage: { classification: 'SystemMetaData'; purpose: 'PerformanceAndHealth'; comment: 'Relative time (percentage) of the sample' };\n\tperfBaseline: { classification: 'SystemMetaData'; purpose: 'PerformanceAndHealth'; comment: 'Performance baseline for the machine' };\n\tfunctionName: { classification: 'SystemMetaData'; purpose: 'PerformanceAndHealth'; comment: 'The name of the sample' };\n\tcallers: { classification: 'CallstackOrException'; purpose: 'PerformanceAndHealth'; comment: 'The heaviest call trace into this sample' };\n\tcallersAnnotated: { classification: 'SystemMetaData'; purpose: 'PerformanceAndHealth'; comment: 'The heaviest call trace into this sample annotated with respective costs' };\n\tsource: { classification: 'SystemMetaData'; purpose: 'PerformanceAndHealth'; comment: 'The source - either renderer or an extension' };\n};\n\nexport interface SampleData {\n\tperfBaseline: number;\n\tsample: BottomUpSample;\n\tsource: string;\n}\n\nexport function reportSample(data: SampleData, telemetryService: ITelemetryService, logService: ILogService, sendAsErrorTelemtry: boolean): void {\n\n\tconst { sample, perfBaseline, source } = data;\n\n\t// send telemetry event\n\ttelemetryService.publicLog2<TelemetrySampleData, TelemetrySampleDataClassification>(`unresponsive.sample`, {\n\t\tperfBaseline,\n\t\tselfTime: sample.selfTime,\n\t\ttotalTime: sample.totalTime,\n\t\tpercentage: sample.percentage,\n\t\tfunctionName: sample.location,\n\t\tcallers: sample.caller.map(c => c.location).join('<'),\n\t\tcallersAnnotated: sample.caller.map(c => `${c.percentage}|${c.location}`).join('<'),\n\t\tsource\n\t});\n\n\t// log a fake error with a clearer stack\n\tconst fakeError = new PerformanceError(data);\n\tif (sendAsErrorTelemtry) {\n\t\terrorHandler.onUnexpectedError(fakeError);\n\t} else {\n\t\tlogService.error(fakeError);\n\t}\n}\n\nclass PerformanceError extends Error {\n\treadonly selfTime: number;\n\n\tconstructor(data: SampleData) {\n\t\t// Since the stacks are available via the sample\n\t\t// we can avoid collecting them when constructing the error.\n\t\tif (Error.hasOwnProperty('stackTraceLimit')) {\n\t\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\t\tconst Err = Error as any as { stackTraceLimit: number }; // For the monaco editor checks.\n\t\t\tconst stackTraceLimit = Err.stackTraceLimit;\n\t\t\tErr.stackTraceLimit = 0;\n\t\t\tsuper(`PerfSampleError: by ${data.source} in ${data.sample.location}`);\n\t\t\tErr.stackTraceLimit = stackTraceLimit;\n\t\t} else {\n\t\t\tsuper(`PerfSampleError: by ${data.source} in ${data.sample.location}`);\n\t\t}\n\t\tthis.name = 'PerfSampleError';\n\t\tthis.selfTime = data.sample.selfTime;\n\n\t\tconst trace = [data.sample.absLocation, ...data.sample.caller.map(c => c.absLocation)];\n\t\tthis.stack = `\\n\\t at ${trace.join('\\n\\t at ')}`;\n\t}\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAoDE;IAAAA,cAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,cAAA;AApDF;;;;AAQA,SAASE,YAAY,QAAQ,gCAAgC;AAgC7D,OAAM,SAAUC,YAAYA,CAACC,IAAgB,EAAEC,gBAAmC,EAAEC,UAAuB,EAAEC,mBAA4B;EAAA;EAAAP,cAAA,GAAAQ,CAAA;EAExI,MAAM;IAAEC,MAAM;IAAEC,YAAY;IAAEC;EAAM,CAAE;EAAA;EAAA,CAAAX,cAAA,GAAAY,CAAA,OAAGR,IAAI;EAE7C;EAAA;EAAAJ,cAAA,GAAAY,CAAA;EACAP,gBAAgB,CAACQ,UAAU,CAAyD,qBAAqB,EAAE;IAC1GH,YAAY;IACZI,QAAQ,EAAEL,MAAM,CAACK,QAAQ;IACzBC,SAAS,EAAEN,MAAM,CAACM,SAAS;IAC3BC,UAAU,EAAEP,MAAM,CAACO,UAAU;IAC7BC,YAAY,EAAER,MAAM,CAACS,QAAQ;IAC7BC,OAAO,EAAEV,MAAM,CAACW,MAAM,CAACC,GAAG,CAACC,CAAC,IAAI;MAAA;MAAAtB,cAAA,GAAAQ,CAAA;MAAAR,cAAA,GAAAY,CAAA;MAAA,OAAAU,CAAC,CAACJ,QAAQ;IAAR,CAAQ,CAAC,CAACK,IAAI,CAAC,GAAG,CAAC;IACrDC,gBAAgB,EAAEf,MAAM,CAACW,MAAM,CAACC,GAAG,CAACC,CAAC,IAAI;MAAA;MAAAtB,cAAA,GAAAQ,CAAA;MAAAR,cAAA,GAAAY,CAAA;MAAA,UAAGU,CAAC,CAACN,UAAU,IAAIM,CAAC,CAACJ,QAAQ,EAAE;IAAF,CAAE,CAAC,CAACK,IAAI,CAAC,GAAG,CAAC;IACnFZ;GACA,CAAC;EAEF;EACA,MAAMc,SAAS;EAAA;EAAA,CAAAzB,cAAA,GAAAY,CAAA,OAAG,IAAIc,gBAAgB,CAACtB,IAAI,CAAC;EAAC;EAAAJ,cAAA,GAAAY,CAAA;EAC7C,IAAIL,mBAAmB,EAAE;IAAA;IAAAP,cAAA,GAAA2B,CAAA;IAAA3B,cAAA,GAAAY,CAAA;IACxBV,YAAY,CAAC0B,iBAAiB,CAACH,SAAS,CAAC;EAC1C,CAAC,MAAM;IAAA;IAAAzB,cAAA,GAAA2B,CAAA;IAAA3B,cAAA,GAAAY,CAAA;IACNN,UAAU,CAACuB,KAAK,CAACJ,SAAS,CAAC;EAC5B;AACD;AAEA,MAAMC,gBAAiB,SAAQI,KAAK;EAC1BhB,QAAQ;EAEjBiB,YAAY3B,IAAgB;IAAA;IAAAJ,cAAA,GAAAQ,CAAA;IAAAR,cAAA,GAAAY,CAAA;IAC3B;IACA;IACA,IAAIkB,KAAK,CAACE,cAAc,CAAC,iBAAiB,CAAC,EAAE;MAAA;MAAAhC,cAAA,GAAA2B,CAAA;MAC5C;MACA,MAAMM,GAAG;MAAA;MAAA,CAAAjC,cAAA,GAAAY,CAAA,OAAGkB,KAA2C,EAAC,CAAC;MACzD,MAAMI,eAAe;MAAA;MAAA,CAAAlC,cAAA,GAAAY,CAAA,QAAGqB,GAAG,CAACC,eAAe;MAAC;MAAAlC,cAAA,GAAAY,CAAA;MAC5CqB,GAAG,CAACC,eAAe,GAAG,CAAC;MAAC;MAAAlC,cAAA,GAAAY,CAAA;MACxB,KAAK,CAAC,uBAAuBR,IAAI,CAACO,MAAM,OAAOP,IAAI,CAACK,MAAM,CAACS,QAAQ,EAAE,CAAC;MAAC;MAAAlB,cAAA,GAAAY,CAAA;MACvEqB,GAAG,CAACC,eAAe,GAAGA,eAAe;IACtC,CAAC,MAAM;MAAA;MAAAlC,cAAA,GAAA2B,CAAA;MAAA3B,cAAA,GAAAY,CAAA;MACN,KAAK,CAAC,uBAAuBR,IAAI,CAACO,MAAM,OAAOP,IAAI,CAACK,MAAM,CAACS,QAAQ,EAAE,CAAC;IACvE;IAAC;IAAAlB,cAAA,GAAAY,CAAA;IACD,IAAI,CAACuB,IAAI,GAAG,iBAAiB;IAAC;IAAAnC,cAAA,GAAAY,CAAA;IAC9B,IAAI,CAACE,QAAQ,GAAGV,IAAI,CAACK,MAAM,CAACK,QAAQ;IAEpC,MAAMsB,KAAK;IAAA;IAAA,CAAApC,cAAA,GAAAY,CAAA,QAAG,CAACR,IAAI,CAACK,MAAM,CAAC4B,WAAW,EAAE,GAAGjC,IAAI,CAACK,MAAM,CAACW,MAAM,CAACC,GAAG,CAACC,CAAC,IAAI;MAAA;MAAAtB,cAAA,GAAAQ,CAAA;MAAAR,cAAA,GAAAY,CAAA;MAAA,OAAAU,CAAC,CAACe,WAAW;IAAX,CAAW,CAAC,CAAC;IAAC;IAAArC,cAAA,GAAAY,CAAA;IACvF,IAAI,CAAC0B,KAAK,GAAG,WAAWF,KAAK,CAACb,IAAI,CAAC,UAAU,CAAC,EAAE;EACjD","ignoreList":[]}