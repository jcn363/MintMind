{"version":3,"names":["cov_17569j8lup","actualCoverage","importAMDNodeModule","Disposable","autorun","keepObserved","LineRange","Range","TokenizationStateStore","ContiguousMultilineTokensBuilder","observableConfigValue","MonotonousIndexTransformer","linesLengthEditFromModelContentChange","TextMateWorkerTokenizerController","_model","_worker","_languageIdCodec","_backgroundTokenizationStore","_configurationService","_maxTokenizationLineLength","_id","s","controllerId","_pendingChanges","_states","_loggingEnabled","_applyStateStackDiffFn","_initialState","constructor","f","_register","onDidChangeContent","e","_shouldLog","b","console","log","fileName","uri","fsPath","split","pop","changes","changesToString","$acceptModelChanged","push","onDidChangeLanguage","languageId","getLanguageId","encodedLanguageId","encodeLanguageId","$acceptModelLanguageChanged","$acceptNewModel","versionId","getVersionId","lines","getLinesContent","EOL","getEOL","maxTokenizationLineLength","get","reader","read","$acceptMaxTokenizationLineLength","dispose","$acceptRemovedModel","requestTokens","startLineNumber","endLineNumberExclusive","$retokenize","setTokensAndStates","rawTokens","stateDeltas","tokens","deserialize","Uint8Array","updatedTokenLines","map","t","getLineRange","join","updatedStateLines","length","toString","filter","c","change","shift","acceptChanges","curToFutureTransformerTokens","fromMany","i","endLineNumber","result","transform","undefined","add","getLineTokens","finalize","innerChanges","j","applyEdit","range","text","curToFutureTransformerStates","applyStateStackDiff","INITIAL","d","prevState","getEndState","delta","state","setEndState","offset","getLineCount","backgroundTokenizationFinished","setTokens","lift"],"sources":["/home/user/Desktop/MintMind/src/vs/workbench/services/textMate/browser/backgroundTokenization/textMateWorkerTokenizerController.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { importAMDNodeModule } from '../../../../../amdX.js';\nimport { Disposable } from '../../../../../base/common/lifecycle.js';\nimport { IObservable, autorun, keepObserved } from '../../../../../base/common/observable.js';\nimport { Proxied } from '../../../../../base/common/worker/webWorker.js';\nimport { LineRange } from '../../../../../editor/common/core/ranges/lineRange.js';\nimport { Range } from '../../../../../editor/common/core/range.js';\nimport { IBackgroundTokenizationStore, ILanguageIdCodec } from '../../../../../editor/common/languages.js';\nimport { ITextModel } from '../../../../../editor/common/model.js';\nimport { TokenizationStateStore } from '../../../../../editor/common/model/textModelTokens.js';\nimport { IModelContentChangedEvent } from '../../../../../editor/common/textModelEvents.js';\nimport { IModelContentChange } from '../../../../../editor/common/model/mirrorTextModel.js';\nimport { ContiguousMultilineTokensBuilder } from '../../../../../editor/common/tokens/contiguousMultilineTokensBuilder.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { observableConfigValue } from '../../../../../platform/observable/common/platformObservableUtils.js';\nimport { MonotonousIndexTransformer } from '../indexTransformer.js';\nimport type { StateDeltas, TextMateTokenizationWorker } from './worker/textMateTokenizationWorker.worker.js';\nimport type { applyStateStackDiff, StateStack } from 'vscode-textmate';\nimport { linesLengthEditFromModelContentChange } from '../../../../../editor/common/model/textModelStringEdit.js';\n\nexport class TextMateWorkerTokenizerController extends Disposable {\n\tprivate static _id = 0;\n\n\tpublic readonly controllerId;\n\tprivate readonly _pendingChanges: IModelContentChangedEvent[];\n\n\t/**\n\t * These states will eventually equal the worker states.\n\t * _states[i] stores the state at the end of line number i+1.\n\t */\n\tprivate readonly _states;\n\n\tprivate readonly _loggingEnabled;\n\n\tprivate _applyStateStackDiffFn?: typeof applyStateStackDiff;\n\tprivate _initialState?: StateStack;\n\n\tconstructor(\n\t\tprivate readonly _model: ITextModel,\n\t\tprivate readonly _worker: Proxied<TextMateTokenizationWorker>,\n\t\tprivate readonly _languageIdCodec: ILanguageIdCodec,\n\t\tprivate readonly _backgroundTokenizationStore: IBackgroundTokenizationStore,\n\t\tprivate readonly _configurationService: IConfigurationService,\n\t\tprivate readonly _maxTokenizationLineLength: IObservable<number>,\n\t) {\n\t\tsuper();\n\t\tthis.controllerId = TextMateWorkerTokenizerController._id++;\n\t\tthis._pendingChanges = [];\n\t\tthis._states = new TokenizationStateStore<StateStack>();\n\t\tthis._loggingEnabled = observableConfigValue('editor.experimental.asyncTokenizationLogging', false, this._configurationService);\n\n\t\tthis._register(keepObserved(this._loggingEnabled));\n\n\t\tthis._register(this._model.onDidChangeContent((e) => {\n\t\t\tif (this._shouldLog) {\n\t\t\t\tconsole.log('model change', {\n\t\t\t\t\tfileName: this._model.uri.fsPath.split('\\\\').pop(),\n\t\t\t\t\tchanges: changesToString(e.changes),\n\t\t\t\t});\n\t\t\t}\n\t\t\tthis._worker.$acceptModelChanged(this.controllerId, e);\n\t\t\tthis._pendingChanges.push(e);\n\t\t}));\n\n\t\tthis._register(this._model.onDidChangeLanguage((e) => {\n\t\t\tconst languageId = this._model.getLanguageId();\n\t\t\tconst encodedLanguageId =\n\t\t\t\tthis._languageIdCodec.encodeLanguageId(languageId);\n\t\t\tthis._worker.$acceptModelLanguageChanged(\n\t\t\t\tthis.controllerId,\n\t\t\t\tlanguageId,\n\t\t\t\tencodedLanguageId\n\t\t\t);\n\t\t}));\n\n\t\tconst languageId = this._model.getLanguageId();\n\t\tconst encodedLanguageId = this._languageIdCodec.encodeLanguageId(languageId);\n\t\tthis._worker.$acceptNewModel({\n\t\t\turi: this._model.uri,\n\t\t\tversionId: this._model.getVersionId(),\n\t\t\tlines: this._model.getLinesContent(),\n\t\t\tEOL: this._model.getEOL(),\n\t\t\tlanguageId,\n\t\t\tencodedLanguageId,\n\t\t\tmaxTokenizationLineLength: this._maxTokenizationLineLength.get(),\n\t\t\tcontrollerId: this.controllerId,\n\t\t});\n\n\t\tthis._register(autorun(reader => {\n\t\t\t/** @description update maxTokenizationLineLength */\n\t\t\tconst maxTokenizationLineLength = this._maxTokenizationLineLength.read(reader);\n\t\t\tthis._worker.$acceptMaxTokenizationLineLength(this.controllerId, maxTokenizationLineLength);\n\t\t}));\n\t}\n\n\tpublic override dispose(): void {\n\t\tsuper.dispose();\n\t\tthis._worker.$acceptRemovedModel(this.controllerId);\n\t}\n\n\tpublic requestTokens(startLineNumber: number, endLineNumberExclusive: number): void {\n\t\tthis._worker.$retokenize(this.controllerId, startLineNumber, endLineNumberExclusive);\n\t}\n\n\t/**\n\t * This method is called from the worker through the worker host.\n\t */\n\tpublic async setTokensAndStates(controllerId: number, versionId: number, rawTokens: Uint8Array, stateDeltas: StateDeltas[]): Promise<void> {\n\t\tif (this.controllerId !== controllerId) {\n\t\t\t// This event is for an outdated controller (the worker didn't receive the delete/create messages yet), ignore the event.\n\t\t\treturn;\n\t\t}\n\n\t\t// _states state, change{k}, ..., change{versionId}, state delta base & rawTokens, change{j}, ..., change{m}, current renderer state\n\t\t//                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                ^^^^^^^^^^^^^^^^^^^^^^^^^\n\t\t//                | past changes                                                   | future states\n\n\t\tlet tokens = ContiguousMultilineTokensBuilder.deserialize(\n\t\t\tnew Uint8Array(rawTokens)\n\t\t);\n\n\t\tif (this._shouldLog) {\n\t\t\tconsole.log('received background tokenization result', {\n\t\t\t\tfileName: this._model.uri.fsPath.split('\\\\').pop(),\n\t\t\t\tupdatedTokenLines: tokens.map((t) => t.getLineRange()).join(' & '),\n\t\t\t\tupdatedStateLines: stateDeltas.map((s) => new LineRange(s.startLineNumber, s.startLineNumber + s.stateDeltas.length).toString()).join(' & '),\n\t\t\t});\n\t\t}\n\n\t\tif (this._shouldLog) {\n\t\t\tconst changes = this._pendingChanges.filter(c => c.versionId <= versionId).map(c => c.changes).map(c => changesToString(c)).join(' then ');\n\t\t\tconsole.log('Applying changes to local states', changes);\n\t\t}\n\n\t\t// Apply past changes to _states\n\t\twhile (\n\t\t\tthis._pendingChanges.length > 0 &&\n\t\t\tthis._pendingChanges[0].versionId <= versionId\n\t\t) {\n\t\t\tconst change = this._pendingChanges.shift()!;\n\t\t\tthis._states.acceptChanges(change.changes);\n\t\t}\n\n\t\tif (this._pendingChanges.length > 0) {\n\t\t\tif (this._shouldLog) {\n\t\t\t\tconst changes = this._pendingChanges.map(c => c.changes).map(c => changesToString(c)).join(' then ');\n\t\t\t\tconsole.log('Considering non-processed changes', changes);\n\t\t\t}\n\n\t\t\tconst curToFutureTransformerTokens = MonotonousIndexTransformer.fromMany(\n\t\t\t\tthis._pendingChanges.map((c) => linesLengthEditFromModelContentChange(c.changes))\n\t\t\t);\n\n\t\t\t// Filter tokens in lines that got changed in the future to prevent flickering\n\t\t\t// These tokens are recomputed anyway.\n\t\t\tconst b = new ContiguousMultilineTokensBuilder();\n\t\t\tfor (const t of tokens) {\n\t\t\t\tfor (let i = t.startLineNumber; i <= t.endLineNumber; i++) {\n\t\t\t\t\tconst result = curToFutureTransformerTokens.transform(i - 1);\n\t\t\t\t\t// If result is undefined, the current line got touched by an edit.\n\t\t\t\t\t// The webworker will send us new tokens for all the new/touched lines after it received the edits.\n\t\t\t\t\tif (result !== undefined) {\n\t\t\t\t\t\tb.add(i, t.getLineTokens(i) as Uint32Array);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\ttokens = b.finalize();\n\n\t\t\t// Apply future changes to tokens\n\t\t\tfor (const change of this._pendingChanges) {\n\t\t\t\tfor (const innerChanges of change.changes) {\n\t\t\t\t\tfor (let j = 0; j < tokens.length; j++) {\n\t\t\t\t\t\ttokens[j].applyEdit(innerChanges.range, innerChanges.text);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst curToFutureTransformerStates = MonotonousIndexTransformer.fromMany(\n\t\t\tthis._pendingChanges.map((c) => linesLengthEditFromModelContentChange(c.changes))\n\t\t);\n\n\t\tif (!this._applyStateStackDiffFn || !this._initialState) {\n\t\t\tconst { applyStateStackDiff, INITIAL } = await importAMDNodeModule<typeof import('vscode-textmate')>('vscode-textmate', 'release/main.js');\n\t\t\tthis._applyStateStackDiffFn = applyStateStackDiff;\n\t\t\tthis._initialState = INITIAL;\n\t\t}\n\n\n\t\t// Apply state deltas to _states and _backgroundTokenizationStore\n\t\tfor (const d of stateDeltas) {\n\t\t\tlet prevState = d.startLineNumber <= 1 ? this._initialState : this._states.getEndState(d.startLineNumber - 1);\n\t\t\tfor (let i = 0; i < d.stateDeltas.length; i++) {\n\t\t\t\tconst delta = d.stateDeltas[i];\n\t\t\t\tlet state: StateStack;\n\t\t\t\tif (delta) {\n\t\t\t\t\tstate = this._applyStateStackDiffFn(prevState, delta)!;\n\t\t\t\t\tthis._states.setEndState(d.startLineNumber + i, state);\n\t\t\t\t} else {\n\t\t\t\t\tstate = this._states.getEndState(d.startLineNumber + i)!;\n\t\t\t\t}\n\n\t\t\t\tconst offset = curToFutureTransformerStates.transform(d.startLineNumber + i - 1);\n\t\t\t\tif (offset !== undefined) {\n\t\t\t\t\t// Only set the state if there is no future change in this line,\n\t\t\t\t\t// as this might make consumers believe that the state/tokens are accurate\n\t\t\t\t\tthis._backgroundTokenizationStore.setEndState(offset + 1, state);\n\t\t\t\t}\n\n\t\t\t\tif (d.startLineNumber + i >= this._model.getLineCount() - 1) {\n\t\t\t\t\tthis._backgroundTokenizationStore.backgroundTokenizationFinished();\n\t\t\t\t}\n\n\t\t\t\tprevState = state;\n\t\t\t}\n\t\t}\n\t\t// First set states, then tokens, so that events fired from set tokens don't read invalid states\n\t\tthis._backgroundTokenizationStore.setTokens(tokens);\n\t}\n\n\tprivate get _shouldLog() { return this._loggingEnabled.get(); }\n\n}\n\nfunction changesToString(changes: IModelContentChange[]): string {\n\treturn changes.map(c => Range.lift(c.range).toString() + ' => ' + c.text).join(' & ');\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}