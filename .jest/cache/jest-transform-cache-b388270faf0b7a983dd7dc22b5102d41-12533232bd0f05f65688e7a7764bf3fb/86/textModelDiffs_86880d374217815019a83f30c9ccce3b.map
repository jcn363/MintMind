{"version":3,"names":["cov_2fvf3coj9a","actualCoverage","compareBy","numberComparator","BugIndicatingError","Disposable","toDisposable","DetailedLineRangeMapping","LineRangeEdit","MergeEditorLineRange","ReentrancyBarrier","autorun","observableSignal","observableValue","transaction","TextModelDiffs","baseTextModel","textModel","diffComputer","_recomputeCount","s","_state","_diffs","_barrier","_isDisposed","isApplyingChange","f","isOccupied","constructor","recomputeSignal","_register","reader","read","_recompute","onDidChangeContent","makeExclusiveOrSkip","trigger","undefined","state","diffs","_isInitializing","currentRecomputeIdx","get","b","tx","set","result","computeDiff","then","ensureUpToDate","removeDiffs","diffToRemoves","group","sort","d","inputRange","startLineNumber","reverse","diffToRemove","len","length","filter","runExclusivelyOrThrow","edits","getReverseLineEdit","toEdits","getLineCount","pushEditOperations","map","outputRange","isAfter","addOutputLineDelta","applyEditRelativeToOriginal","edit","editMapping","range","fromLength","newLines","firstAfter","delta","newDiffs","Array","diff","intersectsOrTouches","push","findTouchingDiffs","baseRange","getResultLine","lineNumber","offset","contains","endLineNumberExclusive","resultingDeltaFromOriginalToModified","getResultLineRange","start","endExclusive","fromLineNumbers"],"sources":["/home/user/Desktop/MintMind/src/vs/workbench/contrib/mergeEditor/browser/model/textModelDiffs.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { compareBy, numberComparator } from '../../../../../base/common/arrays.js';\nimport { BugIndicatingError } from '../../../../../base/common/errors.js';\nimport { Disposable, toDisposable } from '../../../../../base/common/lifecycle.js';\nimport { ITextModel } from '../../../../../editor/common/model.js';\nimport { DetailedLineRangeMapping } from './mapping.js';\nimport { LineRangeEdit } from './editing.js';\nimport { MergeEditorLineRange } from './lineRange.js';\nimport { ReentrancyBarrier } from '../../../../../base/common/controlFlow.js';\nimport { IMergeDiffComputer } from './diffComputer.js';\nimport { autorun, IObservableWithChange, IReader, ITransaction, observableSignal, observableValue, transaction } from '../../../../../base/common/observable.js';\nimport { UndoRedoGroup } from '../../../../../platform/undoRedo/common/undoRedo.js';\n\nexport class TextModelDiffs extends Disposable {\n\tprivate _recomputeCount = 0;\n\tprivate readonly _state = observableValue<TextModelDiffState, TextModelDiffChangeReason>(this, TextModelDiffState.initializing);\n\tprivate readonly _diffs = observableValue<DetailedLineRangeMapping[], TextModelDiffChangeReason>(this, []);\n\n\tprivate readonly _barrier = new ReentrancyBarrier();\n\tprivate _isDisposed = false;\n\n\tpublic get isApplyingChange() {\n\t\treturn this._barrier.isOccupied;\n\t}\n\n\tconstructor(\n\t\tprivate readonly baseTextModel: ITextModel,\n\t\tprivate readonly textModel: ITextModel,\n\t\tprivate readonly diffComputer: IMergeDiffComputer,\n\t) {\n\t\tsuper();\n\n\t\tconst recomputeSignal = observableSignal('recompute');\n\n\t\tthis._register(autorun(reader => {\n\t\t\t/** @description Update diff state */\n\t\t\trecomputeSignal.read(reader);\n\t\t\tthis._recompute(reader);\n\t\t}));\n\n\t\tthis._register(\n\t\t\tbaseTextModel.onDidChangeContent(\n\t\t\t\tthis._barrier.makeExclusiveOrSkip(() => {\n\t\t\t\t\trecomputeSignal.trigger(undefined);\n\t\t\t\t})\n\t\t\t)\n\t\t);\n\t\tthis._register(\n\t\t\ttextModel.onDidChangeContent(\n\t\t\t\tthis._barrier.makeExclusiveOrSkip(() => {\n\t\t\t\t\trecomputeSignal.trigger(undefined);\n\t\t\t\t})\n\t\t\t)\n\t\t);\n\t\tthis._register(toDisposable(() => {\n\t\t\tthis._isDisposed = true;\n\t\t}));\n\t}\n\n\tpublic get state(): IObservableWithChange<TextModelDiffState, TextModelDiffChangeReason> {\n\t\treturn this._state;\n\t}\n\n\t/**\n\t * Diffs from base to input.\n\t*/\n\tpublic get diffs(): IObservableWithChange<DetailedLineRangeMapping[], TextModelDiffChangeReason> {\n\t\treturn this._diffs;\n\t}\n\n\tprivate _isInitializing = true;\n\n\tprivate _recompute(reader: IReader): void {\n\t\tthis._recomputeCount++;\n\t\tconst currentRecomputeIdx = this._recomputeCount;\n\n\t\tif (this._state.get() === TextModelDiffState.initializing) {\n\t\t\tthis._isInitializing = true;\n\t\t}\n\n\t\ttransaction(tx => {\n\t\t\t/** @description Starting Diff Computation. */\n\t\t\tthis._state.set(\n\t\t\t\tthis._isInitializing ? TextModelDiffState.initializing : TextModelDiffState.updating,\n\t\t\t\ttx,\n\t\t\t\tTextModelDiffChangeReason.other\n\t\t\t);\n\t\t});\n\n\t\tconst result = this.diffComputer.computeDiff(this.baseTextModel, this.textModel, reader);\n\n\t\tresult.then((result) => {\n\t\t\tif (this._isDisposed) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (currentRecomputeIdx !== this._recomputeCount) {\n\t\t\t\t// There is a newer recompute call\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ttransaction(tx => {\n\t\t\t\t/** @description Completed Diff Computation */\n\t\t\t\tif (result.diffs) {\n\t\t\t\t\tthis._state.set(TextModelDiffState.upToDate, tx, TextModelDiffChangeReason.textChange);\n\t\t\t\t\tthis._diffs.set(result.diffs, tx, TextModelDiffChangeReason.textChange);\n\t\t\t\t} else {\n\t\t\t\t\tthis._state.set(TextModelDiffState.error, tx, TextModelDiffChangeReason.textChange);\n\t\t\t\t}\n\t\t\t\tthis._isInitializing = false;\n\t\t\t});\n\t\t});\n\t}\n\n\tprivate ensureUpToDate(): void {\n\t\tif (this.state.get() !== TextModelDiffState.upToDate) {\n\t\t\tthrow new BugIndicatingError('Cannot remove diffs when the model is not up to date');\n\t\t}\n\t}\n\n\tpublic removeDiffs(diffToRemoves: DetailedLineRangeMapping[], transaction: ITransaction | undefined, group?: UndoRedoGroup): void {\n\t\tthis.ensureUpToDate();\n\n\t\tdiffToRemoves.sort(compareBy((d) => d.inputRange.startLineNumber, numberComparator));\n\t\tdiffToRemoves.reverse();\n\n\t\tlet diffs = this._diffs.get();\n\n\t\tfor (const diffToRemove of diffToRemoves) {\n\t\t\t// TODO improve performance\n\t\t\tconst len = diffs.length;\n\t\t\tdiffs = diffs.filter((d) => d !== diffToRemove);\n\t\t\tif (len === diffs.length) {\n\t\t\t\tthrow new BugIndicatingError();\n\t\t\t}\n\n\t\t\tthis._barrier.runExclusivelyOrThrow(() => {\n\t\t\t\tconst edits = diffToRemove.getReverseLineEdit().toEdits(this.textModel.getLineCount());\n\t\t\t\tthis.textModel.pushEditOperations(null, edits, () => null, group);\n\t\t\t});\n\n\t\t\tdiffs = diffs.map((d) =>\n\t\t\t\td.outputRange.isAfter(diffToRemove.outputRange)\n\t\t\t\t\t? d.addOutputLineDelta(diffToRemove.inputRange.length - diffToRemove.outputRange.length)\n\t\t\t\t\t: d\n\t\t\t);\n\t\t}\n\n\t\tthis._diffs.set(diffs, transaction, TextModelDiffChangeReason.other);\n\t}\n\n\t/**\n\t * Edit must be conflict free.\n\t */\n\tpublic applyEditRelativeToOriginal(edit: LineRangeEdit, transaction: ITransaction | undefined, group?: UndoRedoGroup): void {\n\t\tthis.ensureUpToDate();\n\n\t\tconst editMapping = new DetailedLineRangeMapping(\n\t\t\tedit.range,\n\t\t\tthis.baseTextModel,\n\t\t\tMergeEditorLineRange.fromLength(edit.range.startLineNumber, edit.newLines.length),\n\t\t\tthis.textModel\n\t\t);\n\n\t\tlet firstAfter = false;\n\t\tlet delta = 0;\n\t\tconst newDiffs = new Array<DetailedLineRangeMapping>();\n\t\tfor (const diff of this.diffs.get()) {\n\t\t\tif (diff.inputRange.intersectsOrTouches(edit.range)) {\n\t\t\t\tthrow new BugIndicatingError('Edit must be conflict free.');\n\t\t\t} else if (diff.inputRange.isAfter(edit.range)) {\n\t\t\t\tif (!firstAfter) {\n\t\t\t\t\tfirstAfter = true;\n\t\t\t\t\tnewDiffs.push(editMapping.addOutputLineDelta(delta));\n\t\t\t\t}\n\n\t\t\t\tnewDiffs.push(diff.addOutputLineDelta(edit.newLines.length - edit.range.length));\n\t\t\t} else {\n\t\t\t\tnewDiffs.push(diff);\n\t\t\t}\n\n\t\t\tif (!firstAfter) {\n\t\t\t\tdelta += diff.outputRange.length - diff.inputRange.length;\n\t\t\t}\n\t\t}\n\n\t\tif (!firstAfter) {\n\t\t\tfirstAfter = true;\n\t\t\tnewDiffs.push(editMapping.addOutputLineDelta(delta));\n\t\t}\n\n\t\tthis._barrier.runExclusivelyOrThrow(() => {\n\t\t\tconst edits = new LineRangeEdit(edit.range.delta(delta), edit.newLines).toEdits(this.textModel.getLineCount());\n\t\t\tthis.textModel.pushEditOperations(null, edits, () => null, group);\n\t\t});\n\t\tthis._diffs.set(newDiffs, transaction, TextModelDiffChangeReason.other);\n\t}\n\n\tpublic findTouchingDiffs(baseRange: MergeEditorLineRange): DetailedLineRangeMapping[] {\n\t\treturn this.diffs.get().filter(d => d.inputRange.intersectsOrTouches(baseRange));\n\t}\n\n\tprivate getResultLine(lineNumber: number, reader?: IReader): number | DetailedLineRangeMapping {\n\t\tlet offset = 0;\n\t\tconst diffs = reader ? this.diffs.read(reader) : this.diffs.get();\n\t\tfor (const diff of diffs) {\n\t\t\tif (diff.inputRange.contains(lineNumber) || diff.inputRange.endLineNumberExclusive === lineNumber) {\n\t\t\t\treturn diff;\n\t\t\t} else if (diff.inputRange.endLineNumberExclusive < lineNumber) {\n\t\t\t\toffset = diff.resultingDeltaFromOriginalToModified;\n\t\t\t} else {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn lineNumber + offset;\n\t}\n\n\tpublic getResultLineRange(baseRange: MergeEditorLineRange, reader?: IReader): MergeEditorLineRange {\n\t\tlet start = this.getResultLine(baseRange.startLineNumber, reader);\n\t\tif (typeof start !== 'number') {\n\t\t\tstart = start.outputRange.startLineNumber;\n\t\t}\n\t\tlet endExclusive = this.getResultLine(baseRange.endLineNumberExclusive, reader);\n\t\tif (typeof endExclusive !== 'number') {\n\t\t\tendExclusive = endExclusive.outputRange.endLineNumberExclusive;\n\t\t}\n\n\t\treturn MergeEditorLineRange.fromLineNumbers(start, endExclusive);\n\t}\n}\n\nexport const enum TextModelDiffChangeReason {\n\tother = 0,\n\ttextChange = 1,\n}\n\nexport const enum TextModelDiffState {\n\tinitializing = 1,\n\tupToDate = 2,\n\tupdating = 3,\n\terror = 4,\n}\n\nexport interface ITextModelDiffsState {\n\tstate: TextModelDiffState;\n\tdiffs: DetailedLineRangeMapping[];\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}