{"version":3,"names":["cov_2qebdk7ez5","actualCoverage","decodeBase64","VSBuffer","joinPath","resizeImage","data","mimeType","f","isGif","s","b","convertStringToUInt8Array","Promise","resolve","reject","blob","Blob","type","img","Image","url","URL","createObjectURL","src","onload","revokeObjectURL","width","height","scaleFactor","Math","max","round","min","canvas","document","createElement","ctx","getContext","drawImage","jpegTypes","outputMimeType","includes","toBlob","reader","FileReader","Uint8Array","result","onerror","error","readAsArrayBuffer","Error","base64Data","split","isValidBase64","buffer","TextEncoder","encode","convertUint8ArrayToString","decoder","TextDecoder","decodedString","decode","str","test","atob","createFileForMedia","fileService","imagesFolder","dataTransfer","exists","createFolder","ext","filename","Date","now","fileUri","wrap","writeFile","cleanupOldImages","logService","duration","files","children","all","map","file","timestamp","getTimestampFromFilename","name","del","resource","err","match","parseInt","undefined"],"sources":["/home/user/Desktop/MintMind/src/vs/workbench/contrib/chat/browser/imageUtils.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { decodeBase64, VSBuffer } from '../../../../base/common/buffer.js';\nimport { joinPath } from '../../../../base/common/resources.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { IFileService } from '../../../../platform/files/common/files.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\n\n/**\n * Resizes an image provided as a UInt8Array string. Resizing is based on Open AI's algorithm for tokenzing images.\n * https://platform.openai.com/docs/guides/vision#calculating-costs\n * @param data - The UInt8Array string of the image to resize.\n * @returns A promise that resolves to the UInt8Array string of the resized image.\n */\n\nexport async function resizeImage(data: Uint8Array | string, mimeType?: string): Promise<Uint8Array> {\n\tconst isGif = mimeType === 'image/gif';\n\n\tif (typeof data === 'string') {\n\t\tdata = convertStringToUInt8Array(data);\n\t}\n\n\treturn new Promise((resolve, reject) => {\n\t\tconst blob = new Blob([data as Uint8Array<ArrayBuffer>], { type: mimeType });\n\t\tconst img = new Image();\n\t\tconst url = URL.createObjectURL(blob);\n\t\timg.src = url;\n\n\t\timg.onload = () => {\n\t\t\tURL.revokeObjectURL(url);\n\t\t\tlet { width, height } = img;\n\n\t\t\tif ((width <= 768 || height <= 768) && !isGif) {\n\t\t\t\tresolve(data);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Calculate the new dimensions while maintaining the aspect ratio\n\t\t\tif (width > 2048 || height > 2048) {\n\t\t\t\tconst scaleFactor = 2048 / Math.max(width, height);\n\t\t\t\twidth = Math.round(width * scaleFactor);\n\t\t\t\theight = Math.round(height * scaleFactor);\n\t\t\t}\n\n\t\t\tconst scaleFactor = 768 / Math.min(width, height);\n\t\t\twidth = Math.round(width * scaleFactor);\n\t\t\theight = Math.round(height * scaleFactor);\n\n\t\t\tconst canvas = document.createElement('canvas');\n\t\t\tcanvas.width = width;\n\t\t\tcanvas.height = height;\n\t\t\tconst ctx = canvas.getContext('2d');\n\t\t\tif (ctx) {\n\t\t\t\tctx.drawImage(img, 0, 0, width, height);\n\n\t\t\t\tconst jpegTypes = ['image/jpeg', 'image/jpg'];\n\t\t\t\tconst outputMimeType = mimeType && jpegTypes.includes(mimeType) ? 'image/jpeg' : 'image/png';\n\n\t\t\t\tcanvas.toBlob(blob => {\n\t\t\t\t\tif (blob) {\n\t\t\t\t\t\tconst reader = new FileReader();\n\t\t\t\t\t\treader.onload = () => {\n\t\t\t\t\t\t\tresolve(new Uint8Array(reader.result as ArrayBuffer));\n\t\t\t\t\t\t};\n\t\t\t\t\t\treader.onerror = (error) => reject(error);\n\t\t\t\t\t\treader.readAsArrayBuffer(blob);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treject(new Error('Failed to create blob from canvas'));\n\t\t\t\t\t}\n\t\t\t\t}, outputMimeType);\n\t\t\t} else {\n\t\t\t\treject(new Error('Failed to get canvas context'));\n\t\t\t}\n\t\t};\n\t\timg.onerror = (error) => {\n\t\t\tURL.revokeObjectURL(url);\n\t\t\treject(error);\n\t\t};\n\t});\n}\n\nexport function convertStringToUInt8Array(data: string): Uint8Array {\n\tconst base64Data = data.includes(',') ? data.split(',')[1] : data;\n\tif (isValidBase64(base64Data)) {\n\t\treturn decodeBase64(base64Data).buffer;\n\t}\n\treturn new TextEncoder().encode(data);\n}\n\n// Only used for URLs\nexport function convertUint8ArrayToString(data: Uint8Array): string {\n\ttry {\n\t\tconst decoder = new TextDecoder();\n\t\tconst decodedString = decoder.decode(data);\n\t\treturn decodedString;\n\t} catch {\n\t\treturn '';\n\t}\n}\n\nfunction isValidBase64(str: string): boolean {\n\t// checks if the string is a valid base64 string that is NOT encoded\n\treturn /^[A-Za-z0-9+/]*={0,2}$/.test(str) && (() => {\n\t\ttry {\n\t\t\tatob(str);\n\t\t\treturn true;\n\t\t} catch {\n\t\t\treturn false;\n\t\t}\n\t})();\n}\n\nexport async function createFileForMedia(fileService: IFileService, imagesFolder: URI, dataTransfer: Uint8Array, mimeType: string): Promise<URI | undefined> {\n\tconst exists = await fileService.exists(imagesFolder);\n\tif (!exists) {\n\t\tawait fileService.createFolder(imagesFolder);\n\t}\n\n\tconst ext = mimeType.split('/')[1] || 'png';\n\tconst filename = `image-${Date.now()}.${ext}`;\n\tconst fileUri = joinPath(imagesFolder, filename);\n\n\tconst buffer = VSBuffer.wrap(dataTransfer);\n\tawait fileService.writeFile(fileUri, buffer);\n\n\treturn fileUri;\n}\n\nexport async function cleanupOldImages(fileService: IFileService, logService: ILogService, imagesFolder: URI): Promise<void> {\n\tconst exists = await fileService.exists(imagesFolder);\n\tif (!exists) {\n\t\treturn;\n\t}\n\n\tconst duration = 7 * 24 * 60 * 60 * 1000; // 7 days\n\tconst files = await fileService.resolve(imagesFolder);\n\tif (!files.children) {\n\t\treturn;\n\t}\n\n\tawait Promise.all(files.children.map(async (file) => {\n\t\ttry {\n\t\t\tconst timestamp = getTimestampFromFilename(file.name);\n\t\t\tif (timestamp && (Date.now() - timestamp > duration)) {\n\t\t\t\tawait fileService.del(file.resource);\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tlogService.error('Failed to clean up old images', err);\n\t\t}\n\t}));\n}\n\nfunction getTimestampFromFilename(filename: string): number | undefined {\n\tconst match = filename.match(/image-(\\d+)\\./);\n\tif (match) {\n\t\treturn parseInt(match[1], 10);\n\t}\n\treturn undefined;\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}