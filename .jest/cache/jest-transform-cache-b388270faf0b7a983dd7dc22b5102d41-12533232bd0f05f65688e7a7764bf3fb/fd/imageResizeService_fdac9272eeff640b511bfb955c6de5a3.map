{"version":3,"names":["cov_2rnqzdsdno","actualCoverage","decodeBase64","VSBuffer","joinPath","registerSingleton","IImageResizeService","ImageResizeService","resizeImage","data","mimeType","f","isGif","s","b","convertStringToUInt8Array","Promise","resolve","reject","blob","Blob","type","img","Image","url","URL","createObjectURL","src","onload","revokeObjectURL","width","height","scaleFactor","Math","max","round","min","canvas","document","createElement","ctx","getContext","drawImage","jpegTypes","outputMimeType","includes","toBlob","reader","FileReader","Uint8Array","result","onerror","error","readAsArrayBuffer","Error","base64Data","split","isValidBase64","buffer","TextEncoder","encode","convertUint8ArrayToString","decoder","TextDecoder","decodedString","decode","str","createFileForMedia","fileService","imagesFolder","dataTransfer","exists","createFolder","ext","filename","Date","now","fileUri","wrap","writeFile","cleanupOldImages","logService","duration","files","children","all","map","file","timestamp","getTimestampFromFilename","name","del","resource","err","match","parseInt","undefined"],"sources":["/home/user/Desktop/MintMind/src/vs/platform/imageResize/browser/imageResizeService.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { decodeBase64, VSBuffer } from '../../../base/common/buffer.js';\nimport { joinPath } from '../../../base/common/resources.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { IFileService } from '../../files/common/files.js';\nimport { InstantiationType, registerSingleton } from '../../instantiation/common/extensions.js';\nimport { ILogService } from '../../log/common/log.js';\nimport { IImageResizeService } from '../common/imageResizeService.js';\n\n\nexport class ImageResizeService implements IImageResizeService {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\t/**\n\t * Resizes an image provided as a UInt8Array string. Resizing is based on Open AI's algorithm for tokenzing images.\n\t * https://platform.openai.com/docs/guides/vision#calculating-costs\n\t * @param data - The UInt8Array string of the image to resize.\n\t * @returns A promise that resolves to the UInt8Array string of the resized image.\n\t */\n\n\tasync resizeImage(data: Uint8Array | string, mimeType?: string): Promise<Uint8Array> {\n\t\tconst isGif = mimeType === 'image/gif';\n\n\t\tif (typeof data === 'string') {\n\t\t\tdata = this.convertStringToUInt8Array(data);\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst blob = new Blob([data as Uint8Array<ArrayBuffer>], { type: mimeType });\n\t\t\tconst img = new Image();\n\t\t\tconst url = URL.createObjectURL(blob);\n\t\t\timg.src = url;\n\n\t\t\timg.onload = () => {\n\t\t\t\tURL.revokeObjectURL(url);\n\t\t\t\tlet { width, height } = img;\n\n\t\t\t\tif ((width <= 768 || height <= 768) && !isGif) {\n\t\t\t\t\tresolve(data);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Calculate the new dimensions while maintaining the aspect ratio\n\t\t\t\tif (width > 2048 || height > 2048) {\n\t\t\t\t\tconst scaleFactor = 2048 / Math.max(width, height);\n\t\t\t\t\twidth = Math.round(width * scaleFactor);\n\t\t\t\t\theight = Math.round(height * scaleFactor);\n\t\t\t\t}\n\n\t\t\t\tconst scaleFactor = 768 / Math.min(width, height);\n\t\t\t\twidth = Math.round(width * scaleFactor);\n\t\t\t\theight = Math.round(height * scaleFactor);\n\n\t\t\t\tconst canvas = document.createElement('canvas');\n\t\t\t\tcanvas.width = width;\n\t\t\t\tcanvas.height = height;\n\t\t\t\tconst ctx = canvas.getContext('2d');\n\t\t\t\tif (ctx) {\n\t\t\t\t\tctx.drawImage(img, 0, 0, width, height);\n\n\t\t\t\t\tconst jpegTypes = ['image/jpeg', 'image/jpg'];\n\t\t\t\t\tconst outputMimeType = mimeType && jpegTypes.includes(mimeType) ? 'image/jpeg' : 'image/png';\n\n\t\t\t\t\tcanvas.toBlob(blob => {\n\t\t\t\t\t\tif (blob) {\n\t\t\t\t\t\t\tconst reader = new FileReader();\n\t\t\t\t\t\t\treader.onload = () => {\n\t\t\t\t\t\t\t\tresolve(new Uint8Array(reader.result as ArrayBuffer));\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\treader.onerror = (error) => reject(error);\n\t\t\t\t\t\t\treader.readAsArrayBuffer(blob);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treject(new Error('Failed to create blob from canvas'));\n\t\t\t\t\t\t}\n\t\t\t\t\t}, outputMimeType);\n\t\t\t\t} else {\n\t\t\t\t\treject(new Error('Failed to get canvas context'));\n\t\t\t\t}\n\t\t\t};\n\t\t\timg.onerror = (error) => {\n\t\t\t\tURL.revokeObjectURL(url);\n\t\t\t\treject(error);\n\t\t\t};\n\t\t});\n\t}\n\n\tconvertStringToUInt8Array(data: string): Uint8Array {\n\t\tconst base64Data = data.includes(',') ? data.split(',')[1] : data;\n\t\tif (this.isValidBase64(base64Data)) {\n\t\t\treturn decodeBase64(base64Data).buffer;\n\t\t}\n\t\treturn new TextEncoder().encode(data);\n\t}\n\n\t// Only used for URLs\n\tconvertUint8ArrayToString(data: Uint8Array): string {\n\t\ttry {\n\t\t\tconst decoder = new TextDecoder();\n\t\t\tconst decodedString = decoder.decode(data);\n\t\t\treturn decodedString;\n\t\t} catch {\n\t\t\treturn '';\n\t\t}\n\t}\n\n\tisValidBase64(str: string): boolean {\n\t\ttry {\n\t\t\tdecodeBase64(str);\n\t\t\treturn true;\n\t\t} catch {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tasync createFileForMedia(fileService: IFileService, imagesFolder: URI, dataTransfer: Uint8Array, mimeType: string): Promise<URI | undefined> {\n\t\tconst exists = await fileService.exists(imagesFolder);\n\t\tif (!exists) {\n\t\t\tawait fileService.createFolder(imagesFolder);\n\t\t}\n\n\t\tconst ext = mimeType.split('/')[1] || 'png';\n\t\tconst filename = `image-${Date.now()}.${ext}`;\n\t\tconst fileUri = joinPath(imagesFolder, filename);\n\n\t\tconst buffer = VSBuffer.wrap(dataTransfer);\n\t\tawait fileService.writeFile(fileUri, buffer);\n\n\t\treturn fileUri;\n\t}\n\n\tasync cleanupOldImages(fileService: IFileService, logService: ILogService, imagesFolder: URI): Promise<void> {\n\t\tconst exists = await fileService.exists(imagesFolder);\n\t\tif (!exists) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst duration = 7 * 24 * 60 * 60 * 1000; // 7 days\n\t\tconst files = await fileService.resolve(imagesFolder);\n\t\tif (!files.children) {\n\t\t\treturn;\n\t\t}\n\n\t\tawait Promise.all(files.children.map(async (file) => {\n\t\t\ttry {\n\t\t\t\tconst timestamp = this.getTimestampFromFilename(file.name);\n\t\t\t\tif (timestamp && (Date.now() - timestamp > duration)) {\n\t\t\t\t\tawait fileService.del(file.resource);\n\t\t\t\t}\n\t\t\t} catch (err) {\n\t\t\t\tlogService.error('Failed to clean up old images', err);\n\t\t\t}\n\t\t}));\n\t}\n\n\tgetTimestampFromFilename(filename: string): number | undefined {\n\t\tconst match = filename.match(/image-(\\d+)\\./);\n\t\tif (match) {\n\t\t\treturn parseInt(match[1], 10);\n\t\t}\n\t\treturn undefined;\n\t}\n\n\n}\n\nregisterSingleton(IImageResizeService, ImageResizeService, InstantiationType.Delayed);\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}