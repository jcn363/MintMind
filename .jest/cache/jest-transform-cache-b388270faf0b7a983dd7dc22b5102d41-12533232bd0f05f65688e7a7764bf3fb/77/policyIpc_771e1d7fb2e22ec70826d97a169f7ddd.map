{"version":3,"names":["cov_xusndrfw3","actualCoverage","Event","DisposableStore","AbstractPolicyService","PolicyChannel","service","disposables","s","constructor","f","listen","_","event","b","map","onDidChange","names","reduce","r","name","getPolicyValue","Error","call","command","arg","updatePolicyDefinitions","dispose","PolicyChannelClient","channel","policiesData","definition","value","policyDefinitions","undefined","policies","set","delete","_onDidChange","fire","Object","keys","_updatePolicyDefinitions","result"],"sources":["/home/user/Desktop/MintMind/src/vs/platform/policy/common/policyIpc.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IStringDictionary } from '../../../base/common/collections.js';\nimport { Event } from '../../../base/common/event.js';\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\nimport { PolicyName } from '../../../base/common/policy.js';\nimport { IChannel, IServerChannel } from '../../../base/parts/ipc/common/ipc.js';\nimport { AbstractPolicyService, IPolicyService, PolicyDefinition, PolicyValue } from './policy.js';\n\n\nexport class PolicyChannel implements IServerChannel {\n\n\tprivate readonly disposables = new DisposableStore();\n\n\tconstructor(private service: IPolicyService) { }\n\n\tlisten(_: unknown, event: string): Event<any> {\n\t\tswitch (event) {\n\t\t\tcase 'onDidChange': return Event.map(\n\t\t\t\tthis.service.onDidChange,\n\t\t\t\tnames => names.reduce<object>((r, name) => ({ ...r, [name]: this.service.getPolicyValue(name) ?? null }), {}),\n\t\t\t\tthis.disposables\n\t\t\t);\n\t\t}\n\n\t\tthrow new Error(`Event not found: ${event}`);\n\t}\n\n\tcall(_: unknown, command: string, arg?: any): Promise<any> {\n\t\tswitch (command) {\n\t\t\tcase 'updatePolicyDefinitions': return this.service.updatePolicyDefinitions(arg as IStringDictionary<PolicyDefinition>);\n\t\t}\n\n\t\tthrow new Error(`Call not found: ${command}`);\n\t}\n\n\tdispose() {\n\t\tthis.disposables.dispose();\n\t}\n}\n\nexport class PolicyChannelClient extends AbstractPolicyService implements IPolicyService {\n\n\tconstructor(policiesData: IStringDictionary<{ definition: PolicyDefinition; value: PolicyValue }>, private readonly channel: IChannel) {\n\t\tsuper();\n\t\tfor (const name in policiesData) {\n\t\t\tconst { definition, value } = policiesData[name];\n\t\t\tthis.policyDefinitions[name] = definition;\n\t\t\tif (value !== undefined) {\n\t\t\t\tthis.policies.set(name, value);\n\t\t\t}\n\t\t}\n\t\tthis.channel.listen<object>('onDidChange')(policies => {\n\t\t\tfor (const name in policies) {\n\t\t\t\tconst value = policies[name as keyof typeof policies];\n\n\t\t\t\tif (value === null) {\n\t\t\t\t\tthis.policies.delete(name);\n\t\t\t\t} else {\n\t\t\t\t\tthis.policies.set(name, value);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._onDidChange.fire(Object.keys(policies));\n\t\t});\n\t}\n\n\tprotected async _updatePolicyDefinitions(policyDefinitions: IStringDictionary<PolicyDefinition>): Promise<void> {\n\t\tconst result = await this.channel.call<{ [name: PolicyName]: PolicyValue }>('updatePolicyDefinitions', policyDefinitions);\n\t\tfor (const name in result) {\n\t\t\tthis.policies.set(name, result[name]);\n\t\t}\n\t}\n}\n"],"mappings":"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","ignoreList":[]}