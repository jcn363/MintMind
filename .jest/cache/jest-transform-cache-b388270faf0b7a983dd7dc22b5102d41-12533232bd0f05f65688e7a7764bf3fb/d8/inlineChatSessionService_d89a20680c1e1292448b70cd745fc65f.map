{"version":3,"names":["cov_2owi2kpnr6","actualCoverage","raceTimeout","Event","createDecorator","IWorkbenchLayoutService","IViewsService","showChatView","IChatService","IInlineChatSessionService","s","moveToPanelChat","accessor","model","resend","f","viewsService","get","chatService","layoutService","widget","b","viewModel","lastRequest","request","getRequests","slice","adoptRequest","sessionResource","resendRequest","location","focusResponseItem","askInPanelChat","toPromise","onDidChangeViewModel","attachedContext","attachmentModel","addContext","acceptInput","message","text","enableImplicitContext","isVoiceInput","noCommandDetection"],"sources":["/home/user/Desktop/MintMind/src/vs/workbench/contrib/inlineChat/browser/inlineChatSessionService.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { raceTimeout } from '../../../../base/common/async.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { IDisposable } from '../../../../base/common/lifecycle.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { IActiveCodeEditor, ICodeEditor } from '../../../../editor/browser/editorBrowser.js';\nimport { Position } from '../../../../editor/common/core/position.js';\nimport { IRange } from '../../../../editor/common/core/range.js';\nimport { IValidEditOperation } from '../../../../editor/common/model.js';\nimport { createDecorator, ServicesAccessor } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IWorkbenchLayoutService } from '../../../services/layout/browser/layoutService.js';\nimport { IViewsService } from '../../../services/views/common/viewsService.js';\nimport { showChatView } from '../../chat/browser/chat.js';\nimport { IChatEditingSession } from '../../chat/common/chatEditingService.js';\nimport { IChatModel, IChatRequestModel } from '../../chat/common/chatModel.js';\nimport { IChatService } from '../../chat/common/chatService.js';\nimport { Session, StashedSession } from './inlineChatSession.js';\n\nexport interface ISessionKeyComputer {\n\tgetComparisonKey(editor: ICodeEditor, uri: URI): string;\n}\n\nexport const IInlineChatSessionService = createDecorator<IInlineChatSessionService>('IInlineChatSessionService');\n\nexport interface IInlineChatSessionEvent {\n\treadonly editor: ICodeEditor;\n\treadonly session: Session;\n}\n\nexport interface IInlineChatSessionEndEvent extends IInlineChatSessionEvent {\n\treadonly endedByExternalCause: boolean;\n}\n\nexport interface IInlineChatSession2 {\n\treadonly initialPosition: Position;\n\treadonly uri: URI;\n\treadonly chatModel: IChatModel;\n\treadonly editingSession: IChatEditingSession;\n\tdispose(): void;\n}\n\nexport interface IInlineChatSessionService {\n\t_serviceBrand: undefined;\n\n\treadonly onWillStartSession: Event<IActiveCodeEditor>;\n\treadonly onDidMoveSession: Event<IInlineChatSessionEvent>;\n\treadonly onDidStashSession: Event<IInlineChatSessionEvent>;\n\treadonly onDidEndSession: Event<IInlineChatSessionEndEvent>;\n\n\tcreateSession(editor: IActiveCodeEditor, options: { wholeRange?: IRange; session?: Session; headless?: boolean }, token: CancellationToken): Promise<Session | undefined>;\n\n\tmoveSession(session: Session, newEditor: ICodeEditor): void;\n\n\tgetCodeEditor(session: Session): ICodeEditor;\n\n\tgetSession(editor: ICodeEditor, uri: URI): Session | undefined;\n\n\treleaseSession(session: Session): void;\n\n\tstashSession(session: Session, editor: ICodeEditor, undoCancelEdits: IValidEditOperation[]): StashedSession;\n\n\tregisterSessionKeyComputer(scheme: string, value: ISessionKeyComputer): IDisposable;\n\n\tdispose(): void;\n\n\tcreateSession2(editor: ICodeEditor, uri: URI, token: CancellationToken): Promise<IInlineChatSession2>;\n\tgetSession2(uri: URI): IInlineChatSession2 | undefined;\n\tgetSession2(sessionId: string): IInlineChatSession2 | undefined;\n\treadonly onDidChangeSessions: Event<this>;\n}\n\nexport async function moveToPanelChat(accessor: ServicesAccessor, model: IChatModel | undefined, resend: boolean) {\n\n\tconst viewsService = accessor.get(IViewsService);\n\tconst chatService = accessor.get(IChatService);\n\tconst layoutService = accessor.get(IWorkbenchLayoutService);\n\n\tconst widget = await showChatView(viewsService, layoutService);\n\n\tif (widget && widget.viewModel && model) {\n\t\tlet lastRequest: IChatRequestModel | undefined;\n\t\tfor (const request of model.getRequests().slice()) {\n\t\t\tawait chatService.adoptRequest(widget.viewModel.model.sessionResource, request);\n\t\t\tlastRequest = request;\n\t\t}\n\n\t\tif (lastRequest && resend) {\n\t\t\tchatService.resendRequest(lastRequest, { location: widget.location });\n\t\t}\n\n\t\twidget.focusResponseItem();\n\t}\n}\n\nexport async function askInPanelChat(accessor: ServicesAccessor, model: IChatRequestModel) {\n\n\tconst viewsService = accessor.get(IViewsService);\n\tconst layoutService = accessor.get(IWorkbenchLayoutService);\n\n\tconst widget = await showChatView(viewsService, layoutService);\n\n\tif (!widget) {\n\t\treturn;\n\t}\n\n\tif (!widget.viewModel) {\n\t\tawait raceTimeout(Event.toPromise(widget.onDidChangeViewModel), 1000);\n\t}\n\n\tif (model.attachedContext) {\n\t\twidget.attachmentModel.addContext(...model.attachedContext);\n\t}\n\n\twidget.acceptInput(model.message.text, {\n\t\tenableImplicitContext: true,\n\t\tisVoiceInput: false,\n\t\tnoCommandDetection: true\n\t});\n}\n"],"mappings":"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","ignoreList":[]}