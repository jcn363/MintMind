{"version":3,"names":["cov_1ggco1jy2w","actualCoverage","Disposable","mapLspKindToTerminalKind","TerminalCompletionItemKind","Position","LspCompletionProviderAddon","id","s","isBuiltin","triggerCharacters","_provider","_textVirtualModel","_lspTerminalModelContentProvider","constructor","provider","textVirtualModel","lspTerminalModelContentProvider","f","b","activate","terminal","provideCompletions","value","cursorPosition","token","trackPromptInputToVirtualFile","textBeforeCursor","substring","lines","split","column","length","lineNum","object","textEditorModel","getLineCount","positionVirtualDocument","completions","_debugDisplayName","result","provideCompletionItems","triggerKind","item","suggestions","convertedKind","kind","Method","completionItemTemp","createCompletionItemPython","undefined","terminalCompletion","label","extensionId","detail","documentation","replacementRange","resolveCompletionItem","_unresolvedItem","_resolveProvider","push","prefix","lastWord","getLastWord","endsWith","lastSpaceIndex","lastIndexOf","lastDotIndex","lastParenIndex","lastDelimiterIndex","Math","max"],"sources":["/home/user/Desktop/MintMind/src/vs/workbench/contrib/terminalContrib/suggest/browser/lspCompletionProviderAddon.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport type { ITerminalAddon, Terminal } from '@xterm/xterm';\nimport { Disposable, IReference } from '../../../../../base/common/lifecycle.js';\nimport { ITerminalCompletionProvider, type TerminalCompletionList } from './terminalCompletionService.js';\nimport type { CancellationToken } from '../../../../../base/common/cancellation.js';\nimport { ITerminalCompletion, mapLspKindToTerminalKind, TerminalCompletionItemKind } from './terminalCompletionItem.js';\nimport { IResolvedTextEditorModel } from '../../../../../editor/common/services/resolverService.js';\nimport { Position } from '../../../../../editor/common/core/position.js';\nimport { CompletionItemLabel, CompletionItemProvider, CompletionTriggerKind } from '../../../../../editor/common/languages.js';\nimport { LspTerminalModelContentProvider } from './lspTerminalModelContentProvider.js';\nimport { MarkdownString } from '../../../../../base/common/htmlContent.js';\n\nexport class LspCompletionProviderAddon extends Disposable implements ITerminalAddon, ITerminalCompletionProvider {\n\treadonly id = 'lsp';\n\treadonly isBuiltin = true;\n\treadonly triggerCharacters?: string[];\n\tprivate _provider: CompletionItemProvider;\n\tprivate _textVirtualModel: IReference<IResolvedTextEditorModel>;\n\tprivate _lspTerminalModelContentProvider: LspTerminalModelContentProvider;\n\n\tconstructor(\n\t\tprovider: CompletionItemProvider,\n\t\ttextVirtualModel: IReference<IResolvedTextEditorModel>,\n\t\tlspTerminalModelContentProvider: LspTerminalModelContentProvider,\n\t) {\n\t\tsuper();\n\t\tthis._provider = provider;\n\t\tthis._textVirtualModel = textVirtualModel;\n\t\tthis._lspTerminalModelContentProvider = lspTerminalModelContentProvider;\n\t\tthis.triggerCharacters = provider.triggerCharacters ? [...provider.triggerCharacters, ' ', '('] : [' ', '('];\n\t}\n\n\tactivate(terminal: Terminal): void {\n\t\t// console.log('activate');\n\t}\n\n\tasync provideCompletions(value: string, cursorPosition: number, token: CancellationToken): Promise<ITerminalCompletion[] | TerminalCompletionList<ITerminalCompletion> | undefined> {\n\n\t\t// Apply edit for non-executed current commandline --> Pretend we are typing in the real-document.\n\t\tthis._lspTerminalModelContentProvider.trackPromptInputToVirtualFile(value);\n\n\t\tconst textBeforeCursor = value.substring(0, cursorPosition);\n\t\tconst lines = textBeforeCursor.split('\\n');\n\t\tconst column = lines[lines.length - 1].length + 1;\n\n\t\t// Get line from virtualDocument, not from terminal\n\t\tconst lineNum = this._textVirtualModel.object.textEditorModel.getLineCount();\n\t\tconst positionVirtualDocument = new Position(lineNum, column);\n\n\t\tconst completions: ITerminalCompletion[] = [];\n\t\tif (this._provider && this._provider._debugDisplayName !== 'wordbasedCompletions') {\n\n\t\t\tconst result = await this._provider.provideCompletionItems(this._textVirtualModel.object.textEditorModel, positionVirtualDocument, { triggerKind: CompletionTriggerKind.TriggerCharacter }, token);\n\t\t\tfor (const item of (result?.suggestions || [])) {\n\t\t\t\t// TODO: Support more terminalCompletionItemKind for [different LSP providers](https://github.com/microsoft/vscode/issues/249479)\n\t\t\t\tconst convertedKind = item.kind ? mapLspKindToTerminalKind(item.kind) : TerminalCompletionItemKind.Method;\n\t\t\t\tconst completionItemTemp = createCompletionItemPython(cursorPosition, textBeforeCursor, convertedKind, 'lspCompletionItem', undefined);\n\t\t\t\tconst terminalCompletion: ITerminalCompletion = {\n\t\t\t\t\tlabel: item.label,\n\t\t\t\t\tprovider: `lsp:${item.extensionId?.value}`,\n\t\t\t\t\tdetail: item.detail,\n\t\t\t\t\tdocumentation: item.documentation,\n\t\t\t\t\tkind: convertedKind,\n\t\t\t\t\treplacementRange: completionItemTemp.replacementRange,\n\t\t\t\t};\n\n\t\t\t\t// Store unresolved item and provider for lazy resolution if needed\n\t\t\t\tif (this._provider.resolveCompletionItem && (!item.detail || !item.documentation)) {\n\t\t\t\t\tterminalCompletion._unresolvedItem = item;\n\t\t\t\t\tterminalCompletion._resolveProvider = this._provider;\n\t\t\t\t}\n\n\t\t\t\tcompletions.push(terminalCompletion);\n\t\t\t}\n\t\t}\n\n\t\treturn completions;\n\t}\n}\n\nexport function createCompletionItemPython(\n\tcursorPosition: number,\n\tprefix: string,\n\tkind: TerminalCompletionItemKind,\n\tlabel: string | CompletionItemLabel,\n\tdetail: string | undefined\n): TerminalCompletionItem {\n\tconst lastWord = getLastWord(prefix);\n\n\treturn {\n\t\tlabel,\n\t\tdetail: detail ?? '',\n\t\treplacementRange: [cursorPosition - lastWord.length, cursorPosition],\n\t\tkind: kind ?? TerminalCompletionItemKind.Method\n\t};\n}\n\nfunction getLastWord(prefix: string): string {\n\tif (prefix.endsWith(' ')) {\n\t\treturn '';\n\t}\n\n\tif (prefix.endsWith('.')) {\n\t\treturn '';\n\t}\n\n\tconst lastSpaceIndex = prefix.lastIndexOf(' ');\n\tconst lastDotIndex = prefix.lastIndexOf('.');\n\tconst lastParenIndex = prefix.lastIndexOf('(');\n\n\t// Get the maximum index (most recent delimiter)\n\tconst lastDelimiterIndex = Math.max(lastSpaceIndex, lastDotIndex, lastParenIndex);\n\n\t// If no delimiter found, return the entire prefix\n\tif (lastDelimiterIndex === -1) {\n\t\treturn prefix;\n\t}\n\n\t// Return the substring after the last delimiter\n\treturn prefix.substring(lastDelimiterIndex + 1);\n}\n\nexport interface TerminalCompletionItem {\n\t/**\n\t * The label of the completion.\n\t */\n\tlabel: string | CompletionItemLabel;\n\n\t/**\n\t * Selection range (inclusive start, exclusive end) to replace when this completion is applied.\n\t */\n\treplacementRange: readonly [number, number] | undefined;\n\n\t/**\n\t * The completion's detail which appears on the right of the list.\n\t */\n\tdetail?: string;\n\n\t/**\n\t * A human-readable string that represents a doc-comment.\n\t */\n\tdocumentation?: string | MarkdownString;\n\n\t/**\n\t * The completion's kind. Note that this will map to an icon.\n\t */\n\tkind?: TerminalCompletionItemKind;\n}\n"],"mappings":"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","ignoreList":[]}