{"version":3,"names":["dom","mainWindow","Event","Disposable","MutableDisposable","CHECK_INTERVAL","cov_1vcdd1rjuw","s","MIN_INTERVALS_WITHOUT_ACTIVITY","eventListenerOptions","passive","capture","DomActivityTracker","constructor","userActivityService","f","intervalsWithoutActivity","intervalTimer","_register","WindowIntervalTimer","activeMutex","value","markActive","onInterval","b","clear","cancel","onActivity","targetWindow","cancelAndSet","runAndSubscribe","onDidRegisterWindow","window","disposables","add","addDisposableListener","document","_store"],"sources":["/home/user/Desktop/MintMind/src/vs/workbench/services/userActivity/browser/domActivityTracker.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from '../../../../base/browser/dom.js';\nimport { mainWindow } from '../../../../base/browser/window.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { Disposable, MutableDisposable } from '../../../../base/common/lifecycle.js';\nimport { IUserActivityService } from '../common/userActivityService.js';\n\n/**\n * This uses a time interval and checks whether there's any activity in that\n * interval. A naive approach might be to use a debounce whenever an event\n * happens, but this has some scheduling overhead. Instead, the tracker counts\n * how many intervals have elapsed since any activity happened.\n *\n * If there's more than `MIN_INTERVALS_WITHOUT_ACTIVITY`, then say the user is\n * inactive. Therefore the maximum time before an inactive user is detected\n * is `CHECK_INTERVAL * (MIN_INTERVALS_WITHOUT_ACTIVITY + 1)`.\n */\nconst CHECK_INTERVAL = 30_000;\n\n/** See {@link CHECK_INTERVAL} */\nconst MIN_INTERVALS_WITHOUT_ACTIVITY = 2;\n\nconst eventListenerOptions: AddEventListenerOptions = {\n\tpassive: true, /** does not preventDefault() */\n\tcapture: true, /** should dispatch first (before anyone stopPropagation()) */\n};\n\nexport class DomActivityTracker extends Disposable {\n\tconstructor(userActivityService: IUserActivityService) {\n\t\tsuper();\n\n\t\tlet intervalsWithoutActivity = MIN_INTERVALS_WITHOUT_ACTIVITY;\n\t\tconst intervalTimer = this._register(new dom.WindowIntervalTimer());\n\t\tconst activeMutex = this._register(new MutableDisposable());\n\t\tactiveMutex.value = userActivityService.markActive();\n\n\t\tconst onInterval = () => {\n\t\t\tif (++intervalsWithoutActivity === MIN_INTERVALS_WITHOUT_ACTIVITY) {\n\t\t\t\tactiveMutex.clear();\n\t\t\t\tintervalTimer.cancel();\n\t\t\t}\n\t\t};\n\n\t\tconst onActivity = (targetWindow: Window & typeof globalThis) => {\n\t\t\t// if was inactive, they've now returned\n\t\t\tif (intervalsWithoutActivity === MIN_INTERVALS_WITHOUT_ACTIVITY) {\n\t\t\t\tactiveMutex.value = userActivityService.markActive();\n\t\t\t\tintervalTimer.cancelAndSet(onInterval, CHECK_INTERVAL, targetWindow);\n\t\t\t}\n\n\t\t\tintervalsWithoutActivity = 0;\n\t\t};\n\n\t\tthis._register(Event.runAndSubscribe(dom.onDidRegisterWindow, ({ window, disposables }) => {\n\t\t\tdisposables.add(dom.addDisposableListener(window.document, 'touchstart', () => onActivity(window), eventListenerOptions));\n\t\t\tdisposables.add(dom.addDisposableListener(window.document, 'mousedown', () => onActivity(window), eventListenerOptions));\n\t\t\tdisposables.add(dom.addDisposableListener(window.document, 'keydown', () => onActivity(window), eventListenerOptions));\n\t\t}, { window: mainWindow, disposables: this._store }));\n\n\t\tonActivity(mainWindow);\n\t}\n}\n"],"mappings":"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","ignoreList":[]}