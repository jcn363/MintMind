{"version":3,"names":["cov_1d8lv8cga1","actualCoverage","assert","cp","promises","fs","os","ensureNoDisposablesAreLeakedInTestSuite","isWindows","dirname","join","FileAccess","util","exec","s","promisify","suite","f","test","process","env","b","skip","timeout","rootPath","asFileUri","fsPath","checkedInFile","tempFile","tmpdir","Date","now","scriptPath","cwd","exportedContent","checkedInContent","Promise","all","readFile","strictEqual","unlink"],"sources":["/home/user/Desktop/MintMind/src/vs/workbench/contrib/policyExport/test/node/policyExport.integrationTest.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as assert from 'assert';\nimport * as cp from 'child_process';\nimport { promises as fs } from 'fs';\nimport * as os from 'os';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from '../../../../../base/test/common/utils.js';\nimport { isWindows } from '../../../../../base/common/platform.js';\nimport { dirname, join } from '../../../../../base/common/path.js';\nimport { FileAccess } from '../../../../../base/common/network.js';\nimport * as util from 'util';\n\nconst exec = util.promisify(cp.exec);\n\nsuite('PolicyExport Integration Tests', () => {\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('exported policy data matches checked-in file', async function () {\n\t\t// Skip this test in ADO pipelines\n\t\tif (process.env['TF_BUILD']) {\n\t\t\tthis.skip();\n\t\t}\n\n\t\t// This test launches MintMind with --export-policy-data flag, so it takes longer\n\t\tthis.timeout(60000);\n\n\t\t// Get the repository root (FileAccess.asFileUri('') points to the 'out' directory)\n\t\tconst rootPath = dirname(FileAccess.asFileUri('').fsPath);\n\t\tconst checkedInFile = join(rootPath, 'build/lib/policies/policyData.jsonc');\n\t\tconst tempFile = join(os.tmpdir(), `policyData-test-${Date.now()}.jsonc`);\n\n\t\ttry {\n\t\t\t// Launch MintMind with --export-policy-data flag\n\t\t\tconst scriptPath = isWindows\n\t\t\t\t? join(rootPath, 'scripts', 'code.bat')\n\t\t\t\t: join(rootPath, 'scripts', 'code.sh');\n\n\t\t\tawait exec(`\"${scriptPath}\" --export-policy-data=\"${tempFile}\"`, {\n\t\t\t\tcwd: rootPath\n\t\t\t});\n\n\t\t\t// Read both files\n\t\t\tconst [exportedContent, checkedInContent] = await Promise.all([\n\t\t\t\tfs.readFile(tempFile, 'utf-8'),\n\t\t\t\tfs.readFile(checkedInFile, 'utf-8')\n\t\t\t]);\n\n\t\t\t// Compare contents\n\t\t\tassert.strictEqual(\n\t\t\t\texportedContent,\n\t\t\t\tcheckedInContent,\n\t\t\t\t'Exported policy data should match the checked-in file. If this fails, run: ./scripts/code.sh --export-policy-data'\n\t\t\t);\n\t\t} finally {\n\t\t\t// Clean up temp file\n\t\t\ttry {\n\t\t\t\tawait fs.unlink(tempFile);\n\t\t\t} catch {\n\t\t\t\t// Ignore cleanup errors\n\t\t\t}\n\t\t}\n\t});\n});\n"],"mappings":"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","ignoreList":[]}