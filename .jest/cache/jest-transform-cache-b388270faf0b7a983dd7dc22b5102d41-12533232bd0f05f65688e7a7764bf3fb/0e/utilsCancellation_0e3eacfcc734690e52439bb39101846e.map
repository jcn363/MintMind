{"version":3,"names":["cov_22j4gupizm","actualCoverage","DebugNameData","CancellationError","CancellationTokenSource","strictEquals","autorun","Derived","DebugLocation","waitForState","observable","predicate","isError","cancellationToken","f","s","b","state","undefined","Promise","resolve","reject","isImmediateRun","shouldDispose","stateObs","map","isFinished","error","d","reader","read","dispose","dc","onCancellationRequested","isCancellationRequested","derivedWithCancellationToken","computeFnOrOwner","computeFnOrUndefined","computeFn","owner","cancellationTokenSource","r","token","ofCaller"],"sources":["/home/user/Desktop/MintMind/src/vs/base/common/observableInternal/utils/utilsCancellation.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IReader, IObservable } from '../base.js';\nimport { DebugOwner, DebugNameData } from '../debugName.js';\nimport { CancellationError, CancellationToken, CancellationTokenSource } from '../commonFacade/cancellation.js';\nimport { strictEquals } from '../commonFacade/deps.js';\nimport { autorun } from '../reactions/autorun.js';\nimport { Derived } from '../observables/derivedImpl.js';\nimport { DebugLocation } from '../debugLocation.js';\n\n/**\n * Resolves the promise when the observables state matches the predicate.\n */\nexport function waitForState<T>(observable: IObservable<T | null | undefined>): Promise<T>;\nexport function waitForState<T, TState extends T>(observable: IObservable<T>, predicate: (state: T) => state is TState, isError?: (state: T) => boolean | unknown | undefined, cancellationToken?: CancellationToken): Promise<TState>;\nexport function waitForState<T>(observable: IObservable<T>, predicate: (state: T) => boolean, isError?: (state: T) => boolean | unknown | undefined, cancellationToken?: CancellationToken): Promise<T>;\nexport function waitForState<T>(observable: IObservable<T>, predicate?: (state: T) => boolean, isError?: (state: T) => boolean | unknown | undefined, cancellationToken?: CancellationToken): Promise<T> {\n\tif (!predicate) {\n\t\tpredicate = state => state !== null && state !== undefined;\n\t}\n\treturn new Promise((resolve, reject) => {\n\t\tlet isImmediateRun = true;\n\t\tlet shouldDispose = false;\n\t\tconst stateObs = observable.map(state => {\n\t\t\t/** @description waitForState.state */\n\t\t\treturn {\n\t\t\t\tisFinished: predicate(state),\n\t\t\t\terror: isError ? isError(state) : false,\n\t\t\t\tstate\n\t\t\t};\n\t\t});\n\t\tconst d = autorun(reader => {\n\t\t\t/** @description waitForState */\n\t\t\tconst { isFinished, error, state } = stateObs.read(reader);\n\t\t\tif (isFinished || error) {\n\t\t\t\tif (isImmediateRun) {\n\t\t\t\t\t// The variable `d` is not initialized yet\n\t\t\t\t\tshouldDispose = true;\n\t\t\t\t} else {\n\t\t\t\t\td.dispose();\n\t\t\t\t}\n\t\t\t\tif (error) {\n\t\t\t\t\treject(error === true ? state : error);\n\t\t\t\t} else {\n\t\t\t\t\tresolve(state);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tif (cancellationToken) {\n\t\t\tconst dc = cancellationToken.onCancellationRequested(() => {\n\t\t\t\td.dispose();\n\t\t\t\tdc.dispose();\n\t\t\t\treject(new CancellationError());\n\t\t\t});\n\t\t\tif (cancellationToken.isCancellationRequested) {\n\t\t\t\td.dispose();\n\t\t\t\tdc.dispose();\n\t\t\t\treject(new CancellationError());\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tisImmediateRun = false;\n\t\tif (shouldDispose) {\n\t\t\td.dispose();\n\t\t}\n\t});\n}\n\nexport function derivedWithCancellationToken<T>(computeFn: (reader: IReader, cancellationToken: CancellationToken) => T): IObservable<T>;\nexport function derivedWithCancellationToken<T>(owner: object, computeFn: (reader: IReader, cancellationToken: CancellationToken) => T): IObservable<T>;\nexport function derivedWithCancellationToken<T>(computeFnOrOwner: ((reader: IReader, cancellationToken: CancellationToken) => T) | object, computeFnOrUndefined?: ((reader: IReader, cancellationToken: CancellationToken) => T)): IObservable<T> {\n\tlet computeFn: (reader: IReader, store: CancellationToken) => T;\n\tlet owner: DebugOwner;\n\tif (computeFnOrUndefined === undefined) {\n\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\tcomputeFn = computeFnOrOwner as any;\n\t\towner = undefined;\n\t} else {\n\t\towner = computeFnOrOwner;\n\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\tcomputeFn = computeFnOrUndefined as any;\n\t}\n\n\tlet cancellationTokenSource: CancellationTokenSource | undefined = undefined;\n\treturn new Derived(\n\t\tnew DebugNameData(owner, undefined, computeFn),\n\t\tr => {\n\t\t\tif (cancellationTokenSource) {\n\t\t\t\tcancellationTokenSource.dispose(true);\n\t\t\t}\n\t\t\tcancellationTokenSource = new CancellationTokenSource();\n\t\t\treturn computeFn(r, cancellationTokenSource.token);\n\t\t}, undefined,\n\t\t() => cancellationTokenSource?.dispose(),\n\t\tstrictEquals,\n\t\tDebugLocation.ofCaller()\n\t);\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAwBM;IAAAA,cAAA,YAAAA,CAAA;MAAA,O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","ignoreList":[]}