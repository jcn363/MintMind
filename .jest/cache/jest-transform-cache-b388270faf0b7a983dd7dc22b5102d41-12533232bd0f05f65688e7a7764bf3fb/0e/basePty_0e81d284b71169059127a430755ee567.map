{"version":3,"names":["cov_97ej0hlzl","actualCoverage","Emitter","Disposable","mark","URI","BasePty","id","shouldPersist","_properties","s","cwd","initialCwd","fixedDimensions","cols","undefined","rows","title","shellType","hasChildProcesses","resolvedShellLaunchConfig","overrideDimensions","failedShellIntegrationActivation","usedShellIntegrationInjection","shellIntegrationInjectionFailureReason","_lastDimensions","_inReplay","_onProcessData","_register","onProcessData","event","_onProcessReplayComplete","onProcessReplayComplete","_onProcessReady","onProcessReady","_onDidChangeProperty","onDidChangeProperty","_onProcessExit","onProcessExit","_onRestoreCommands","onRestoreCommands","constructor","f","getInitialCwd","getCwd","b","handleData","e","fire","handleExit","handleReady","handleDidChangeProperty","type","value","revive","handleReplay","innerEvent","events","forceExactSize","data","trackCommit","writePromise","commands"],"sources":["/home/user/Desktop/MintMind/src/vs/workbench/contrib/terminal/common/basePty.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter } from '../../../../base/common/event.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { mark } from '../../../../base/common/performance.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport type { IPtyHostProcessReplayEvent, ISerializedCommandDetectionCapability } from '../../../../platform/terminal/common/capabilities/capabilities.js';\nimport { ProcessPropertyType, type IProcessDataEvent, type IProcessProperty, type IProcessPropertyMap, type IProcessReadyEvent, type ITerminalChildProcess } from '../../../../platform/terminal/common/terminal.js';\n\n/**\n * Responsible for establishing and maintaining a connection with an existing terminal process\n * created on the local pty host.\n */\nexport abstract class BasePty extends Disposable implements Partial<ITerminalChildProcess> {\n\tprotected readonly _properties: IProcessPropertyMap = {\n\t\tcwd: '',\n\t\tinitialCwd: '',\n\t\tfixedDimensions: { cols: undefined, rows: undefined },\n\t\ttitle: '',\n\t\tshellType: undefined,\n\t\thasChildProcesses: true,\n\t\tresolvedShellLaunchConfig: {},\n\t\toverrideDimensions: undefined,\n\t\tfailedShellIntegrationActivation: false,\n\t\tusedShellIntegrationInjection: undefined,\n\t\tshellIntegrationInjectionFailureReason: undefined,\n\t};\n\tprotected readonly _lastDimensions: { cols: number; rows: number } = { cols: -1, rows: -1 };\n\tprotected _inReplay = false;\n\n\tprotected readonly _onProcessData = this._register(new Emitter<IProcessDataEvent | string>());\n\treadonly onProcessData = this._onProcessData.event;\n\tprotected readonly _onProcessReplayComplete = this._register(new Emitter<void>());\n\treadonly onProcessReplayComplete = this._onProcessReplayComplete.event;\n\tprotected readonly _onProcessReady = this._register(new Emitter<IProcessReadyEvent>());\n\treadonly onProcessReady = this._onProcessReady.event;\n\tprotected readonly _onDidChangeProperty = this._register(new Emitter<IProcessProperty<any>>());\n\treadonly onDidChangeProperty = this._onDidChangeProperty.event;\n\tprotected readonly _onProcessExit = this._register(new Emitter<number | undefined>());\n\treadonly onProcessExit = this._onProcessExit.event;\n\tprotected readonly _onRestoreCommands = this._register(new Emitter<ISerializedCommandDetectionCapability>());\n\treadonly onRestoreCommands = this._onRestoreCommands.event;\n\n\tconstructor(\n\t\treadonly id: number,\n\t\treadonly shouldPersist: boolean\n\t) {\n\t\tsuper();\n\t}\n\n\tasync getInitialCwd(): Promise<string> {\n\t\treturn this._properties.initialCwd;\n\t}\n\n\tasync getCwd(): Promise<string> {\n\t\treturn this._properties.cwd || this._properties.initialCwd;\n\t}\n\n\thandleData(e: string | IProcessDataEvent) {\n\t\tthis._onProcessData.fire(e);\n\t}\n\thandleExit(e: number | undefined) {\n\t\tthis._onProcessExit.fire(e);\n\t}\n\thandleReady(e: IProcessReadyEvent) {\n\t\tthis._onProcessReady.fire(e);\n\t}\n\thandleDidChangeProperty({ type, value }: IProcessProperty<any>) {\n\t\tswitch (type) {\n\t\t\tcase ProcessPropertyType.Cwd:\n\t\t\t\tthis._properties.cwd = value;\n\t\t\t\tbreak;\n\t\t\tcase ProcessPropertyType.InitialCwd:\n\t\t\t\tthis._properties.initialCwd = value;\n\t\t\t\tbreak;\n\t\t\tcase ProcessPropertyType.ResolvedShellLaunchConfig:\n\t\t\t\tif (value.cwd && typeof value.cwd !== 'string') {\n\t\t\t\t\tvalue.cwd = URI.revive(value.cwd);\n\t\t\t\t}\n\t\t}\n\t\tthis._onDidChangeProperty.fire({ type, value });\n\t}\n\tasync handleReplay(e: IPtyHostProcessReplayEvent) {\n\t\tmark(`code/terminal/willHandleReplay/${this.id}`);\n\t\ttry {\n\t\t\tthis._inReplay = true;\n\t\t\tfor (const innerEvent of e.events) {\n\t\t\t\tif (innerEvent.cols !== 0 || innerEvent.rows !== 0) {\n\t\t\t\t\t// never override with 0x0 as that is a marker for an unknown initial size\n\t\t\t\t\tthis._onDidChangeProperty.fire({ type: ProcessPropertyType.OverrideDimensions, value: { cols: innerEvent.cols, rows: innerEvent.rows, forceExactSize: true } });\n\t\t\t\t}\n\t\t\t\tconst e: IProcessDataEvent = { data: innerEvent.data, trackCommit: true };\n\t\t\t\tthis._onProcessData.fire(e);\n\t\t\t\tawait e.writePromise;\n\t\t\t}\n\t\t} finally {\n\t\t\tthis._inReplay = false;\n\t\t}\n\n\t\tif (e.commands) {\n\t\t\tthis._onRestoreCommands.fire(e.commands);\n\t\t}\n\n\t\t// remove size override\n\t\tthis._onDidChangeProperty.fire({ type: ProcessPropertyType.OverrideDimensions, value: undefined });\n\n\t\tmark(`code/terminal/didHandleReplay/${this.id}`);\n\t\tthis._onProcessReplayComplete.fire();\n\t}\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAiBoB;IAAAA,aAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,aAAA;AAjBpB;;;;AAKA,SAASE,OAAO,QAAQ,kCAAkC;AAC1D,SAASC,UAAU,QAAQ,sCAAsC;AACjE,SAASC,IAAI,QAAQ,wCAAwC;AAC7D,SAASC,GAAG,QAAQ,gCAAgC;AAIpD;;;;AAIA,OAAM,MAAgBC,OAAQ,SAAQH,UAAU;EA+BrCI,EAAA;EACAC,aAAA;EA/BSC,WAAW;EAAA;EAAA,CAAAT,aAAA,GAAAU,CAAA,OAAwB;IACrDC,GAAG,EAAE,EAAE;IACPC,UAAU,EAAE,EAAE;IACdC,eAAe,EAAE;MAAEC,IAAI,EAAEC,SAAS;MAAEC,IAAI,EAAED;IAAS,CAAE;IACrDE,KAAK,EAAE,EAAE;IACTC,SAAS,EAAEH,SAAS;IACpBI,iBAAiB,EAAE,IAAI;IACvBC,yBAAyB,EAAE,EAAE;IAC7BC,kBAAkB,EAAEN,SAAS;IAC7BO,gCAAgC,EAAE,KAAK;IACvCC,6BAA6B,EAAER,SAAS;IACxCS,sCAAsC,EAAET;GACxC;EACkBU,eAAe;EAAA;EAAA,CAAAzB,aAAA,GAAAU,CAAA,OAAmC;IAAEI,IAAI,EAAE,CAAC,CAAC;IAAEE,IAAI,EAAE,CAAC;EAAC,CAAE;EACjFU,SAAS;EAAA;EAAA,CAAA1B,aAAA,GAAAU,CAAA,OAAG,KAAK;EAERiB,cAAc;EAAA;EAAA,CAAA3B,aAAA,GAAAU,CAAA,OAAG,IAAI,CAACkB,SAAS,CAAC,IAAI1B,OAAO,EAA8B,CAAC;EACpF2B,aAAa;EAAA;EAAA,CAAA7B,aAAA,GAAAU,CAAA,OAAG,IAAI,CAACiB,cAAc,CAACG,KAAK;EAC/BC,wBAAwB;EAAA;EAAA,CAAA/B,aAAA,GAAAU,CAAA,OAAG,IAAI,CAACkB,SAAS,CAAC,IAAI1B,OAAO,EAAQ,CAAC;EACxE8B,uBAAuB;EAAA;EAAA,CAAAhC,aAAA,GAAAU,CAAA,OAAG,IAAI,CAACqB,wBAAwB,CAACD,KAAK;EACnDG,eAAe;EAAA;EAAA,CAAAjC,aAAA,GAAAU,CAAA,OAAG,IAAI,CAACkB,SAAS,CAAC,IAAI1B,OAAO,EAAsB,CAAC;EAC7EgC,cAAc;EAAA;EAAA,CAAAlC,aAAA,GAAAU,CAAA,OAAG,IAAI,CAACuB,eAAe,CAACH,KAAK;EACjCK,oBAAoB;EAAA;EAAA,CAAAnC,aAAA,GAAAU,CAAA,OAAG,IAAI,CAACkB,SAAS,CAAC,IAAI1B,OAAO,EAAyB,CAAC;EACrFkC,mBAAmB;EAAA;EAAA,CAAApC,aAAA,GAAAU,CAAA,QAAG,IAAI,CAACyB,oBAAoB,CAACL,KAAK;EAC3CO,cAAc;EAAA;EAAA,CAAArC,aAAA,GAAAU,CAAA,QAAG,IAAI,CAACkB,SAAS,CAAC,IAAI1B,OAAO,EAAsB,CAAC;EAC5EoC,aAAa;EAAA;EAAA,CAAAtC,aAAA,GAAAU,CAAA,QAAG,IAAI,CAAC2B,cAAc,CAACP,KAAK;EAC/BS,kBAAkB;EAAA;EAAA,CAAAvC,aAAA,GAAAU,CAAA,QAAG,IAAI,CAACkB,SAAS,CAAC,IAAI1B,OAAO,EAAyC,CAAC;EACnGsC,iBAAiB;EAAA;EAAA,CAAAxC,aAAA,GAAAU,CAAA,QAAG,IAAI,CAAC6B,kBAAkB,CAACT,KAAK;EAE1DW,YACUlC,EAAU,EACVC,aAAsB;IAAA;IAAAR,aAAA,GAAA0C,CAAA;IAAA1C,aAAA,GAAAU,CAAA;IAE/B,KAAK,EAAE;IAAC;IAAAV,aAAA,GAAAU,CAAA;IAHC,KAAAH,EAAE,GAAFA,EAAE;IAAQ;IAAAP,aAAA,GAAAU,CAAA;IACV,KAAAF,aAAa,GAAbA,aAAa;EAGvB;EAEA,MAAMmC,aAAaA,CAAA;IAAA;IAAA3C,aAAA,GAAA0C,CAAA;IAAA1C,aAAA,GAAAU,CAAA;IAClB,OAAO,IAAI,CAACD,WAAW,CAACG,UAAU;EACnC;EAEA,MAAMgC,MAAMA,CAAA;IAAA;IAAA5C,aAAA,GAAA0C,CAAA;IAAA1C,aAAA,GAAAU,CAAA;IACX,OAAO,2BAAAV,aAAA,GAAA6C,CAAA,cAAI,CAACpC,WAAW,CAACE,GAAG;IAAA;IAAA,CAAAX,aAAA,GAAA6C,CAAA,UAAI,IAAI,CAACpC,WAAW,CAACG,UAAU;EAC3D;EAEAkC,UAAUA,CAACC,CAA6B;IAAA;IAAA/C,aAAA,GAAA0C,CAAA;IAAA1C,aAAA,GAAAU,CAAA;IACvC,IAAI,CAACiB,cAAc,CAACqB,IAAI,CAACD,CAAC,CAAC;EAC5B;EACAE,UAAUA,CAACF,CAAqB;IAAA;IAAA/C,aAAA,GAAA0C,CAAA;IAAA1C,aAAA,GAAAU,CAAA;IAC/B,IAAI,CAAC2B,cAAc,CAACW,IAAI,CAACD,CAAC,CAAC;EAC5B;EACAG,WAAWA,CAACH,CAAqB;IAAA;IAAA/C,aAAA,GAAA0C,CAAA;IAAA1C,aAAA,GAAAU,CAAA;IAChC,IAAI,CAACuB,eAAe,CAACe,IAAI,CAACD,CAAC,CAAC;EAC7B;EACAI,uBAAuBA,CAAC;IAAEC,IAAI;IAAEC;EAAK,CAAyB;IAAA;IAAArD,aAAA,GAAA0C,CAAA;IAAA1C,aAAA,GAAAU,CAAA;IAC7D,QAAQ0C,IAAI;MACX;QAAA;QAAApD,aAAA,GAAA6C,CAAA;QAAA7C,aAAA,GAAAU,CAAA;QACC,IAAI,CAACD,WAAW,CAACE,GAAG,GAAG0C,KAAK;QAAC;QAAArD,aAAA,GAAAU,CAAA;QAC7B;MACD;QAAA;QAAAV,aAAA,GAAA6C,CAAA;QAAA7C,aAAA,GAAAU,CAAA;QACC,IAAI,CAACD,WAAW,CAACG,UAAU,GAAGyC,KAAK;QAAC;QAAArD,aAAA,GAAAU,CAAA;QACpC;MACD;QAAA;QAAAV,aAAA,GAAA6C,CAAA;QAAA7C,aAAA,GAAAU,CAAA;QACC;QAAI;QAAA,CAAAV,aAAA,GAAA6C,CAAA,UAAAQ,KAAK,CAAC1C,GAAG;QAAA;QAAA,CAAAX,aAAA,GAAA6C,CAAA,UAAI,OAAOQ,KAAK,CAAC1C,GAAG,KAAK,QAAQ,GAAE;UAAA;UAAAX,aAAA,GAAA6C,CAAA;UAAA7C,aAAA,GAAAU,CAAA;UAC/C2C,KAAK,CAAC1C,GAAG,GAAGN,GAAG,CAACiD,MAAM,CAACD,KAAK,CAAC1C,GAAG,CAAC;QAClC,CAAC;QAAA;QAAA;UAAAX,aAAA,GAAA6C,CAAA;QAAA;IACH;IAAC;IAAA7C,aAAA,GAAAU,CAAA;IACD,IAAI,CAACyB,oBAAoB,CAACa,IAAI,CAAC;MAAEI,IAAI;MAAEC;IAAK,CAAE,CAAC;EAChD;EACA,MAAME,YAAYA,CAACR,CAA6B;IAAA;IAAA/C,aAAA,GAAA0C,CAAA;IAAA1C,aAAA,GAAAU,CAAA;IAC/CN,IAAI,CAAC,kCAAkC,IAAI,CAACG,EAAE,EAAE,CAAC;IAAC;IAAAP,aAAA,GAAAU,CAAA;IAClD,IAAI;MAAA;MAAAV,aAAA,GAAAU,CAAA;MACH,IAAI,CAACgB,SAAS,GAAG,IAAI;MAAC;MAAA1B,aAAA,GAAAU,CAAA;MACtB,KAAK,MAAM8C,UAAU,IAAIT,CAAC,CAACU,MAAM,EAAE;QAAA;QAAAzD,aAAA,GAAAU,CAAA;QAClC;QAAI;QAAA,CAAAV,aAAA,GAAA6C,CAAA,UAAAW,UAAU,CAAC1C,IAAI,KAAK,CAAC;QAAA;QAAA,CAAAd,aAAA,GAAA6C,CAAA,UAAIW,UAAU,CAACxC,IAAI,KAAK,CAAC,GAAE;UAAA;UAAAhB,aAAA,GAAA6C,CAAA;UAAA7C,aAAA,GAAAU,CAAA;UACnD;UACA,IAAI,CAACyB,oBAAoB,CAACa,IAAI,CAAC;YAAEI,IAAI;YAA0CC,KAAK,EAAE;cAAEvC,IAAI,EAAE0C,UAAU,CAAC1C,IAAI;cAAEE,IAAI,EAAEwC,UAAU,CAACxC,IAAI;cAAE0C,cAAc,EAAE;YAAI;UAAE,CAAE,CAAC;QAChK,CAAC;QAAA;QAAA;UAAA1D,aAAA,GAAA6C,CAAA;QAAA;QACD,MAAME,CAAC;QAAA;QAAA,CAAA/C,aAAA,GAAAU,CAAA,QAAsB;UAAEiD,IAAI,EAAEH,UAAU,CAACG,IAAI;UAAEC,WAAW,EAAE;QAAI,CAAE;QAAC;QAAA5D,aAAA,GAAAU,CAAA;QAC1E,IAAI,CAACiB,cAAc,CAACqB,IAAI,CAACD,CAAC,CAAC;QAAC;QAAA/C,aAAA,GAAAU,CAAA;QAC5B,MAAMqC,CAAC,CAACc,YAAY;MACrB;IACD,CAAC,SAAS;MAAA;MAAA7D,aAAA,GAAAU,CAAA;MACT,IAAI,CAACgB,SAAS,GAAG,KAAK;IACvB;IAAC;IAAA1B,aAAA,GAAAU,CAAA;IAED,IAAIqC,CAAC,CAACe,QAAQ,EAAE;MAAA;MAAA9D,aAAA,GAAA6C,CAAA;MAAA7C,aAAA,GAAAU,CAAA;MACf,IAAI,CAAC6B,kBAAkB,CAACS,IAAI,CAACD,CAAC,CAACe,QAAQ,CAAC;IACzC,CAAC;IAAA;IAAA;MAAA9D,aAAA,GAAA6C,CAAA;IAAA;IAED;IAAA7C,aAAA,GAAAU,CAAA;IACA,IAAI,CAACyB,oBAAoB,CAACa,IAAI,CAAC;MAAEI,IAAI;MAA0CC,KAAK,EAAEtC;IAAS,CAAE,CAAC;IAAC;IAAAf,aAAA,GAAAU,CAAA;IAEnGN,IAAI,CAAC,iCAAiC,IAAI,CAACG,EAAE,EAAE,CAAC;IAAC;IAAAP,aAAA,GAAAU,CAAA;IACjD,IAAI,CAACqB,wBAAwB,CAACiB,IAAI,EAAE;EACrC","ignoreList":[]}