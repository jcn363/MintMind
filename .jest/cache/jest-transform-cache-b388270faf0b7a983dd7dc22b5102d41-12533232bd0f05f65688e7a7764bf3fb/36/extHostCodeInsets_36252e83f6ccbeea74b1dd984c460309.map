{"version":3,"names":["cov_2mnejzreqh","actualCoverage","Emitter","DisposableStore","asWebviewUri","webviewGenericCspSource","ExtHostEditorInsets","_proxy","_editors","_remoteInfo","_handlePool","s","_disposables","_insets","Map","constructor","f","add","onDidChangeVisibleTextEditors","visibleEditor","getVisibleTextEditors","value","values","indexOf","editor","b","inset","dispose","forEach","createWebviewEditorInset","line","height","options","extension","apiEditor","candidate","Error","that","handle","onDidReceiveMessage","onDidDispose","webview","_html","_options","Object","create","resource","cspSource","$setOptions","html","$setHtml","event","postMessage","message","$postMessage","has","delete","$disposeEditorInset","fire","$createEditorInset","id","document","uri","identifier","extensionLocation","set","$onDidDispose","get","$onDidReceiveMessage"],"sources":["/home/user/Desktop/MintMind/src/vs/workbench/api/common/extHostCodeInsets.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter } from '../../../base/common/event.js';\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\nimport { IExtensionDescription } from '../../../platform/extensions/common/extensions.js';\nimport { ExtHostTextEditor } from './extHostTextEditor.js';\nimport { ExtHostEditors } from './extHostTextEditors.js';\nimport { asWebviewUri, webviewGenericCspSource, WebviewRemoteInfo } from '../../contrib/webview/common/webview.js';\nimport type * as vscode from 'vscode';\nimport { ExtHostEditorInsetsShape, MainThreadEditorInsetsShape } from './extHost.protocol.js';\n\nexport class ExtHostEditorInsets implements ExtHostEditorInsetsShape {\n\n\tprivate _handlePool = 0;\n\tprivate readonly _disposables = new DisposableStore();\n\tprivate _insets = new Map<number, { editor: vscode.TextEditor; inset: vscode.WebviewEditorInset; onDidReceiveMessage: Emitter<any> }>();\n\n\tconstructor(\n\t\tprivate readonly _proxy: MainThreadEditorInsetsShape,\n\t\tprivate readonly _editors: ExtHostEditors,\n\t\tprivate readonly _remoteInfo: WebviewRemoteInfo\n\t) {\n\n\t\t// dispose editor inset whenever the hosting editor goes away\n\t\tthis._disposables.add(_editors.onDidChangeVisibleTextEditors(() => {\n\t\t\tconst visibleEditor = _editors.getVisibleTextEditors();\n\t\t\tfor (const value of this._insets.values()) {\n\t\t\t\tif (visibleEditor.indexOf(value.editor) < 0) {\n\t\t\t\t\tvalue.inset.dispose(); // will remove from `this._insets`\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\t}\n\n\tdispose(): void {\n\t\tthis._insets.forEach(value => value.inset.dispose());\n\t\tthis._disposables.dispose();\n\t}\n\n\tcreateWebviewEditorInset(editor: vscode.TextEditor, line: number, height: number, options: vscode.WebviewOptions | undefined, extension: IExtensionDescription): vscode.WebviewEditorInset {\n\n\t\tlet apiEditor: ExtHostTextEditor | undefined;\n\t\tfor (const candidate of this._editors.getVisibleTextEditors(true)) {\n\t\t\tif (candidate.value === editor) {\n\t\t\t\tapiEditor = <ExtHostTextEditor>candidate;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!apiEditor) {\n\t\t\tthrow new Error('not a visible editor');\n\t\t}\n\n\t\tconst that = this;\n\t\tconst handle = this._handlePool++;\n\t\tconst onDidReceiveMessage = new Emitter<any>();\n\t\tconst onDidDispose = new Emitter<void>();\n\n\t\tconst webview = new class implements vscode.Webview {\n\n\t\t\tprivate _html: string = '';\n\t\t\tprivate _options: vscode.WebviewOptions = Object.create(null);\n\n\t\t\tasWebviewUri(resource: vscode.Uri): vscode.Uri {\n\t\t\t\treturn asWebviewUri(resource, that._remoteInfo);\n\t\t\t}\n\n\t\t\tget cspSource(): string {\n\t\t\t\treturn webviewGenericCspSource;\n\t\t\t}\n\n\t\t\tset options(value: vscode.WebviewOptions) {\n\t\t\t\tthis._options = value;\n\t\t\t\tthat._proxy.$setOptions(handle, value);\n\t\t\t}\n\n\t\t\tget options(): vscode.WebviewOptions {\n\t\t\t\treturn this._options;\n\t\t\t}\n\n\t\t\tset html(value: string) {\n\t\t\t\tthis._html = value;\n\t\t\t\tthat._proxy.$setHtml(handle, value);\n\t\t\t}\n\n\t\t\tget html(): string {\n\t\t\t\treturn this._html;\n\t\t\t}\n\n\t\t\tget onDidReceiveMessage(): vscode.Event<any> {\n\t\t\t\treturn onDidReceiveMessage.event;\n\t\t\t}\n\n\t\t\tpostMessage(message: any): Thenable<boolean> {\n\t\t\t\treturn that._proxy.$postMessage(handle, message);\n\t\t\t}\n\t\t};\n\n\t\tconst inset = new class implements vscode.WebviewEditorInset {\n\n\t\t\treadonly editor: vscode.TextEditor = editor;\n\t\t\treadonly line: number = line;\n\t\t\treadonly height: number = height;\n\t\t\treadonly webview: vscode.Webview = webview;\n\t\t\treadonly onDidDispose: vscode.Event<void> = onDidDispose.event;\n\n\t\t\tdispose(): void {\n\t\t\t\tif (that._insets.has(handle)) {\n\t\t\t\t\tthat._insets.delete(handle);\n\t\t\t\t\tthat._proxy.$disposeEditorInset(handle);\n\t\t\t\t\tonDidDispose.fire();\n\n\t\t\t\t\t// final cleanup\n\t\t\t\t\tonDidDispose.dispose();\n\t\t\t\t\tonDidReceiveMessage.dispose();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tthis._proxy.$createEditorInset(handle, apiEditor.id, apiEditor.value.document.uri, line + 1, height, options || {}, extension.identifier, extension.extensionLocation);\n\t\tthis._insets.set(handle, { editor, inset, onDidReceiveMessage });\n\n\t\treturn inset;\n\t}\n\n\t$onDidDispose(handle: number): void {\n\t\tconst value = this._insets.get(handle);\n\t\tif (value) {\n\t\t\tvalue.inset.dispose();\n\t\t}\n\t}\n\n\t$onDidReceiveMessage(handle: number, message: any): void {\n\t\tconst value = this._insets.get(handle);\n\t\tvalue?.onDidReceiveMessage.fire(message);\n\t}\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}