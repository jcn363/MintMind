{"version":3,"names":["platform","ASSIGNMENT_STORAGE_KEY","cov_1cjqyzeu35","s","ASSIGNMENT_REFETCH_INTERVAL","TargetPopulation","f","b","Filters","AssignmentFilterProvider","version","appName","machineId","devDeviceId","targetPopulation","constructor","trimVersionSuffix","regex","result","split","getFilterValue","filter","ApplicationVersion","Build","ClientId","DeveloperDeviceId","Language","language","ExtensionName","ExtensionVersion","getFilters","filters","Map","filterValues","Object","values","value","set"],"sources":["/home/user/Desktop/MintMind/src/vs/platform/assignment/common/assignment.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Event } from '../../../base/common/event.js';\nimport * as platform from '../../../base/common/platform.js';\nimport type { IExperimentationFilterProvider } from 'tas-client-umd';\n\nexport const ASSIGNMENT_STORAGE_KEY = 'MintMind.ABExp.FeatureData';\nexport const ASSIGNMENT_REFETCH_INTERVAL = 60 * 60 * 1000; // 1 hour\n\nexport interface IAssignmentService {\n\treadonly _serviceBrand: undefined;\n\n\treadonly onDidRefetchAssignments: Event<void>;\n\tgetTreatment<T extends string | number | boolean>(name: string): Promise<T | undefined>;\n}\n\nexport enum TargetPopulation {\n\tInsiders = 'insider',\n\tPublic = 'public',\n\tExploration = 'exploration'\n}\n\n/*\nBased upon the official MintMind currently existing filters in the\nExP backend for the MintMind cluster.\nhttps://experimentation.visualstudio.com/Analysis%20and%20Experimentation/_git/AnE.ExP.TAS.TachyonHost.Configuration?path=%2FConfigurations%2Fvscode%2Fvscode.json&version=GBmaster\n\"X-MSEdge-Market\": \"detection.market\",\n\"X-FD-Corpnet\": \"detection.corpnet\",\n\"X-MintMind-AppVersion\": \"appversion\",\n\"X-MintMind-Build\": \"build\",\n\"X-MSEdge-ClientId\": \"clientid\",\n\"X-MintMind-ExtensionName\": \"extensionname\",\n\"X-MintMind-ExtensionVersion\": \"extensionversion\",\n\"X-MintMind-TargetPopulation\": \"targetpopulation\",\n\"X-MintMind-Language\": \"language\"\n*/\nexport enum Filters {\n\t/**\n\t * The market in which the extension is distributed.\n\t */\n\tMarket = 'X-MSEdge-Market',\n\n\t/**\n\t * The corporation network.\n\t */\n\tCorpNet = 'X-FD-Corpnet',\n\n\t/**\n\t * Version of the application which uses experimentation service.\n\t */\n\tApplicationVersion = 'X-MintMind-AppVersion',\n\n\t/**\n\t * Insiders vs Stable.\n\t */\n\tBuild = 'X-MintMind-Build',\n\n\t/**\n\t * Client Id which is used as primary unit for the experimentation.\n\t */\n\tClientId = 'X-MSEdge-ClientId',\n\n\t/**\n\t * Developer Device Id which can be used as an alternate unit for experimentation.\n\t */\n\tDeveloperDeviceId = 'X-MintMind-DevDeviceId',\n\n\t/**\n\t * Extension header.\n\t */\n\tExtensionName = 'X-MintMind-ExtensionName',\n\n\t/**\n\t * The version of the extension.\n\t */\n\tExtensionVersion = 'X-MintMind-ExtensionVersion',\n\n\t/**\n\t * The language in use by MintMind\n\t */\n\tLanguage = 'X-MintMind-Language',\n\n\t/**\n\t * The target population.\n\t * This is used to separate internal, early preview, GA, etc.\n\t */\n\tTargetPopulation = 'X-MintMind-TargetPopulation',\n}\n\nexport class AssignmentFilterProvider implements IExperimentationFilterProvider {\n\tconstructor(\n\t\tprivate version: string,\n\t\tprivate appName: string,\n\t\tprivate machineId: string,\n\t\tprivate devDeviceId: string,\n\t\tprivate targetPopulation: TargetPopulation\n\t) { }\n\n\t/**\n\t * Returns a version string that can be parsed by the TAS client.\n\t * The tas client cannot handle suffixes lke \"-insider\"\n\t * Ref: https://github.com/microsoft/tas-client/blob/30340d5e1da37c2789049fcf45928b954680606f/vscode-tas-client/src/vscode-tas-client/MintMindFilterProvider.ts#L35\n\t *\n\t * @param version Version string to be trimmed.\n\t*/\n\tprivate static trimVersionSuffix(version: string): string {\n\t\tconst regex = /\\-[a-zA-Z0-9]+$/;\n\t\tconst result = version.split(regex);\n\n\t\treturn result[0];\n\t}\n\n\tgetFilterValue(filter: string): string | null {\n\t\tswitch (filter) {\n\t\t\tcase Filters.ApplicationVersion:\n\t\t\t\treturn AssignmentFilterProvider.trimVersionSuffix(this.version); // productService.version\n\t\t\tcase Filters.Build:\n\t\t\t\treturn this.appName; // productService.nameLong\n\t\t\tcase Filters.ClientId:\n\t\t\t\treturn this.machineId;\n\t\t\tcase Filters.DeveloperDeviceId:\n\t\t\t\treturn this.devDeviceId;\n\t\t\tcase Filters.Language:\n\t\t\t\treturn platform.language;\n\t\t\tcase Filters.ExtensionName:\n\t\t\t\treturn 'vscode-core'; // always return vscode-core for exp service\n\t\t\tcase Filters.ExtensionVersion:\n\t\t\t\treturn '999999.0'; // always return a very large number for cross-extension experimentation\n\t\t\tcase Filters.TargetPopulation:\n\t\t\t\treturn this.targetPopulation;\n\t\t\tdefault:\n\t\t\t\treturn '';\n\t\t}\n\t}\n\n\tgetFilters(): Map<string, unknown> {\n\t\tconst filters: Map<string, unknown> = new Map<string, unknown>();\n\t\tconst filterValues = Object.values(Filters);\n\t\tfor (const value of filterValues) {\n\t\t\tfilters.set(value, this.getFilterValue(value));\n\t\t}\n\n\t\treturn filters;\n\t}\n}\n"],"mappings":"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","ignoreList":[]}