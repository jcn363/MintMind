{"version":3,"names":["cov_184hd2hku","actualCoverage","DefaultURITransformer","ProxyChannel","Server","ChildProcessServer","UtilityProcessServer","localize","OPTIONS","parseArgs","NativeEnvironmentService","getLogLevel","LoggerChannel","LogService","LoggerService","product","TerminalIpcChannels","HeartbeatService","PtyService","isUtilityProcess","timeout","DisposableStore","s","startPtyHost","f","startupDelay","parseInt","b","process","env","MINTMIND_STARTUP_DELAY","simulatedLatency","MINTMIND_LATENCY","reconnectConstants","graceTime","MINTMIND_RECONNECT_GRACE_TIME","shortGraceTime","MINTMIND_RECONNECT_SHORT_GRACE_TIME","scrollback","MINTMIND_RECONNECT_SCROLLBACK","_isUtilityProcess","server","PtyHost","productService","_serviceBrand","undefined","environmentService","argv","loggerService","logsHome","registerChannel","Logger","logger","createLogger","name","logService","warn","disposables","heartbeatService","Heartbeat","fromService","ptyService","ptyServiceChannel","PtyHostWindow","once","trace","dispose"],"sources":["/home/user/Desktop/MintMind/src/vs/platform/terminal/node/ptyHostMain.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { DefaultURITransformer } from '../../../base/common/uriIpc.js';\nimport { ProxyChannel } from '../../../base/parts/ipc/common/ipc.js';\nimport { Server as ChildProcessServer } from '../../../base/parts/ipc/node/ipc.cp.js';\nimport { Server as UtilityProcessServer } from '../../../base/parts/ipc/node/ipc.mp.js';\nimport { localize } from '../../../nls.js';\nimport { OPTIONS, parseArgs } from '../../environment/node/argv.js';\nimport { NativeEnvironmentService } from '../../environment/node/environmentService.js';\nimport { getLogLevel } from '../../log/common/log.js';\nimport { LoggerChannel } from '../../log/common/logIpc.js';\nimport { LogService } from '../../log/common/logService.js';\nimport { LoggerService } from '../../log/node/loggerService.js';\nimport product from '../../product/common/product.js';\nimport { IProductService } from '../../product/common/productService.js';\nimport { IReconnectConstants, TerminalIpcChannels } from '../common/terminal.js';\nimport { HeartbeatService } from './heartbeatService.js';\nimport { PtyService } from './ptyService.js';\nimport { isUtilityProcess } from '../../../base/parts/sandbox/node/electronTypes.js';\nimport { timeout } from '../../../base/common/async.js';\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\n\nstartPtyHost();\n\nasync function startPtyHost() {\n\t// Parse environment variables\n\tconst startupDelay = parseInt(process.env.MINTMIND_STARTUP_DELAY ?? '0');\n\tconst simulatedLatency = parseInt(process.env.MINTMIND_LATENCY ?? '0');\n\tconst reconnectConstants: IReconnectConstants = {\n\t\tgraceTime: parseInt(process.env.MINTMIND_RECONNECT_GRACE_TIME || '0'),\n\t\tshortGraceTime: parseInt(process.env.MINTMIND_RECONNECT_SHORT_GRACE_TIME || '0'),\n\t\tscrollback: parseInt(process.env.MINTMIND_RECONNECT_SCROLLBACK || '100')\n\t};\n\n\t// Sanitize environment\n\tdelete process.env.MINTMIND_RECONNECT_GRACE_TIME;\n\tdelete process.env.MINTMIND_RECONNECT_SHORT_GRACE_TIME;\n\tdelete process.env.MINTMIND_RECONNECT_SCROLLBACK;\n\tdelete process.env.MINTMIND_LATENCY;\n\tdelete process.env.MINTMIND_STARTUP_DELAY;\n\n\t// Delay startup if needed, this must occur before RPC is setup to avoid the channel from timing\n\t// out.\n\tif (startupDelay) {\n\t\tawait timeout(startupDelay);\n\t}\n\n\t// Setup RPC\n\tconst _isUtilityProcess = isUtilityProcess(process);\n\tlet server: ChildProcessServer<string> | UtilityProcessServer;\n\tif (_isUtilityProcess) {\n\t\tserver = new UtilityProcessServer();\n\t} else {\n\t\tserver = new ChildProcessServer(TerminalIpcChannels.PtyHost);\n\t}\n\n\t// Services\n\tconst productService: IProductService = { _serviceBrand: undefined, ...product };\n\tconst environmentService = new NativeEnvironmentService(parseArgs(process.argv, OPTIONS), productService);\n\tconst loggerService = new LoggerService(getLogLevel(environmentService), environmentService.logsHome);\n\tserver.registerChannel(TerminalIpcChannels.Logger, new LoggerChannel(loggerService, () => DefaultURITransformer));\n\tconst logger = loggerService.createLogger('ptyhost', { name: localize('ptyHost', \"Pty Host\") });\n\tconst logService = new LogService(logger);\n\n\t// Log developer config\n\tif (startupDelay) {\n\t\tlogService.warn(`Pty Host startup is delayed ${startupDelay}ms`);\n\t}\n\tif (simulatedLatency) {\n\t\tlogService.warn(`Pty host is simulating ${simulatedLatency}ms latency`);\n\t}\n\n\tconst disposables = new DisposableStore();\n\n\t// Heartbeat responsiveness tracking\n\tconst heartbeatService = new HeartbeatService();\n\tserver.registerChannel(TerminalIpcChannels.Heartbeat, ProxyChannel.fromService(heartbeatService, disposables));\n\n\t// Init pty service\n\tconst ptyService = new PtyService(logService, productService, reconnectConstants, simulatedLatency);\n\tconst ptyServiceChannel = ProxyChannel.fromService(ptyService, disposables);\n\tserver.registerChannel(TerminalIpcChannels.PtyHost, ptyServiceChannel);\n\n\t// Register a channel for direct communication via Message Port\n\tif (_isUtilityProcess) {\n\t\tserver.registerChannel(TerminalIpcChannels.PtyHostWindow, ptyServiceChannel);\n\t}\n\n\t// Clean up\n\tprocess.once('exit', () => {\n\t\tlogService.trace('Pty host exiting');\n\t\tlogService.dispose();\n\t\theartbeatService.dispose();\n\t\tptyService.dispose();\n\t});\n}\n"],"mappings":"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","ignoreList":[]}