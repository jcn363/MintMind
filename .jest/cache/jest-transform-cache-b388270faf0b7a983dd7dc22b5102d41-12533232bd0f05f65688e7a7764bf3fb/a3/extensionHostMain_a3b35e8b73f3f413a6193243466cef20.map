{"version":3,"names":["cov_1qvlhw9ge4","actualCoverage","errors","performance","URI","MainContext","RPCProtocol","ExtensionError","ILogService","getSingletonServiceDescriptors","ServiceCollection","IExtHostInitDataService","InstantiationService","IExtHostRpcService","ExtHostRpcService","IURITransformerService","URITransformerService","IExtHostExtensionService","IHostUtils","IExtHostTelemetry","IExtHostApiDeprecationService","ErrorHandler","installEarlyHandler","accessor","f","s","Error","stackTraceLimit","logService","get","rpcService","mainThreadErrors","getProxy","MainThreadErrors","setUnexpectedErrorHandler","err","error","data","transformErrorForSerialization","$onUnexpectedError","installFullHandler","extensionService","extensionTelemetry","apiDeprecationService","mainThreadExtensions","MainThreadExtensionService","extensionsRegistry","getExtensionRegistry","extensionsMap","getExtensionPathIndex","extensionErrors","WeakMap","prepareStackTraceAndFindExtension","stackTrace","has","b","stack","stackTraceMessage","extension","fileName","call","toString","getFileName","findSubstr","file","result","name","message","set","extensionIdentifier","identifier","_wasWrapped","Symbol","_prepareStackTrace","Object","defineProperty","configurable","v","assign","PendingMigrationError","is","errorData","stackData","extensionDesc","getExtensionDescription","report","$onExtensionRuntimeError","reported","onExtensionError","trace","errorHandler","addListener","ExtensionHostMain","_hostUtils","_rpcProtocol","_extensionService","_logService","constructor","protocol","initData","hostUtils","uriTransformer","messagePorts","_transform","services","_serviceBrand","undefined","instaService","invokeFunction","mark","pid","info","initialize","asBrowserUri","uri","mainThreadExtensionsProxy","revive","$asBrowserUri","terminate","reason","rpcProtocol","extensions","allExtensions","forEach","ext","extensionLocation","transformIncomingURIs","environment","appRoot","extDevLocs","extensionDevelopmentLocationURI","map","url","extensionTestsLocationURI","globalStorageHome","workspaceStorageHome","nlsBaseUrl","logsLocation","workspace"],"sources":["/home/user/Desktop/MintMind/src/vs/workbench/api/common/extensionHostMain.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as errors from '../../../base/common/errors.js';\nimport * as performance from '../../../base/common/performance.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { IURITransformer } from '../../../base/common/uriIpc.js';\nimport { IMessagePassingProtocol } from '../../../base/parts/ipc/common/ipc.js';\nimport { MainContext, MainThreadConsoleShape } from './extHost.protocol.js';\nimport { IExtensionHostInitData } from '../../services/extensions/common/extensionHostProtocol.js';\nimport { RPCProtocol } from '../../services/extensions/common/rpcProtocol.js';\nimport { ExtensionError, ExtensionIdentifier, IExtensionDescription } from '../../../platform/extensions/common/extensions.js';\nimport { ILogService } from '../../../platform/log/common/log.js';\nimport { getSingletonServiceDescriptors } from '../../../platform/instantiation/common/extensions.js';\nimport { ServiceCollection } from '../../../platform/instantiation/common/serviceCollection.js';\nimport { IExtHostInitDataService } from './extHostInitDataService.js';\nimport { InstantiationService } from '../../../platform/instantiation/common/instantiationService.js';\nimport { IInstantiationService, ServicesAccessor } from '../../../platform/instantiation/common/instantiation.js';\nimport { IExtHostRpcService, ExtHostRpcService } from './extHostRpcService.js';\nimport { IURITransformerService, URITransformerService } from './extHostUriTransformerService.js';\nimport { IExtHostExtensionService, IHostUtils } from './extHostExtensionService.js';\nimport { IExtHostTelemetry } from './extHostTelemetry.js';\nimport { Mutable } from '../../../base/common/types.js';\nimport { IExtHostApiDeprecationService } from './extHostApiDeprecationService.js';\n\nexport interface IExitFn {\n\t(code?: number): any;\n}\n\nexport interface IConsolePatchFn {\n\t(mainThreadConsole: MainThreadConsoleShape): any;\n}\n\nexport abstract class ErrorHandler {\n\n\tstatic async installEarlyHandler(accessor: ServicesAccessor): Promise<void> {\n\n\t\t// increase number of stack frames (from 10, https://github.com/v8/v8/wiki/Stack-Trace-API)\n\t\tError.stackTraceLimit = 100;\n\n\t\t// does NOT dependent of extension information, can be installed immediately, and simply forwards\n\t\t// to the log service and main thread errors\n\t\tconst logService = accessor.get(ILogService);\n\t\tconst rpcService = accessor.get(IExtHostRpcService);\n\t\tconst mainThreadErrors = rpcService.getProxy(MainContext.MainThreadErrors);\n\n\t\terrors.setUnexpectedErrorHandler(err => {\n\t\t\tlogService.error(err);\n\t\t\tconst data = errors.transformErrorForSerialization(err);\n\t\t\tmainThreadErrors.$onUnexpectedError(data);\n\t\t});\n\t}\n\n\tstatic async installFullHandler(accessor: ServicesAccessor): Promise<void> {\n\t\t// uses extension knowledges to correlate errors with extensions\n\n\t\tconst logService = accessor.get(ILogService);\n\t\tconst rpcService = accessor.get(IExtHostRpcService);\n\t\tconst extensionService = accessor.get(IExtHostExtensionService);\n\t\tconst extensionTelemetry = accessor.get(IExtHostTelemetry);\n\t\tconst apiDeprecationService = accessor.get(IExtHostApiDeprecationService);\n\n\t\tconst mainThreadExtensions = rpcService.getProxy(MainContext.MainThreadExtensionService);\n\t\tconst mainThreadErrors = rpcService.getProxy(MainContext.MainThreadErrors);\n\n\t\tconst extensionsRegistry = await extensionService.getExtensionRegistry();\n\t\tconst extensionsMap = await extensionService.getExtensionPathIndex();\n\t\tconst extensionErrors = new WeakMap<Error, { extensionIdentifier: ExtensionIdentifier | undefined; stack: string }>();\n\n\t\t// PART 1\n\t\t// set the prepareStackTrace-handle and use it as a side-effect to associate errors\n\t\t// with extensions - this works by looking up callsites in the extension path index\n\t\tfunction prepareStackTraceAndFindExtension(error: Error, stackTrace: errors.V8CallSite[]) {\n\t\t\tif (extensionErrors.has(error)) {\n\t\t\t\treturn extensionErrors.get(error)!.stack;\n\t\t\t}\n\t\t\tlet stackTraceMessage = '';\n\t\t\tlet extension: IExtensionDescription | undefined;\n\t\t\tlet fileName: string | null;\n\t\t\tfor (const call of stackTrace) {\n\t\t\t\tstackTraceMessage += `\\n\\tat ${call.toString()}`;\n\t\t\t\tfileName = call.getFileName();\n\t\t\t\tif (!extension && fileName) {\n\t\t\t\t\textension = extensionsMap.findSubstr(URI.file(fileName));\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst result = `${error.name || 'Error'}: ${error.message || ''}${stackTraceMessage}`;\n\t\t\textensionErrors.set(error, { extensionIdentifier: extension?.identifier, stack: result });\n\t\t\treturn result;\n\t\t}\n\n\t\tconst _wasWrapped = Symbol('prepareStackTrace wrapped');\n\t\tlet _prepareStackTrace = prepareStackTraceAndFindExtension;\n\n\t\tObject.defineProperty(Error, 'prepareStackTrace', {\n\t\t\tconfigurable: false,\n\t\t\tget() {\n\t\t\t\treturn _prepareStackTrace;\n\t\t\t},\n\t\t\tset(v) {\n\t\t\t\tif (v === prepareStackTraceAndFindExtension || !v || v[_wasWrapped]) {\n\t\t\t\t\t_prepareStackTrace = v || prepareStackTraceAndFindExtension;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t_prepareStackTrace = function (error, stackTrace) {\n\t\t\t\t\tprepareStackTraceAndFindExtension(error, stackTrace);\n\t\t\t\t\treturn v.call(Error, error, stackTrace);\n\t\t\t\t};\n\n\t\t\t\tObject.assign(_prepareStackTrace, { [_wasWrapped]: true });\n\t\t\t},\n\t\t});\n\n\t\t// PART 2\n\t\t// set the unexpectedErrorHandler and check for extensions that have been identified as\n\t\t// having caused the error. Note that the runtime order is actually reversed, the code\n\t\t// below accesses the stack-property which triggers the code above\n\t\terrors.setUnexpectedErrorHandler(err => {\n\n\t\t\tif (!errors.PendingMigrationError.is(err)) {\n\t\t\t\tlogService.error(err);\n\t\t\t}\n\n\t\t\tconst errorData = errors.transformErrorForSerialization(err);\n\n\t\t\tlet extension: ExtensionIdentifier | undefined;\n\t\t\tif (err instanceof ExtensionError) {\n\t\t\t\textension = err.extension;\n\t\t\t} else {\n\t\t\t\tconst stackData = extensionErrors.get(err);\n\t\t\t\textension = stackData?.extensionIdentifier;\n\t\t\t}\n\n\t\t\tif (!extension) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (errors.PendingMigrationError.is(err)) {\n\t\t\t\t// report pending migration via the API deprecation service which (1) informs the extensions author during\n\t\t\t\t// dev-time and (2) collects telemetry so that we can reach out too\n\t\t\t\tconst extensionDesc = extensionsRegistry.getExtensionDescription(extension);\n\t\t\t\tif (extensionDesc) {\n\t\t\t\t\tapiDeprecationService.report(err.name, extensionDesc, `${err.message}\\n FROM: ${err.stack}`);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tmainThreadExtensions.$onExtensionRuntimeError(extension, errorData);\n\t\t\t\tconst reported = extensionTelemetry.onExtensionError(extension, err);\n\t\t\t\tlogService.trace('forwarded error to extension?', reported, extension);\n\t\t\t}\n\t\t});\n\n\t\terrors.errorHandler.addListener(err => {\n\t\t\tmainThreadErrors.$onUnexpectedError(err);\n\t\t});\n\t}\n}\n\nexport class ExtensionHostMain {\n\n\tprivate readonly _hostUtils: IHostUtils;\n\tprivate readonly _rpcProtocol: RPCProtocol;\n\tprivate readonly _extensionService: IExtHostExtensionService;\n\tprivate readonly _logService: ILogService;\n\n\tconstructor(\n\t\tprotocol: IMessagePassingProtocol,\n\t\tinitData: IExtensionHostInitData,\n\t\thostUtils: IHostUtils,\n\t\turiTransformer: IURITransformer | null,\n\t\tmessagePorts?: ReadonlyMap<string, MessagePort>\n\t) {\n\t\tthis._hostUtils = hostUtils;\n\t\tthis._rpcProtocol = new RPCProtocol(protocol, null, uriTransformer);\n\n\t\t// ensure URIs are transformed and revived\n\t\tinitData = ExtensionHostMain._transform(initData, this._rpcProtocol);\n\n\t\t// bootstrap services\n\t\tconst services = new ServiceCollection(...getSingletonServiceDescriptors());\n\t\tservices.set(IExtHostInitDataService, { _serviceBrand: undefined, ...initData, messagePorts });\n\t\tservices.set(IExtHostRpcService, new ExtHostRpcService(this._rpcProtocol));\n\t\tservices.set(IURITransformerService, new URITransformerService(uriTransformer));\n\t\tservices.set(IHostUtils, hostUtils);\n\n\t\tconst instaService: IInstantiationService = new InstantiationService(services, true);\n\n\t\tinstaService.invokeFunction(ErrorHandler.installEarlyHandler);\n\n\t\t// ugly self - inject\n\t\tthis._logService = instaService.invokeFunction(accessor => accessor.get(ILogService));\n\n\t\tperformance.mark(`code/extHost/didCreateServices`);\n\t\tif (this._hostUtils.pid) {\n\t\t\tthis._logService.info(`Extension host with pid ${this._hostUtils.pid} started`);\n\t\t} else {\n\t\t\tthis._logService.info(`Extension host started`);\n\t\t}\n\t\tthis._logService.trace('initData', initData);\n\n\t\t// ugly self - inject\n\t\t// must call initialize *after* creating the extension service\n\t\t// because `initialize` itself creates instances that depend on it\n\t\tthis._extensionService = instaService.invokeFunction(accessor => accessor.get(IExtHostExtensionService));\n\t\tthis._extensionService.initialize();\n\n\t\t// install error handler that is extension-aware\n\t\tinstaService.invokeFunction(ErrorHandler.installFullHandler);\n\t}\n\n\tasync asBrowserUri(uri: URI): Promise<URI> {\n\t\tconst mainThreadExtensionsProxy = this._rpcProtocol.getProxy(MainContext.MainThreadExtensionService);\n\t\treturn URI.revive(await mainThreadExtensionsProxy.$asBrowserUri(uri));\n\t}\n\n\tterminate(reason: string): void {\n\t\tthis._extensionService.terminate(reason);\n\t}\n\n\tprivate static _transform(initData: IExtensionHostInitData, rpcProtocol: RPCProtocol): IExtensionHostInitData {\n\t\tinitData.extensions.allExtensions.forEach((ext) => {\n\t\t\t(<Mutable<IExtensionDescription>>ext).extensionLocation = URI.revive(rpcProtocol.transformIncomingURIs(ext.extensionLocation));\n\t\t});\n\t\tinitData.environment.appRoot = URI.revive(rpcProtocol.transformIncomingURIs(initData.environment.appRoot));\n\t\tconst extDevLocs = initData.environment.extensionDevelopmentLocationURI;\n\t\tif (extDevLocs) {\n\t\t\tinitData.environment.extensionDevelopmentLocationURI = extDevLocs.map(url => URI.revive(rpcProtocol.transformIncomingURIs(url)));\n\t\t}\n\t\tinitData.environment.extensionTestsLocationURI = URI.revive(rpcProtocol.transformIncomingURIs(initData.environment.extensionTestsLocationURI));\n\t\tinitData.environment.globalStorageHome = URI.revive(rpcProtocol.transformIncomingURIs(initData.environment.globalStorageHome));\n\t\tinitData.environment.workspaceStorageHome = URI.revive(rpcProtocol.transformIncomingURIs(initData.environment.workspaceStorageHome));\n\t\tinitData.nlsBaseUrl = URI.revive(rpcProtocol.transformIncomingURIs(initData.nlsBaseUrl));\n\t\tinitData.logsLocation = URI.revive(rpcProtocol.transformIncomingURIs(initData.logsLocation));\n\t\tinitData.workspace = rpcProtocol.transformIncomingURIs(initData.workspace);\n\t\treturn initData;\n\t}\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}