{"version":3,"names":["cov_2gjum6ztc6","actualCoverage","Emitter","Disposable","StopWatch","TokenMetadata","EncodedTokenizationResult","TextMateTokenizationSupport","_grammar","_initialState","_containsEmbeddedLanguages","_createBackgroundTokenizer","_backgroundTokenizerShouldOnlyVerifyTokens","_reportTokenizationTime","_reportSlowTokenization","_seenLanguages","s","_onDidEncounterLanguage","_register","onDidEncounterLanguage","f","event","constructor","backgroundTokenizerShouldOnlyVerifyTokens","getInitialState","tokenize","line","hasEOL","state","Error","createBackgroundTokenizer","textModel","store","b","undefined","tokenizeEncoded","isRandomSample","Math","random","shouldMeasure","sw","textMateResult","tokenizeLine2","timeMS","elapsed","length","stoppedEarly","console","warn","substring","tokens","seenLanguages","i","len","metadata","languageId","getLanguageId","fire","endState","equals","ruleStack"],"sources":["/home/user/Desktop/MintMind/src/vs/workbench/services/textMate/browser/tokenizationSupport/textMateTokenizationSupport.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter, Event } from '../../../../../base/common/event.js';\nimport { Disposable } from '../../../../../base/common/lifecycle.js';\nimport { StopWatch } from '../../../../../base/common/stopwatch.js';\nimport { LanguageId, TokenMetadata } from '../../../../../editor/common/encodedTokenAttributes.js';\nimport { EncodedTokenizationResult, IBackgroundTokenizationStore, IBackgroundTokenizer, IState, ITokenizationSupport, TokenizationResult } from '../../../../../editor/common/languages.js';\nimport { ITextModel } from '../../../../../editor/common/model.js';\nimport type { IGrammar, StateStack } from 'vscode-textmate';\n\nexport class TextMateTokenizationSupport extends Disposable implements ITokenizationSupport {\n\tprivate readonly _seenLanguages: boolean[] = [];\n\tprivate readonly _onDidEncounterLanguage: Emitter<LanguageId> = this._register(new Emitter<LanguageId>());\n\tpublic get onDidEncounterLanguage(): Event<LanguageId> { return this._onDidEncounterLanguage.event; }\n\n\tconstructor(\n\t\tprivate readonly _grammar: IGrammar,\n\t\tprivate readonly _initialState: StateStack,\n\t\tprivate readonly _containsEmbeddedLanguages: boolean,\n\t\tprivate readonly _createBackgroundTokenizer: ((textModel: ITextModel, tokenStore: IBackgroundTokenizationStore) => IBackgroundTokenizer | undefined) | undefined,\n\t\tprivate readonly _backgroundTokenizerShouldOnlyVerifyTokens: () => boolean,\n\t\tprivate readonly _reportTokenizationTime: (timeMs: number, lineLength: number, isRandomSample: boolean) => void,\n\t\tprivate readonly _reportSlowTokenization: boolean,\n\t) {\n\t\tsuper();\n\t}\n\n\tpublic get backgroundTokenizerShouldOnlyVerifyTokens(): boolean | undefined {\n\t\treturn this._backgroundTokenizerShouldOnlyVerifyTokens();\n\t}\n\n\tpublic getInitialState(): IState {\n\t\treturn this._initialState;\n\t}\n\n\tpublic tokenize(line: string, hasEOL: boolean, state: IState): TokenizationResult {\n\t\tthrow new Error('Not supported!');\n\t}\n\n\tpublic createBackgroundTokenizer(textModel: ITextModel, store: IBackgroundTokenizationStore): IBackgroundTokenizer | undefined {\n\t\tif (this._createBackgroundTokenizer) {\n\t\t\treturn this._createBackgroundTokenizer(textModel, store);\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tpublic tokenizeEncoded(line: string, hasEOL: boolean, state: StateStack): EncodedTokenizationResult {\n\t\tconst isRandomSample = Math.random() * 10_000 < 1;\n\t\tconst shouldMeasure = this._reportSlowTokenization || isRandomSample;\n\t\tconst sw = shouldMeasure ? new StopWatch(true) : undefined;\n\t\tconst textMateResult = this._grammar.tokenizeLine2(line, state, 500);\n\t\tif (shouldMeasure) {\n\t\t\tconst timeMS = sw!.elapsed();\n\t\t\tif (isRandomSample || timeMS > 32) {\n\t\t\t\tthis._reportTokenizationTime(timeMS, line.length, isRandomSample);\n\t\t\t}\n\t\t}\n\n\t\tif (textMateResult.stoppedEarly) {\n\t\t\tconsole.warn(`Time limit reached when tokenizing line: ${line.substring(0, 100)}`);\n\t\t\t// return the state at the beginning of the line\n\t\t\treturn new EncodedTokenizationResult(textMateResult.tokens, state);\n\t\t}\n\n\t\tif (this._containsEmbeddedLanguages) {\n\t\t\tconst seenLanguages = this._seenLanguages;\n\t\t\tconst tokens = textMateResult.tokens;\n\n\t\t\t// Must check if any of the embedded languages was hit\n\t\t\tfor (let i = 0, len = (tokens.length >>> 1); i < len; i++) {\n\t\t\t\tconst metadata = tokens[(i << 1) + 1];\n\t\t\t\tconst languageId = TokenMetadata.getLanguageId(metadata);\n\n\t\t\t\tif (!seenLanguages[languageId]) {\n\t\t\t\t\tseenLanguages[languageId] = true;\n\t\t\t\t\tthis._onDidEncounterLanguage.fire(languageId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tlet endState: StateStack;\n\t\t// try to save an object if possible\n\t\tif (state.equals(textMateResult.ruleStack)) {\n\t\t\tendState = state;\n\t\t} else {\n\t\t\tendState = textMateResult.ruleStack;\n\t\t}\n\n\t\treturn new EncodedTokenizationResult(textMateResult.tokens, endState);\n\t}\n}\n"],"mappings":"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","ignoreList":[]}