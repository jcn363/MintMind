{"version":3,"names":["cov_17w20dw6qk","actualCoverage","ProxyIdentifier","count","s","_proxyIdentifierBrand","undefined","sid","nid","constructor","f","identifiers","createProxyIdentifier","identifier","result","getStringIdentifierForProxy","SerializableObjectWithBuffers","value"],"sources":["/home/user/Desktop/MintMind/src/vs/workbench/services/extensions/common/proxyIdentifier.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport type { VSBuffer } from '../../../../base/common/buffer.js';\nimport type { CancellationToken } from '../../../../base/common/cancellation.js';\n\nexport interface IRPCProtocol {\n\t/**\n\t * Returns a proxy to an object addressable/named in the extension host process or in the renderer process.\n\t */\n\tgetProxy<T>(identifier: ProxyIdentifier<T>): Proxied<T>;\n\n\t/**\n\t * Register manually created instance.\n\t */\n\tset<T, R extends T>(identifier: ProxyIdentifier<T>, instance: R): R;\n\n\t/**\n\t * Assert these identifiers are already registered via `.set`.\n\t */\n\tassertRegistered(identifiers: ProxyIdentifier<unknown>[]): void;\n\n\t/**\n\t * Wait for the write buffer (if applicable) to become empty.\n\t */\n\tdrain(): Promise<void>;\n\n\tdispose(): void;\n}\n\nexport class ProxyIdentifier<T> {\n\tpublic static count = 0;\n\t_proxyIdentifierBrand: void = undefined;\n\n\tpublic readonly sid: string;\n\tpublic readonly nid: number;\n\n\tconstructor(sid: string) {\n\t\tthis.sid = sid;\n\t\tthis.nid = (++ProxyIdentifier.count);\n\t}\n}\n\nconst identifiers: ProxyIdentifier<unknown>[] = [];\n\nexport function createProxyIdentifier<T>(identifier: string): ProxyIdentifier<T> {\n\tconst result = new ProxyIdentifier<T>(identifier);\n\tidentifiers[result.nid] = result;\n\treturn result;\n}\n\n/**\n * Mapped-type that replaces all JSONable-types with their toJSON-result type\n */\nexport type Dto<T> = T extends { toJSON(): infer U }\n\t? U\n\t: T extends VSBuffer // VSBuffer is understood by rpc-logic\n\t? T\n\t: T extends CancellationToken // CancellationToken is understood by rpc-logic\n\t? T\n\t: T extends Function // functions are dropped during JSON-stringify\n\t? never\n\t: T extends object // recurse\n\t? { [k in keyof T]: Dto<T[k]>; }\n\t: T;\n\nexport type Proxied<T> = { [K in keyof T]: T[K] extends (...args: infer A) => infer R\n\t? (...args: { [K in keyof A]: Dto<A[K]> }) => Promise<Dto<Awaited<R>>>\n\t: never\n};\n\nexport function getStringIdentifierForProxy(nid: number): string {\n\treturn identifiers[nid].sid;\n}\n\n/**\n * Marks the object as containing buffers that should be serialized more efficiently.\n */\nexport class SerializableObjectWithBuffers<T> {\n\tconstructor(\n\t\tpublic readonly value: T\n\t) { }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IA+CM;IAAAA,cAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,cAAA;AA/CN;;;;AAgCA,OAAM,MAAOE,eAAe;EACpB,OAAOC,KAAK;EAAA;EAAA,CAAAH,cAAA,GAAAI,CAAA,OAAG,CAAC;EACvBC,qBAAqB;EAAA;EAAA,CAAAL,cAAA,GAAAI,CAAA,OAASE,SAAS;EAEvBC,GAAG;EACHC,GAAG;EAEnBC,YAAYF,GAAW;IAAA;IAAAP,cAAA,GAAAU,CAAA;IAAAV,cAAA,GAAAI,CAAA;IACtB,IAAI,CAACG,GAAG,GAAGA,GAAG;IAAC;IAAAP,cAAA,GAAAI,CAAA;IACf,IAAI,CAACI,GAAG,GAAI,EAAEN,eAAe,CAACC,KAAM;EACrC;;AAGD,MAAMQ,WAAW;AAAA;AAAA,CAAAX,cAAA,GAAAI,CAAA,OAA+B,EAAE;AAElD,OAAM,SAAUQ,qBAAqBA,CAAIC,UAAkB;EAAA;EAAAb,cAAA,GAAAU,CAAA;EAC1D,MAAMI,MAAM;EAAA;EAAA,CAAAd,cAAA,GAAAI,CAAA,OAAG,IAAIF,eAAe,CAAIW,UAAU,CAAC;EAAC;EAAAb,cAAA,GAAAI,CAAA;EAClDO,WAAW,CAACG,MAAM,CAACN,GAAG,CAAC,GAAGM,MAAM;EAAC;EAAAd,cAAA,GAAAI,CAAA;EACjC,OAAOU,MAAM;AACd;AAsBA,OAAM,SAAUC,2BAA2BA,CAACP,GAAW;EAAA;EAAAR,cAAA,GAAAU,CAAA;EAAAV,cAAA,GAAAI,CAAA;EACtD,OAAOO,WAAW,CAACH,GAAG,CAAC,CAACD,GAAG;AAC5B;AAEA;;;AAGA,OAAM,MAAOS,6BAA6B;EAExBC,KAAA;EADjBR,YACiBQ,KAAQ;IAAA;IAAAjB,cAAA,GAAAU,CAAA;IAAAV,cAAA,GAAAI,CAAA;IAAR,KAAAa,KAAK,GAALA,KAAK;EAClB","ignoreList":[]}