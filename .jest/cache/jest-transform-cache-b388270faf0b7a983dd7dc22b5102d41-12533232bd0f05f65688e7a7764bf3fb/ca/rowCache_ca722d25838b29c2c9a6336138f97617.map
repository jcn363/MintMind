{"version":3,"names":["$","RowCache","renderers","cache","cov_7jt5rgjka","s","Map","transactionNodesPendingRemoval","Set","inTransaction","constructor","f","alloc","templateId","result","getTemplateCache","pop","isStale","b","has","domNode","delete","renderer","getRenderer","templateData","renderTemplate","row","isReusingConnectedDomNode","release","releaseRow","transact","makeChanges","Error","doRemoveNode","clear","add","push","classList","remove","get","set","dispose","forEach","cachedRows","cachedRow","disposeTemplate"],"sources":["/home/user/Desktop/MintMind/src/vs/base/browser/ui/list/rowCache.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { $ } from '../../dom.js';\nimport { IDisposable } from '../../../common/lifecycle.js';\nimport { IListRenderer } from './list.js';\n\nexport interface IRow {\n\tdomNode: HTMLElement;\n\ttemplateId: string;\n\ttemplateData: any;\n}\n\nexport class RowCache<T> implements IDisposable {\n\n\tprivate cache = new Map<string, IRow[]>();\n\n\tprivate readonly transactionNodesPendingRemoval = new Set<HTMLElement>();\n\tprivate inTransaction = false;\n\n\tconstructor(private renderers: Map<string, IListRenderer<T, any>>) { }\n\n\t/**\n\t * Returns a row either by creating a new one or reusing\n\t * a previously released row which shares the same templateId.\n\t *\n\t * @returns A row and `isReusingConnectedDomNode` if the row's node is already in the dom in a stale position.\n\t */\n\talloc(templateId: string): { row: IRow; isReusingConnectedDomNode: boolean } {\n\t\tlet result = this.getTemplateCache(templateId).pop();\n\n\t\tlet isStale = false;\n\t\tif (result) {\n\t\t\tisStale = this.transactionNodesPendingRemoval.has(result.domNode);\n\t\t\tif (isStale) {\n\t\t\t\tthis.transactionNodesPendingRemoval.delete(result.domNode);\n\t\t\t}\n\t\t} else {\n\t\t\tconst domNode = $('.monaco-list-row');\n\t\t\tconst renderer = this.getRenderer(templateId);\n\t\t\tconst templateData = renderer.renderTemplate(domNode);\n\t\t\tresult = { domNode, templateId, templateData };\n\t\t}\n\n\t\treturn { row: result, isReusingConnectedDomNode: isStale };\n\t}\n\n\t/**\n\t * Releases the row for eventual reuse.\n\t */\n\trelease(row: IRow): void {\n\t\tif (!row) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.releaseRow(row);\n\t}\n\n\t/**\n\t * Begin a set of changes that use the cache. This lets us skip work when a row is removed and then inserted again.\n\t */\n\ttransact(makeChanges: () => void) {\n\t\tif (this.inTransaction) {\n\t\t\tthrow new Error('Already in transaction');\n\t\t}\n\n\t\tthis.inTransaction = true;\n\n\t\ttry {\n\t\t\tmakeChanges();\n\t\t} finally {\n\t\t\tfor (const domNode of this.transactionNodesPendingRemoval) {\n\t\t\t\tthis.doRemoveNode(domNode);\n\t\t\t}\n\n\t\t\tthis.transactionNodesPendingRemoval.clear();\n\t\t\tthis.inTransaction = false;\n\t\t}\n\t}\n\n\tprivate releaseRow(row: IRow): void {\n\t\tconst { domNode, templateId } = row;\n\t\tif (domNode) {\n\t\t\tif (this.inTransaction) {\n\t\t\t\tthis.transactionNodesPendingRemoval.add(domNode);\n\t\t\t} else {\n\t\t\t\tthis.doRemoveNode(domNode);\n\t\t\t}\n\t\t}\n\n\t\tconst cache = this.getTemplateCache(templateId);\n\t\tcache.push(row);\n\t}\n\n\tprivate doRemoveNode(domNode: HTMLElement) {\n\t\tdomNode.classList.remove('scrolling');\n\t\tdomNode.remove();\n\t}\n\n\tprivate getTemplateCache(templateId: string): IRow[] {\n\t\tlet result = this.cache.get(templateId);\n\n\t\tif (!result) {\n\t\t\tresult = [];\n\t\t\tthis.cache.set(templateId, result);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tdispose(): void {\n\t\tthis.cache.forEach((cachedRows, templateId) => {\n\t\t\tfor (const cachedRow of cachedRows) {\n\t\t\t\tconst renderer = this.getRenderer(templateId);\n\t\t\t\trenderer.disposeTemplate(cachedRow.templateData);\n\t\t\t\tcachedRow.templateData = null;\n\t\t\t}\n\t\t});\n\n\t\tthis.cache.clear();\n\t\tthis.transactionNodesPendingRemoval.clear();\n\t}\n\n\tprivate getRenderer(templateId: string): IListRenderer<T, any> {\n\t\tconst renderer = this.renderers.get(templateId);\n\t\tif (!renderer) {\n\t\t\tthrow new Error(`No renderer found for ${templateId}`);\n\t\t}\n\t\treturn renderer;\n\t}\n}\n"],"mappings":"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","ignoreList":[]}