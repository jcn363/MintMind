{"version":3,"names":["binarySearch","errorHandler","ErrorNoTelemetry","PendingMigrationError","DisposableStore","toDisposable","safeStringify","FileOperationError","ErrorEvent","cov_2ea6d0nyl9","s","f","compare","a","b","callstack","BaseErrorTelemetry","ERROR_FLUSH_TIMEOUT","_telemetryService","_flushDelay","_flushHandle","undefined","_buffer","_disposables","constructor","telemetryService","flushDelay","unbind","addListener","err","_onErrorEvent","add","installErrorListeners","dispose","clearTimeout","_flushBuffer","code","detail","stack","isErrorNoTelemetry","is","message","includes","Array","isArray","join","msg","_enqueue","e","idx","count","splice","setTimeout","error","publicLogError2","length"],"sources":["/home/user/Desktop/MintMind/src/vs/platform/telemetry/common/errorTelemetry.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { binarySearch } from '../../../base/common/arrays.js';\nimport { errorHandler, ErrorNoTelemetry, PendingMigrationError } from '../../../base/common/errors.js';\nimport { DisposableStore, toDisposable } from '../../../base/common/lifecycle.js';\nimport { safeStringify } from '../../../base/common/objects.js';\nimport { FileOperationError } from '../../files/common/files.js';\nimport { ITelemetryService } from './telemetry.js';\n\ntype ErrorEventFragment = {\n\towner: 'lramos15, sbatten';\n\tcomment: 'Whenever an error in VS Code is thrown.';\n\tcallstack: { classification: 'CallstackOrException'; purpose: 'PerformanceAndHealth'; comment: 'The callstack of the error.' };\n\tmsg?: { classification: 'CallstackOrException'; purpose: 'PerformanceAndHealth'; comment: 'The message of the error. Normally the first line int the callstack.' };\n\tfile?: { classification: 'CallstackOrException'; purpose: 'PerformanceAndHealth'; comment: 'The file the error originated from.' };\n\tline?: { classification: 'CallstackOrException'; purpose: 'PerformanceAndHealth'; comment: 'The line the error originate on.' };\n\tcolumn?: { classification: 'CallstackOrException'; purpose: 'PerformanceAndHealth'; comment: 'The column of the line which the error orginated on.' };\n\tuncaught_error_name?: { classification: 'CallstackOrException'; purpose: 'PerformanceAndHealth'; comment: 'If the error is uncaught what is the error type' };\n\tuncaught_error_msg?: { classification: 'CallstackOrException'; purpose: 'PerformanceAndHealth'; comment: 'If the error is uncaught this is just msg but for uncaught errors.' };\n\tcount?: { classification: 'CallstackOrException'; purpose: 'PerformanceAndHealth'; comment: 'How many times this error has been thrown' };\n};\nexport interface ErrorEvent {\n\tcallstack: string;\n\tmsg?: string;\n\tfile?: string;\n\tline?: number;\n\tcolumn?: number;\n\tuncaught_error_name?: string;\n\tuncaught_error_msg?: string;\n\tcount?: number;\n}\n\nexport namespace ErrorEvent {\n\texport function compare(a: ErrorEvent, b: ErrorEvent) {\n\t\tif (a.callstack < b.callstack) {\n\t\t\treturn -1;\n\t\t} else if (a.callstack > b.callstack) {\n\t\t\treturn 1;\n\t\t}\n\t\treturn 0;\n\t}\n}\n\nexport default abstract class BaseErrorTelemetry {\n\n\tpublic static ERROR_FLUSH_TIMEOUT: number = 5 * 1000;\n\n\tprivate _telemetryService: ITelemetryService;\n\tprivate _flushDelay: number;\n\tprivate _flushHandle: Timeout | undefined = undefined;\n\tprivate _buffer: ErrorEvent[] = [];\n\tprotected readonly _disposables = new DisposableStore();\n\n\tconstructor(telemetryService: ITelemetryService, flushDelay = BaseErrorTelemetry.ERROR_FLUSH_TIMEOUT) {\n\t\tthis._telemetryService = telemetryService;\n\t\tthis._flushDelay = flushDelay;\n\n\t\t// (1) check for unexpected but handled errors\n\t\tconst unbind = errorHandler.addListener((err) => this._onErrorEvent(err));\n\t\tthis._disposables.add(toDisposable(unbind));\n\n\t\t// (2) install implementation-specific error listeners\n\t\tthis.installErrorListeners();\n\t}\n\n\tdispose() {\n\t\tclearTimeout(this._flushHandle);\n\t\tthis._flushBuffer();\n\t\tthis._disposables.dispose();\n\t}\n\n\tprotected installErrorListeners(): void {\n\t\t// to override\n\t}\n\n\tprivate _onErrorEvent(err: any): void {\n\n\t\tif (!err || err.code) {\n\t\t\treturn;\n\t\t}\n\n\t\t// unwrap nested errors from loader\n\t\tif (err.detail && err.detail.stack) {\n\t\t\terr = err.detail;\n\t\t}\n\n\t\t// If it's the no telemetry error it doesn't get logged\n\t\t// TOOD @lramos15 hacking in FileOperation error because it's too messy to adopt ErrorNoTelemetry. A better solution should be found\n\t\t//\n\t\t// Explicitly filter out PendingMigrationError for https://github.com/microsoft/vscode/issues/250648#issuecomment-3394040431\n\t\t// We don't inherit from ErrorNoTelemetry to preserve the name used in reporting for exthostdeprecatedapiusage event.\n\t\t// TODO(deepak1556): remove when PendingMigrationError is no longer needed.\n\t\tif (ErrorNoTelemetry.isErrorNoTelemetry(err) || err instanceof FileOperationError || PendingMigrationError.is(err) || (typeof err?.message === 'string' && err.message.includes('Unable to read file'))) {\n\t\t\treturn;\n\t\t}\n\n\t\t// work around behavior in workerServer.ts that breaks up Error.stack\n\t\tconst callstack = Array.isArray(err.stack) ? err.stack.join('\\n') : err.stack;\n\t\tconst msg = err.message ? err.message : safeStringify(err);\n\n\t\t// errors without a stack are not useful telemetry\n\t\tif (!callstack) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._enqueue({ msg, callstack });\n\t}\n\n\tprotected _enqueue(e: ErrorEvent): void {\n\n\t\tconst idx = binarySearch(this._buffer, e, ErrorEvent.compare);\n\t\tif (idx < 0) {\n\t\t\te.count = 1;\n\t\t\tthis._buffer.splice(~idx, 0, e);\n\t\t} else {\n\t\t\tif (!this._buffer[idx].count) {\n\t\t\t\tthis._buffer[idx].count = 0;\n\t\t\t}\n\t\t\tthis._buffer[idx].count += 1;\n\t\t}\n\n\t\tif (this._flushHandle === undefined) {\n\t\t\tthis._flushHandle = setTimeout(() => {\n\t\t\t\tthis._flushBuffer();\n\t\t\t\tthis._flushHandle = undefined;\n\t\t\t}, this._flushDelay);\n\t\t}\n\t}\n\n\tprivate _flushBuffer(): void {\n\t\tfor (const error of this._buffer) {\n\t\t\ttype UnhandledErrorClassification = {} & ErrorEventFragment;\n\t\t\tthis._telemetryService.publicLogError2<ErrorEvent, UnhandledErrorClassification>('UnhandledError', error);\n\t\t}\n\t\tthis._buffer.length = 0;\n\t}\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}