{"version":3,"names":["cancelOnDispose","DisposableStore","autorunWithStoreHandleChanges","runOnChange","observable","cb","cov_15akmpb1k3","f","_previousValue","_firstRun","s","changeTracker","createChangeSummary","deltas","didChange","handleChange","context","changeSummary","b","e","change","undefined","push","reader","value","read","previousValue","runOnChangeWithStore","store","disposable","clear","dispose","runOnChangeWithCancellationToken"],"sources":["/home/user/Desktop/MintMind/src/vs/base/common/observableInternal/utils/runOnChange.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IObservableWithChange } from '../base.js';\nimport { CancellationToken, cancelOnDispose } from '../commonFacade/cancellation.js';\nimport { DisposableStore, IDisposable } from '../commonFacade/deps.js';\nimport { autorunWithStoreHandleChanges } from '../reactions/autorun.js';\n\nexport type RemoveUndefined<T> = T extends undefined ? never : T;\n\nexport function runOnChange<T, TChange>(observable: IObservableWithChange<T, TChange>, cb: (value: T, previousValue: T, deltas: RemoveUndefined<TChange>[]) => void): IDisposable {\n\tlet _previousValue: T | undefined;\n\tlet _firstRun = true;\n\treturn autorunWithStoreHandleChanges({\n\t\tchangeTracker: {\n\t\t\tcreateChangeSummary: () => ({ deltas: [] as RemoveUndefined<TChange>[], didChange: false }),\n\t\t\thandleChange: (context, changeSummary) => {\n\t\t\t\tif (context.didChange(observable)) {\n\t\t\t\t\tconst e = context.change;\n\t\t\t\t\tif (e !== undefined) {\n\t\t\t\t\t\tchangeSummary.deltas.push(e as RemoveUndefined<TChange>);\n\t\t\t\t\t}\n\t\t\t\t\tchangeSummary.didChange = true;\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t},\n\t\t}\n\t}, (reader, changeSummary) => {\n\t\tconst value = observable.read(reader);\n\t\tconst previousValue = _previousValue;\n\t\tif (changeSummary.didChange) {\n\t\t\t_previousValue = value;\n\t\t\t// didChange can never be true on the first autorun, so we know previousValue is defined\n\t\t\tcb(value, previousValue!, changeSummary.deltas);\n\t\t}\n\t\tif (_firstRun) {\n\t\t\t_firstRun = false;\n\t\t\t_previousValue = value;\n\t\t}\n\t});\n}\n\nexport function runOnChangeWithStore<T, TChange>(observable: IObservableWithChange<T, TChange>, cb: (value: T, previousValue: T, deltas: RemoveUndefined<TChange>[], store: DisposableStore) => void): IDisposable {\n\tconst store = new DisposableStore();\n\tconst disposable = runOnChange(observable, (value, previousValue: T, deltas) => {\n\t\tstore.clear();\n\t\tcb(value, previousValue, deltas, store);\n\t});\n\treturn {\n\t\tdispose() {\n\t\t\tdisposable.dispose();\n\t\t\tstore.dispose();\n\t\t}\n\t};\n}\n\nexport function runOnChangeWithCancellationToken<T, TChange>(observable: IObservableWithChange<T, TChange>, cb: (value: T, previousValue: T, deltas: RemoveUndefined<TChange>[], token: CancellationToken) => Promise<void>): IDisposable {\n\treturn runOnChangeWithStore(observable, (value, previousValue, deltas, store) => {\n\t\tcb(value, previousValue, deltas, cancelOnDispose(store));\n\t});\n}\n"],"mappings":"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","ignoreList":[]}