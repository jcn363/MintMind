{"version":3,"names":["cov_2mg4m8hqml","actualCoverage","Range","lengthAdd","lengthDiffNonNegative","lengthLessThanEqual","lengthOfString","lengthToObj","positionToLength","toLength","TextEditInfo","startOffset","endOffset","newLength","fromModelContentChanges","changes","f","edits","s","map","c","range","lift","getStartPosition","getEndPosition","text","reverse","constructor","toString","BeforeEditPositionMapper","nextEditIdx","deltaOldToNewLineCount","deltaOldToNewColumnCount","deltaLineIdxInOld","edit","TextEditInfoCache","from","getOffsetBeforeChange","offset","adjustNextEdit","translateCurToOld","getDistanceToNextChange","nextEdit","nextChangeOffset","b","translateOldToCur","offsetObj","oldOffsetObj","lineCount","columnCount","newOffset","length","nextEditEndOffsetInCur","endOffsetAfterObj","nextEditEndOffsetInCurObj","nextEditEndOffsetBeforeInCurObj","endOffsetBeforeObj","lineDelta","previousColumnDelta","columnDelta","textLength"],"sources":["/home/user/Desktop/MintMind/src/vs/editor/common/model/bracketPairsTextModelPart/bracketPairsTree/beforeEditPositionMapper.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Range } from '../../../core/range.js';\nimport { Length, lengthAdd, lengthDiffNonNegative, lengthLessThanEqual, lengthOfString, lengthToObj, positionToLength, toLength } from './length.js';\nimport { TextLength } from '../../../core/text/textLength.js';\nimport { IModelContentChange } from '../../mirrorTextModel.js';\n\nexport class TextEditInfo {\n\tpublic static fromModelContentChanges(changes: IModelContentChange[]): TextEditInfo[] {\n\t\t// Must be sorted in ascending order\n\t\tconst edits = changes.map(c => {\n\t\t\tconst range = Range.lift(c.range);\n\t\t\treturn new TextEditInfo(\n\t\t\t\tpositionToLength(range.getStartPosition()),\n\t\t\t\tpositionToLength(range.getEndPosition()),\n\t\t\t\tlengthOfString(c.text)\n\t\t\t);\n\t\t}).reverse();\n\t\treturn edits;\n\t}\n\n\tconstructor(\n\t\tpublic readonly startOffset: Length,\n\t\tpublic readonly endOffset: Length,\n\t\tpublic readonly newLength: Length\n\t) {\n\t}\n\n\ttoString(): string {\n\t\treturn `[${lengthToObj(this.startOffset)}...${lengthToObj(this.endOffset)}) -> ${lengthToObj(this.newLength)}`;\n\t}\n}\n\nexport class BeforeEditPositionMapper {\n\tprivate nextEditIdx = 0;\n\tprivate deltaOldToNewLineCount = 0;\n\tprivate deltaOldToNewColumnCount = 0;\n\tprivate deltaLineIdxInOld = -1;\n\tprivate readonly edits: readonly TextEditInfoCache[];\n\n\t/**\n\t * @param edits Must be sorted by offset in ascending order.\n\t*/\n\tconstructor(\n\t\tedits: readonly TextEditInfo[],\n\t) {\n\t\tthis.edits = edits.map(edit => TextEditInfoCache.from(edit));\n\t}\n\n\t/**\n\t * @param offset Must be equal to or greater than the last offset this method has been called with.\n\t*/\n\tgetOffsetBeforeChange(offset: Length): Length {\n\t\tthis.adjustNextEdit(offset);\n\t\treturn this.translateCurToOld(offset);\n\t}\n\n\t/**\n\t * @param offset Must be equal to or greater than the last offset this method has been called with.\n\t * Returns null if there is no edit anymore.\n\t*/\n\tgetDistanceToNextChange(offset: Length): Length | null {\n\t\tthis.adjustNextEdit(offset);\n\n\t\tconst nextEdit = this.edits[this.nextEditIdx];\n\t\tconst nextChangeOffset = nextEdit ? this.translateOldToCur(nextEdit.offsetObj) : null;\n\t\tif (nextChangeOffset === null) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn lengthDiffNonNegative(offset, nextChangeOffset);\n\t}\n\n\tprivate translateOldToCur(oldOffsetObj: TextLength): Length {\n\t\tif (oldOffsetObj.lineCount === this.deltaLineIdxInOld) {\n\t\t\treturn toLength(oldOffsetObj.lineCount + this.deltaOldToNewLineCount, oldOffsetObj.columnCount + this.deltaOldToNewColumnCount);\n\t\t} else {\n\t\t\treturn toLength(oldOffsetObj.lineCount + this.deltaOldToNewLineCount, oldOffsetObj.columnCount);\n\t\t}\n\t}\n\n\tprivate translateCurToOld(newOffset: Length): Length {\n\t\tconst offsetObj = lengthToObj(newOffset);\n\t\tif (offsetObj.lineCount - this.deltaOldToNewLineCount === this.deltaLineIdxInOld) {\n\t\t\treturn toLength(offsetObj.lineCount - this.deltaOldToNewLineCount, offsetObj.columnCount - this.deltaOldToNewColumnCount);\n\t\t} else {\n\t\t\treturn toLength(offsetObj.lineCount - this.deltaOldToNewLineCount, offsetObj.columnCount);\n\t\t}\n\t}\n\n\tprivate adjustNextEdit(offset: Length) {\n\t\twhile (this.nextEditIdx < this.edits.length) {\n\t\t\tconst nextEdit = this.edits[this.nextEditIdx];\n\n\t\t\t// After applying the edit, what is its end offset (considering all previous edits)?\n\t\t\tconst nextEditEndOffsetInCur = this.translateOldToCur(nextEdit.endOffsetAfterObj);\n\n\t\t\tif (lengthLessThanEqual(nextEditEndOffsetInCur, offset)) {\n\t\t\t\t// We are after the edit, skip it\n\t\t\t\tthis.nextEditIdx++;\n\n\t\t\t\tconst nextEditEndOffsetInCurObj = lengthToObj(nextEditEndOffsetInCur);\n\n\t\t\t\t// Before applying the edit, what is its end offset (considering all previous edits)?\n\t\t\t\tconst nextEditEndOffsetBeforeInCurObj = lengthToObj(this.translateOldToCur(nextEdit.endOffsetBeforeObj));\n\n\t\t\t\tconst lineDelta = nextEditEndOffsetInCurObj.lineCount - nextEditEndOffsetBeforeInCurObj.lineCount;\n\t\t\t\tthis.deltaOldToNewLineCount += lineDelta;\n\n\t\t\t\tconst previousColumnDelta = this.deltaLineIdxInOld === nextEdit.endOffsetBeforeObj.lineCount ? this.deltaOldToNewColumnCount : 0;\n\t\t\t\tconst columnDelta = nextEditEndOffsetInCurObj.columnCount - nextEditEndOffsetBeforeInCurObj.columnCount;\n\t\t\t\tthis.deltaOldToNewColumnCount = previousColumnDelta + columnDelta;\n\t\t\t\tthis.deltaLineIdxInOld = nextEdit.endOffsetBeforeObj.lineCount;\n\t\t\t} else {\n\t\t\t\t// We are in or before the edit.\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n}\n\nclass TextEditInfoCache {\n\tstatic from(edit: TextEditInfo): TextEditInfoCache {\n\t\treturn new TextEditInfoCache(edit.startOffset, edit.endOffset, edit.newLength);\n\t}\n\n\tpublic readonly endOffsetBeforeObj: TextLength;\n\tpublic readonly endOffsetAfterObj: TextLength;\n\tpublic readonly offsetObj: TextLength;\n\n\tconstructor(\n\t\tstartOffset: Length,\n\t\tendOffset: Length,\n\t\ttextLength: Length,\n\t) {\n\t\tthis.endOffsetBeforeObj = lengthToObj(endOffset);\n\t\tthis.endOffsetAfterObj = lengthToObj(lengthAdd(startOffset, textLength));\n\t\tthis.offsetObj = lengthToObj(startOffset);\n\t}\n}\n"],"mappings":"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","ignoreList":[]}