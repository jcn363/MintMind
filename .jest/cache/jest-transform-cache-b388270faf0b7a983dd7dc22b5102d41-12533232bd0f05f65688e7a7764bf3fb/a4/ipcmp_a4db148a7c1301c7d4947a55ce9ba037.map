{"version":3,"names":["cov_18f6hoa7w4","actualCoverage","VSBuffer","Event","IPCClient","Protocol","port","onMessage","constructor","f","s","fromDOMEventEmitter","e","data","b","wrap","alloc","start","send","message","postMessage","buffer","disconnect","close","Client","protocol","clientId","dispose"],"sources":["/home/user/Desktop/MintMind/src/vs/base/parts/ipc/common/ipc.mp.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { VSBuffer } from '../../../common/buffer.js';\nimport { Event } from '../../../common/event.js';\nimport { IDisposable } from '../../../common/lifecycle.js';\nimport { IMessagePassingProtocol, IPCClient } from './ipc.js';\n\n/**\n * Declare minimal `MessageEvent` and `MessagePort` interfaces here\n * so that this utility can be used both from `browser` and\n * `electron-main` namespace where message ports are available.\n */\n\nexport interface MessageEvent {\n\n\t/**\n\t * For our use we only consider `Uint8Array` a valid data transfer\n\t * via message ports because our protocol implementation is buffer based.\n\t */\n\tdata: Uint8Array;\n}\n\nexport interface MessagePort {\n\n\taddEventListener(type: 'message', listener: (this: MessagePort, e: MessageEvent) => unknown): void;\n\tremoveEventListener(type: 'message', listener: (this: MessagePort, e: MessageEvent) => unknown): void;\n\n\tpostMessage(message: Uint8Array): void;\n\n\tstart(): void;\n\tclose(): void;\n}\n\n/**\n * The MessagePort `Protocol` leverages MessagePort style IPC communication\n * for the implementation of the `IMessagePassingProtocol`. That style of API\n * is a simple `onmessage` / `postMessage` pattern.\n */\nexport class Protocol implements IMessagePassingProtocol {\n\n\treadonly onMessage;\n\n\tconstructor(private port: MessagePort) {\n\t\tthis.onMessage = Event.fromDOMEventEmitter<VSBuffer>(this.port, 'message', (e: MessageEvent) => {\n\t\t\tif (e.data) {\n\t\t\t\treturn VSBuffer.wrap(e.data);\n\t\t\t}\n\t\t\treturn VSBuffer.alloc(0);\n\t\t});\n\t\t// we must call start() to ensure messages are flowing\n\t\tport.start();\n\t}\n\n\tsend(message: VSBuffer): void {\n\t\tthis.port.postMessage(message.buffer);\n\t}\n\n\tdisconnect(): void {\n\t\tthis.port.close();\n\t}\n}\n\n/**\n * An implementation of a `IPCClient` on top of MessagePort style IPC communication.\n */\nexport class Client extends IPCClient implements IDisposable {\n\n\tprivate protocol: Protocol;\n\n\tconstructor(port: MessagePort, clientId: string) {\n\t\tconst protocol = new Protocol(port);\n\t\tsuper(protocol, clientId);\n\n\t\tthis.protocol = protocol;\n\t}\n\n\toverride dispose(): void {\n\t\tthis.protocol.disconnect();\n\n\t\tsuper.dispose();\n\t}\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IA6CC;IAAAA,cAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,cAAA;AA7CD;;;;AAKA,SAASE,QAAQ,QAAQ,2BAA2B;AACpD,SAASC,KAAK,QAAQ,0BAA0B;AAEhD,SAAkCC,SAAS,QAAQ,UAAU;AA4B7D;;;;;AAKA,OAAM,MAAOC,QAAQ;EAIAC,IAAA;EAFXC,SAAS;EAElBC,YAAoBF,IAAiB;IAAA;IAAAN,cAAA,GAAAS,CAAA;IAAAT,cAAA,GAAAU,CAAA;IAAjB,KAAAJ,IAAI,GAAJA,IAAI;IAAa;IAAAN,cAAA,GAAAU,CAAA;IACpC,IAAI,CAACH,SAAS,GAAGJ,KAAK,CAACQ,mBAAmB,CAAW,IAAI,CAACL,IAAI,EAAE,SAAS,EAAGM,CAAe,IAAI;MAAA;MAAAZ,cAAA,GAAAS,CAAA;MAAAT,cAAA,GAAAU,CAAA;MAC9F,IAAIE,CAAC,CAACC,IAAI,EAAE;QAAA;QAAAb,cAAA,GAAAc,CAAA;QAAAd,cAAA,GAAAU,CAAA;QACX,OAAOR,QAAQ,CAACa,IAAI,CAACH,CAAC,CAACC,IAAI,CAAC;MAC7B,CAAC;MAAA;MAAA;QAAAb,cAAA,GAAAc,CAAA;MAAA;MAAAd,cAAA,GAAAU,CAAA;MACD,OAAOR,QAAQ,CAACc,KAAK,CAAC,CAAC,CAAC;IACzB,CAAC,CAAC;IACF;IAAA;IAAAhB,cAAA,GAAAU,CAAA;IACAJ,IAAI,CAACW,KAAK,EAAE;EACb;EAEAC,IAAIA,CAACC,OAAiB;IAAA;IAAAnB,cAAA,GAAAS,CAAA;IAAAT,cAAA,GAAAU,CAAA;IACrB,IAAI,CAACJ,IAAI,CAACc,WAAW,CAACD,OAAO,CAACE,MAAM,CAAC;EACtC;EAEAC,UAAUA,CAAA;IAAA;IAAAtB,cAAA,GAAAS,CAAA;IAAAT,cAAA,GAAAU,CAAA;IACT,IAAI,CAACJ,IAAI,CAACiB,KAAK,EAAE;EAClB;;AAGD;;;AAGA,OAAM,MAAOC,MAAO,SAAQpB,SAAS;EAE5BqB,QAAQ;EAEhBjB,YAAYF,IAAiB,EAAEoB,QAAgB;IAAA;IAAA1B,cAAA,GAAAS,CAAA;IAC9C,MAAMgB,QAAQ;IAAA;IAAA,CAAAzB,cAAA,GAAAU,CAAA,OAAG,IAAIL,QAAQ,CAACC,IAAI,CAAC;IAAC;IAAAN,cAAA,GAAAU,CAAA;IACpC,KAAK,CAACe,QAAQ,EAAEC,QAAQ,CAAC;IAAC;IAAA1B,cAAA,GAAAU,CAAA;IAE1B,IAAI,CAACe,QAAQ,GAAGA,QAAQ;EACzB;EAESE,OAAOA,CAAA;IAAA;IAAA3B,cAAA,GAAAS,CAAA;IAAAT,cAAA,GAAAU,CAAA;IACf,IAAI,CAACe,QAAQ,CAACH,UAAU,EAAE;IAAC;IAAAtB,cAAA,GAAAU,CAAA;IAE3B,KAAK,CAACiB,OAAO,EAAE;EAChB","ignoreList":[]}