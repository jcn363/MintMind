{"version":3,"names":["cov_22wsn15hah","actualCoverage","decodeBase64","WELL_KNOWN_ROUTE","s","AUTH_PROTECTED_RESOURCE_METADATA_DISCOVERY_PATH","AUTH_SERVER_METADATA_DISCOVERY_PATH","OPENID_CONNECT_DISCOVERY_PATH","AUTH_SCOPE_SEPARATOR","isAuthorizationProtectedResourceMetadata","obj","f","b","metadata","resource","scopes_supported","undefined","Array","isArray","urisToCheck","isAuthorizationServerMetadata","issuer","Error","uri","startsWith","isAuthorizationDynamicClientRegistrationResponse","response","client_id","isAuthorizationAuthorizeResponse","code","state","isAuthorizationTokenResponse","access_token","token_type","isAuthorizationDeviceResponse","device_code","user_code","verification_uri","expires_in","isAuthorizationErrorResponse","error","isAuthorizationRegistrationErrorResponse","getDefaultMetadataForUrl","authorizationServer","toString","authorization_endpoint","URL","token_endpoint","registration_endpoint","response_types_supported","grantTypesSupported","DEFAULT_AUTH_FLOW_PORT","fetchDynamicRegistration","serverMetadata","clientName","scopes","requestBody","client_name","client_uri","grant_types","grant_types_supported","filter","gt","includes","response_types","redirect_uris","scope","join","token_endpoint_auth_method","application_type","fetch","method","headers","body","JSON","stringify","ok","result","text","errorDetails","errorResponse","parse","error_description","registration","json","parseWWWAuthenticateHeader","wwwAuthenticateHeaderValue","challenges","tokens","current","inQuotes","i","length","char","trim","push","currentChallenge","token","hasEquals","scheme","params","spaceIndex","indexOf","beforeSpace","substring","afterSpace","equalIndex","key","value","replace","getClaimsFromJWT","parts","split","header","payload","_signature","decodedHeader","decodedPayload","e","message","scopesMatch","scopes1","scopes2","sortedScopes1","sort","sortedScopes2","every","index","fetchResourceMetadata","targetResource","resourceMetadataUrl","options","sameOriginHeaders","fetchImpl","targetResourceUrlObj","urlsToTry","pathComponent","pathname","rootUrl","origin","errors","urlToTry","resourceMetadataUrlObj","status","errorText","statusText","prmValue","targetValue","String","AggregateError","tryParseAuthServerMetadata","getErrText","res","fetchAuthorizationServerMetadata","additionalHeaders","authorizationServerUrl","extraPath","doFetch","url","rawResponse","pathToFetch","openidPathInsertionUrl","openidPathAdditionUrl","endsWith"],"sources":["/home/user/Desktop/MintMind/src/vs/base/common/oauth.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { decodeBase64 } from './buffer.js';\n\nconst WELL_KNOWN_ROUTE = '/.well-known';\nexport const AUTH_PROTECTED_RESOURCE_METADATA_DISCOVERY_PATH = `${WELL_KNOWN_ROUTE}/oauth-protected-resource`;\nexport const AUTH_SERVER_METADATA_DISCOVERY_PATH = `${WELL_KNOWN_ROUTE}/oauth-authorization-server`;\nexport const OPENID_CONNECT_DISCOVERY_PATH = `${WELL_KNOWN_ROUTE}/openid-configuration`;\nexport const AUTH_SCOPE_SEPARATOR = ' ';\n\n//#region types\n\n/**\n * Base OAuth 2.0 error codes as specified in RFC 6749.\n */\nexport const enum AuthorizationErrorType {\n\tInvalidRequest = 'invalid_request',\n\tInvalidClient = 'invalid_client',\n\tInvalidGrant = 'invalid_grant',\n\tUnauthorizedClient = 'unauthorized_client',\n\tUnsupportedGrantType = 'unsupported_grant_type',\n\tInvalidScope = 'invalid_scope'\n}\n\n/**\n * Device authorization grant specific error codes as specified in RFC 8628 section 3.5.\n */\nexport const enum AuthorizationDeviceCodeErrorType {\n\t/**\n\t * The authorization request is still pending as the end user hasn't completed the user interaction steps.\n\t */\n\tAuthorizationPending = 'authorization_pending',\n\t/**\n\t * A variant of \"authorization_pending\", polling should continue but interval must be increased by 5 seconds.\n\t */\n\tSlowDown = 'slow_down',\n\t/**\n\t * The authorization request was denied.\n\t */\n\tAccessDenied = 'access_denied',\n\t/**\n\t * The \"device_code\" has expired and the device authorization session has concluded.\n\t */\n\tExpiredToken = 'expired_token'\n}\n\n/**\n * Dynamic client registration specific error codes as specified in RFC 7591.\n */\nexport const enum AuthorizationRegistrationErrorType {\n\t/**\n\t * The value of one or more redirection URIs is invalid.\n\t */\n\tInvalidRedirectUri = 'invalid_redirect_uri',\n\t/**\n\t * The value of one of the client metadata fields is invalid and the server has rejected this request.\n\t */\n\tInvalidClientMetadata = 'invalid_client_metadata',\n\t/**\n\t * The software statement presented is invalid.\n\t */\n\tInvalidSoftwareStatement = 'invalid_software_statement',\n\t/**\n\t * The software statement presented is not approved for use by this authorization server.\n\t */\n\tUnapprovedSoftwareStatement = 'unapproved_software_statement'\n}\n\n/**\n * Metadata about a protected resource.\n */\nexport interface IAuthorizationProtectedResourceMetadata {\n\t/**\n\t * REQUIRED. The protected resource's resource identifier URL that uses https scheme and has no fragment components.\n\t */\n\tresource: string;\n\n\t/**\n\t * OPTIONAL. Human-readable name of the protected resource intended for display to the end user.\n\t */\n\tresource_name?: string;\n\n\t/**\n\t * OPTIONAL. JSON array containing a list of OAuth authorization server identifiers.\n\t */\n\tauthorization_servers?: string[];\n\n\t/**\n\t * OPTIONAL. URL of the protected resource's JWK Set document.\n\t */\n\tjwks_uri?: string;\n\n\t/**\n\t * RECOMMENDED. JSON array containing a list of the OAuth 2.0 scope values used in authorization requests.\n\t */\n\tscopes_supported?: string[];\n\n\t/**\n\t * OPTIONAL. JSON array containing a list of the OAuth 2.0 Bearer Token presentation methods supported.\n\t */\n\tbearer_methods_supported?: string[];\n\n\t/**\n\t * OPTIONAL. JSON array containing a list of the JWS signing algorithms supported.\n\t */\n\tresource_signing_alg_values_supported?: string[];\n\n\t/**\n\t * OPTIONAL. JSON array containing a list of the JWE encryption algorithms supported.\n\t */\n\tresource_encryption_alg_values_supported?: string[];\n\n\t/**\n\t * OPTIONAL. JSON array containing a list of the JWE encryption algorithms supported.\n\t */\n\tresource_encryption_enc_values_supported?: string[];\n\n\t/**\n\t * OPTIONAL. URL of a page containing human-readable documentation.\n\t */\n\tresource_documentation?: string;\n\n\t/**\n\t * OPTIONAL. URL that provides the resource's requirements on how clients can use the data.\n\t */\n\tresource_policy_uri?: string;\n\n\t/**\n\t * OPTIONAL. URL that provides the resource's terms of service.\n\t */\n\tresource_tos_uri?: string;\n}\n\n/**\n * Metadata about an OAuth 2.0 Authorization Server.\n */\nexport interface IAuthorizationServerMetadata {\n\t/**\n\t * REQUIRED. The authorization server's issuer identifier URL that uses https scheme and has no query or fragment components.\n\t */\n\tissuer: string;\n\n\t/**\n\t * URL of the authorization server's authorization endpoint.\n\t * This is REQUIRED unless no grant types are supported that use the authorization endpoint.\n\t */\n\tauthorization_endpoint?: string;\n\n\t/**\n\t * URL of the authorization server's token endpoint.\n\t * This is REQUIRED unless only the implicit grant type is supported.\n\t */\n\ttoken_endpoint?: string;\n\n\t/**\n\t * OPTIONAL. URL of the authorization server's device code endpoint.\n\t */\n\tdevice_authorization_endpoint?: string;\n\n\t/**\n\t * OPTIONAL. URL of the authorization server's JWK Set document containing signing keys.\n\t */\n\tjwks_uri?: string;\n\n\t/**\n\t * OPTIONAL. URL of the authorization server's OAuth 2.0 Dynamic Client Registration endpoint.\n\t */\n\tregistration_endpoint?: string;\n\n\t/**\n\t * RECOMMENDED. JSON array containing a list of the OAuth 2.0 scope values supported.\n\t */\n\tscopes_supported?: string[];\n\n\t/**\n\t * REQUIRED. JSON array containing a list of the OAuth 2.0 response_type values supported.\n\t */\n\tresponse_types_supported: string[];\n\n\t/**\n\t * OPTIONAL. JSON array containing a list of the OAuth 2.0 response_mode values supported.\n\t * Default is [\"query\", \"fragment\"].\n\t */\n\tresponse_modes_supported?: string[];\n\n\t/**\n\t * OPTIONAL. JSON array containing a list of OAuth 2.0 grant type values supported.\n\t * Default is [\"authorization_code\", \"implicit\"].\n\t */\n\tgrant_types_supported?: string[];\n\n\t/**\n\t * OPTIONAL. JSON array containing a list of client authentication methods supported by the token endpoint.\n\t * Default is \"client_secret_basic\".\n\t */\n\ttoken_endpoint_auth_methods_supported?: string[];\n\n\t/**\n\t * OPTIONAL. JSON array containing a list of JWS signing algorithms supported by the token endpoint.\n\t */\n\ttoken_endpoint_auth_signing_alg_values_supported?: string[];\n\n\t/**\n\t * OPTIONAL. URL of a page containing human-readable documentation for developers.\n\t */\n\tservice_documentation?: string;\n\n\t/**\n\t * OPTIONAL. Languages and scripts supported for the user interface, as a JSON array of BCP 47 language tags.\n\t */\n\tui_locales_supported?: string[];\n\n\t/**\n\t * OPTIONAL. URL that the authorization server provides to read about the authorization server's requirements.\n\t */\n\top_policy_uri?: string;\n\n\t/**\n\t * OPTIONAL. URL that the authorization server provides to read about the authorization server's terms of service.\n\t */\n\top_tos_uri?: string;\n\n\t/**\n\t * OPTIONAL. URL of the authorization server's OAuth 2.0 revocation endpoint.\n\t */\n\trevocation_endpoint?: string;\n\n\t/**\n\t * OPTIONAL. JSON array containing a list of client authentication methods supported by the revocation endpoint.\n\t */\n\trevocation_endpoint_auth_methods_supported?: string[];\n\n\t/**\n\t * OPTIONAL. JSON array containing a list of JWS signing algorithms supported by the revocation endpoint.\n\t */\n\trevocation_endpoint_auth_signing_alg_values_supported?: string[];\n\n\t/**\n\t * OPTIONAL. URL of the authorization server's OAuth 2.0 introspection endpoint.\n\t */\n\tintrospection_endpoint?: string;\n\n\t/**\n\t * OPTIONAL. JSON array containing a list of client authentication methods supported by the introspection endpoint.\n\t */\n\tintrospection_endpoint_auth_methods_supported?: string[];\n\n\t/**\n\t * OPTIONAL. JSON array containing a list of JWS signing algorithms supported by the introspection endpoint.\n\t */\n\tintrospection_endpoint_auth_signing_alg_values_supported?: string[];\n\n\t/**\n\t * OPTIONAL. JSON array containing a list of PKCE code challenge methods supported.\n\t */\n\tcode_challenge_methods_supported?: string[];\n\n\t/**\n\t * OPTIONAL. Boolean flag indicating whether the authorization server supports the\n\t * client_id_metadata document.\n\t * ref https://datatracker.ietf.org/doc/html/draft-parecki-oauth-client-id-metadata-document-03\n\t */\n\tclient_id_metadata_document_supported?: boolean;\n}\n\n/**\n * Request for the dynamic client registration endpoint.\n * @see https://datatracker.ietf.org/doc/html/rfc7591#section-2\n */\nexport interface IAuthorizationDynamicClientRegistrationRequest {\n\t/**\n\t * OPTIONAL. Array of redirection URI strings for use in redirect-based flows\n\t * such as the authorization code and implicit flows.\n\t */\n\tredirect_uris?: string[];\n\n\t/**\n\t * OPTIONAL. String indicator of the requested authentication method for the token endpoint.\n\t * Values: \"none\", \"client_secret_post\", \"client_secret_basic\".\n\t * Default is \"client_secret_basic\".\n\t */\n\ttoken_endpoint_auth_method?: string;\n\n\t/**\n\t * OPTIONAL. Array of OAuth 2.0 grant type strings that the client can use at the token endpoint.\n\t * Default is [\"authorization_code\"].\n\t */\n\tgrant_types?: string[];\n\n\t/**\n\t * OPTIONAL. Array of the OAuth 2.0 response type strings that the client can use at the authorization endpoint.\n\t * Default is [\"code\"].\n\t */\n\tresponse_types?: string[];\n\n\t/**\n\t * OPTIONAL. Human-readable string name of the client to be presented to the end-user during authorization.\n\t */\n\tclient_name?: string;\n\n\t/**\n\t * OPTIONAL. URL string of a web page providing information about the client.\n\t */\n\tclient_uri?: string;\n\n\t/**\n\t * OPTIONAL. URL string that references a logo for the client.\n\t */\n\tlogo_uri?: string;\n\n\t/**\n\t * OPTIONAL. String containing a space-separated list of scope values that the client can use when requesting access tokens.\n\t */\n\tscope?: string;\n\n\t/**\n\t * OPTIONAL. Array of strings representing ways to contact people responsible for this client, typically email addresses.\n\t */\n\tcontacts?: string[];\n\n\t/**\n\t * OPTIONAL. URL string that points to a human-readable terms of service document for the client.\n\t */\n\ttos_uri?: string;\n\n\t/**\n\t * OPTIONAL. URL string that points to a human-readable privacy policy document.\n\t */\n\tpolicy_uri?: string;\n\n\t/**\n\t * OPTIONAL. URL string referencing the client's JSON Web Key (JWK) Set document.\n\t */\n\tjwks_uri?: string;\n\n\t/**\n\t * OPTIONAL. Client's JSON Web Key Set document value.\n\t */\n\tjwks?: object;\n\n\t/**\n\t * OPTIONAL. A unique identifier string assigned by the client developer or software publisher.\n\t */\n\tsoftware_id?: string;\n\n\t/**\n\t * OPTIONAL. A version identifier string for the client software.\n\t */\n\tsoftware_version?: string;\n\n\t/**\n\t * OPTIONAL. A software statement containing client metadata values about the client software as claims.\n\t */\n\tsoftware_statement?: string;\n\n\t/**\n\t * OPTIONAL. Application type. Usually \"native\" for OAuth clients.\n\t * https://openid.net/specs/openid-connect-registration-1_0.html\n\t */\n\tapplication_type?: 'native' | 'web' | string;\n\n\t/**\n\t * OPTIONAL. Additional metadata fields as defined by extensions.\n\t */\n\t[key: string]: unknown;\n}\n\n/**\n * Response from the dynamic client registration endpoint.\n */\nexport interface IAuthorizationDynamicClientRegistrationResponse {\n\t/**\n\t * REQUIRED. The client identifier issued by the authorization server.\n\t */\n\tclient_id: string;\n\n\t/**\n\t * OPTIONAL. The client secret issued by the authorization server.\n\t * Not returned for public clients.\n\t */\n\tclient_secret?: string;\n\n\t/**\n\t * OPTIONAL. Time at which the client secret will expire in seconds since the Unix Epoch.\n\t */\n\tclient_secret_expires_at?: number;\n\n\t/**\n\t * OPTIONAL. Client name as provided during registration.\n\t */\n\tclient_name?: string;\n\n\t/**\n\t * OPTIONAL. Client URI as provided during registration.\n\t */\n\tclient_uri?: string;\n\n\t/**\n\t * OPTIONAL. Array of redirection URIs as provided during registration.\n\t */\n\tredirect_uris?: string[];\n\n\t/**\n\t * OPTIONAL. Array of grant types allowed for the client.\n\t */\n\tgrant_types?: string[];\n\n\t/**\n\t * OPTIONAL. Array of response types allowed for the client.\n\t */\n\tresponse_types?: string[];\n\n\t/**\n\t * OPTIONAL. Type of authentication method used by the client.\n\t */\n\ttoken_endpoint_auth_method?: string;\n}\n\n/**\n * Response from the authorization endpoint.\n * Typically returned as query parameters in a redirect.\n */\nexport interface IAuthorizationAuthorizeResponse {\n\t/**\n\t * REQUIRED. The authorization code generated by the authorization server.\n\t */\n\tcode: string;\n\n\t/**\n\t * REQUIRED. The state value that was sent in the authorization request.\n\t * Used to prevent CSRF attacks.\n\t */\n\tstate: string;\n}\n\n/**\n * Error response from the authorization endpoint.\n */\nexport interface IAuthorizationAuthorizeErrorResponse {\n\t/**\n\t * REQUIRED. Error code as specified in OAuth 2.0.\n\t */\n\terror: string;\n\n\t/**\n\t * OPTIONAL. Human-readable description of the error.\n\t */\n\terror_description?: string;\n\n\t/**\n\t * OPTIONAL. URI to a human-readable web page with more information about the error.\n\t */\n\terror_uri?: string;\n\n\t/**\n\t * REQUIRED. The state value that was sent in the authorization request.\n\t */\n\tstate: string;\n}\n\n/**\n * Response from the token endpoint.\n */\nexport interface IAuthorizationTokenResponse {\n\t/**\n\t * REQUIRED. The access token issued by the authorization server.\n\t */\n\taccess_token: string;\n\n\t/**\n\t * REQUIRED. The type of the token issued. Usually \"Bearer\".\n\t */\n\ttoken_type: string;\n\n\t/**\n\t * RECOMMENDED. The lifetime in seconds of the access token.\n\t */\n\texpires_in?: number;\n\n\t/**\n\t * OPTIONAL. The refresh token, which can be used to obtain new access tokens.\n\t */\n\trefresh_token?: string;\n\n\t/**\n\t * OPTIONAL. The scope of the access token as a space-delimited list of strings.\n\t */\n\tscope?: string;\n\n\t/**\n\t * OPTIONAL. ID Token value associated with the authenticated session for OpenID Connect flows.\n\t */\n\tid_token?: string;\n}\n\n/**\n * Error response from the token endpoint.\n */\nexport interface IAuthorizationTokenErrorResponse {\n\t/**\n\t * REQUIRED. Error code as specified in OAuth 2.0.\n\t */\n\terror: string;\n\n\t/**\n\t * OPTIONAL. Human-readable description of the error.\n\t */\n\terror_description?: string;\n\n\t/**\n\t * OPTIONAL. URI to a human-readable web page with more information about the error.\n\t */\n\terror_uri?: string;\n}\n\n/**\n * Response from the device authorization endpoint as per RFC 8628 section 3.2.\n */\nexport interface IAuthorizationDeviceResponse {\n\t/**\n\t * REQUIRED. The device verification code.\n\t */\n\tdevice_code: string;\n\n\t/**\n\t * REQUIRED. The end-user verification code.\n\t */\n\tuser_code: string;\n\n\t/**\n\t * REQUIRED. The end-user verification URI on the authorization server.\n\t */\n\tverification_uri: string;\n\n\t/**\n\t * OPTIONAL. A verification URI that includes the user_code, designed for non-textual transmission.\n\t */\n\tverification_uri_complete?: string;\n\n\t/**\n\t * REQUIRED. The lifetime in seconds of the device_code and user_code.\n\t */\n\texpires_in: number;\n\n\t/**\n\t * OPTIONAL. The minimum amount of time in seconds that the client should wait between polling requests.\n\t * If no value is provided, clients must use 5 as the default.\n\t */\n\tinterval?: number;\n}\n\n/**\n * Error response from the token endpoint when using device authorization grant.\n * As defined in RFC 8628 section 3.5.\n */\nexport interface IAuthorizationErrorResponse {\n\t/**\n\t * REQUIRED. Error code as specified in OAuth 2.0 or in RFC 8628 section 3.5.\n\t */\n\terror: AuthorizationErrorType | string;\n\n\t/**\n\t * OPTIONAL. Human-readable description of the error.\n\t */\n\terror_description?: string;\n\n\t/**\n\t * OPTIONAL. URI to a human-readable web page with more information about the error.\n\t */\n\terror_uri?: string;\n}\n\n/**\n * Error response from the token endpoint when using device authorization grant.\n * As defined in RFC 8628 section 3.5.\n */\nexport interface IAuthorizationDeviceTokenErrorResponse extends IAuthorizationErrorResponse {\n\t/**\n\t * REQUIRED. Error code as specified in OAuth 2.0 or in RFC 8628 section 3.5.\n\t */\n\terror: AuthorizationErrorType | AuthorizationDeviceCodeErrorType | string;\n}\n\nexport interface IAuthorizationRegistrationErrorResponse {\n\t/**\n\t * REQUIRED. Error code as specified in OAuth 2.0 or Dynamic Client Registration.\n\t */\n\terror: AuthorizationRegistrationErrorType | string;\n\n\t/**\n\t * OPTIONAL. Human-readable description of the error.\n\t */\n\terror_description?: string;\n}\n\nexport interface IAuthorizationJWTClaims {\n\t/**\n\t * REQUIRED. JWT ID. Unique identifier for the token.\n\t */\n\tjti: string;\n\n\t/**\n\t * REQUIRED. Subject. Principal about which the token asserts information.\n\t */\n\tsub: string;\n\n\t/**\n\t * REQUIRED. Issuer. Entity that issued the token.\n\t */\n\tiss: string;\n\n\t/**\n\t * OPTIONAL. Audience. Recipients that the token is intended for.\n\t */\n\taud?: string | string[];\n\n\t/**\n\t * OPTIONAL. Expiration time. Time after which the token is invalid (seconds since Unix epoch).\n\t */\n\texp?: number;\n\n\t/**\n\t * OPTIONAL. Not before time. Time before which the token is not valid (seconds since Unix epoch).\n\t */\n\tnbf?: number;\n\n\t/**\n\t * OPTIONAL. Issued at time when the token was issued (seconds since Unix epoch).\n\t */\n\tiat?: number;\n\n\t/**\n\t * OPTIONAL. Authorized party. The party to which the token was issued.\n\t */\n\tazp?: string;\n\n\t/**\n\t * OPTIONAL. Scope values for which the token is valid.\n\t */\n\tscope?: string;\n\n\t/**\n\t * OPTIONAL. Full name of the user.\n\t */\n\tname?: string;\n\n\t/**\n\t * OPTIONAL. Given or first name of the user.\n\t */\n\tgiven_name?: string;\n\n\t/**\n\t * OPTIONAL. Family name or last name of the user.\n\t */\n\tfamily_name?: string;\n\n\t/**\n\t * OPTIONAL. Middle name of the user.\n\t */\n\tmiddle_name?: string;\n\n\t/**\n\t * OPTIONAL. Preferred username or email the user wishes to be referred to.\n\t */\n\tpreferred_username?: string;\n\n\t/**\n\t * OPTIONAL. Email address of the user.\n\t */\n\temail?: string;\n\n\t/**\n\t * OPTIONAL. True if the user's email has been verified.\n\t */\n\temail_verified?: boolean;\n\n\t/**\n\t * OPTIONAL. User's profile picture URL.\n\t */\n\tpicture?: string;\n\n\t/**\n\t * OPTIONAL. Authentication time. Time when the user authentication occurred.\n\t */\n\tauth_time?: number;\n\n\t/**\n\t * OPTIONAL. Authentication context class reference.\n\t */\n\tacr?: string;\n\n\t/**\n\t * OPTIONAL. Authentication methods references.\n\t */\n\tamr?: string[];\n\n\t/**\n\t * OPTIONAL. Session ID. String identifier for a session.\n\t */\n\tsid?: string;\n\n\t/**\n\t * OPTIONAL. Address component.\n\t */\n\taddress?: {\n\t\tformatted?: string;\n\t\tstreet_address?: string;\n\t\tlocality?: string;\n\t\tregion?: string;\n\t\tpostal_code?: string;\n\t\tcountry?: string;\n\t};\n\n\t/**\n\t * OPTIONAL. Groups that the user belongs to.\n\t */\n\tgroups?: string[];\n\n\t/**\n\t * OPTIONAL. Roles assigned to the user.\n\t */\n\troles?: string[];\n\n\t/**\n\t * OPTIONAL. Handles optional claims that are not explicitly defined in the standard.\n\t */\n\t[key: string]: unknown;\n}\n\n//#endregion\n\n//#region is functions\n\nexport function isAuthorizationProtectedResourceMetadata(obj: unknown): obj is IAuthorizationProtectedResourceMetadata {\n\tif (typeof obj !== 'object' || obj === null) {\n\t\treturn false;\n\t}\n\n\tconst metadata = obj as IAuthorizationProtectedResourceMetadata;\n\tif (!metadata.resource) {\n\t\treturn false;\n\t}\n\tif (metadata.scopes_supported !== undefined && !Array.isArray(metadata.scopes_supported)) {\n\t\treturn false;\n\t}\n\treturn true;\n}\n\nconst urisToCheck: Array<keyof IAuthorizationServerMetadata> = [\n\t'issuer',\n\t'authorization_endpoint',\n\t'token_endpoint',\n\t'registration_endpoint',\n\t'jwks_uri'\n];\nexport function isAuthorizationServerMetadata(obj: unknown): obj is IAuthorizationServerMetadata {\n\tif (typeof obj !== 'object' || obj === null) {\n\t\treturn false;\n\t}\n\tconst metadata = obj as IAuthorizationServerMetadata;\n\tif (!metadata.issuer) {\n\t\tthrow new Error('Authorization server metadata must have an issuer');\n\t}\n\n\tfor (const uri of urisToCheck) {\n\t\tif (!metadata[uri]) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (typeof metadata[uri] !== 'string') {\n\t\t\tthrow new Error(`Authorization server metadata '${uri}' must be a string`);\n\t\t}\n\t\tif (!metadata[uri].startsWith('https://') && !metadata[uri].startsWith('http://')) {\n\t\t\tthrow new Error(`Authorization server metadata '${uri}' must start with http:// or https://`);\n\t\t}\n\t}\n\treturn true;\n}\n\nexport function isAuthorizationDynamicClientRegistrationResponse(obj: unknown): obj is IAuthorizationDynamicClientRegistrationResponse {\n\tif (typeof obj !== 'object' || obj === null) {\n\t\treturn false;\n\t}\n\tconst response = obj as IAuthorizationDynamicClientRegistrationResponse;\n\treturn response.client_id !== undefined;\n}\n\nexport function isAuthorizationAuthorizeResponse(obj: unknown): obj is IAuthorizationAuthorizeResponse {\n\tif (typeof obj !== 'object' || obj === null) {\n\t\treturn false;\n\t}\n\tconst response = obj as IAuthorizationAuthorizeResponse;\n\treturn response.code !== undefined && response.state !== undefined;\n}\n\nexport function isAuthorizationTokenResponse(obj: unknown): obj is IAuthorizationTokenResponse {\n\tif (typeof obj !== 'object' || obj === null) {\n\t\treturn false;\n\t}\n\tconst response = obj as IAuthorizationTokenResponse;\n\treturn response.access_token !== undefined && response.token_type !== undefined;\n}\n\nexport function isAuthorizationDeviceResponse(obj: unknown): obj is IAuthorizationDeviceResponse {\n\tif (typeof obj !== 'object' || obj === null) {\n\t\treturn false;\n\t}\n\tconst response = obj as IAuthorizationDeviceResponse;\n\treturn response.device_code !== undefined && response.user_code !== undefined && response.verification_uri !== undefined && response.expires_in !== undefined;\n}\n\nexport function isAuthorizationErrorResponse(obj: unknown): obj is IAuthorizationErrorResponse {\n\tif (typeof obj !== 'object' || obj === null) {\n\t\treturn false;\n\t}\n\tconst response = obj as IAuthorizationErrorResponse;\n\treturn response.error !== undefined;\n}\n\nexport function isAuthorizationRegistrationErrorResponse(obj: unknown): obj is IAuthorizationRegistrationErrorResponse {\n\tif (typeof obj !== 'object' || obj === null) {\n\t\treturn false;\n\t}\n\tconst response = obj as IAuthorizationRegistrationErrorResponse;\n\treturn response.error !== undefined;\n}\n\n//#endregion\n\nexport function getDefaultMetadataForUrl(authorizationServer: URL): IAuthorizationServerMetadata {\n\treturn {\n\t\tissuer: authorizationServer.toString(),\n\t\tauthorization_endpoint: new URL('/authorize', authorizationServer).toString(),\n\t\ttoken_endpoint: new URL('/token', authorizationServer).toString(),\n\t\tregistration_endpoint: new URL('/register', authorizationServer).toString(),\n\t\t// Default values for Dynamic OpenID Providers\n\t\t// https://openid.net/specs/openid-connect-discovery-1_0.html\n\t\tresponse_types_supported: ['code', 'id_token', 'id_token token'],\n\t};\n}\n\n/**\n * The grant types that we support\n */\nconst grantTypesSupported = ['authorization_code', 'refresh_token', 'urn:ietf:params:oauth:grant-type:device_code'];\n\n/**\n * Default port for the authorization flow. We try to use this port so that\n * the redirect URI does not change when running on localhost. This is useful\n * for servers that only allow exact matches on the redirect URI. The spec\n * says that the port should not matter, but some servers do not follow\n * the spec and require an exact match.\n */\nexport const DEFAULT_AUTH_FLOW_PORT = 33418;\nexport async function fetchDynamicRegistration(serverMetadata: IAuthorizationServerMetadata, clientName: string, scopes?: string[]): Promise<IAuthorizationDynamicClientRegistrationResponse> {\n\tif (!serverMetadata.registration_endpoint) {\n\t\tthrow new Error('Server does not support dynamic registration');\n\t}\n\n\tconst requestBody: IAuthorizationDynamicClientRegistrationRequest = {\n\t\tclient_name: clientName,\n\t\tclient_uri: 'https://code.visualstudio.com',\n\t\tgrant_types: serverMetadata.grant_types_supported\n\t\t\t? serverMetadata.grant_types_supported.filter(gt => grantTypesSupported.includes(gt))\n\t\t\t: grantTypesSupported,\n\t\tresponse_types: ['code'],\n\t\tredirect_uris: [\n\t\t\t'https://insiders.vscode.dev/redirect',\n\t\t\t'https://vscode.dev/redirect',\n\t\t\t'http://127.0.0.1/',\n\t\t\t// Added these for any server that might do\n\t\t\t// only exact match on the redirect URI even\n\t\t\t// though the spec says it should not care\n\t\t\t// about the port.\n\t\t\t`http://127.0.0.1:${DEFAULT_AUTH_FLOW_PORT}/`\n\t\t],\n\t\tscope: scopes?.join(AUTH_SCOPE_SEPARATOR),\n\t\ttoken_endpoint_auth_method: 'none',\n\t\tapplication_type: 'native'\n\t};\n\n\tconst response = await fetch(serverMetadata.registration_endpoint, {\n\t\tmethod: 'POST',\n\t\theaders: {\n\t\t\t'Content-Type': 'application/json'\n\t\t},\n\t\tbody: JSON.stringify(requestBody)\n\t});\n\n\tif (!response.ok) {\n\t\tconst result = await response.text();\n\t\tlet errorDetails: string = result;\n\n\t\ttry {\n\t\t\tconst errorResponse = JSON.parse(result);\n\t\t\tif (isAuthorizationRegistrationErrorResponse(errorResponse)) {\n\t\t\t\terrorDetails = `${errorResponse.error}${errorResponse.error_description ? `: ${errorResponse.error_description}` : ''}`;\n\t\t\t}\n\t\t} catch {\n\t\t\t// JSON parsing failed, use raw text\n\t\t}\n\n\t\tthrow new Error(`Registration to ${serverMetadata.registration_endpoint} failed: ${errorDetails}`);\n\t}\n\n\tconst registration = await response.json();\n\tif (isAuthorizationDynamicClientRegistrationResponse(registration)) {\n\t\treturn registration;\n\t}\n\tthrow new Error(`Invalid authorization dynamic client registration response: ${JSON.stringify(registration)}`);\n}\n\nexport interface IAuthenticationChallenge {\n\tscheme: string;\n\tparams: Record<string, string>;\n}\n\nexport function parseWWWAuthenticateHeader(wwwAuthenticateHeaderValue: string): IAuthenticationChallenge[] {\n\tconst challenges: IAuthenticationChallenge[] = [];\n\n\t// According to RFC 7235, multiple challenges are separated by commas\n\t// But parameters within a challenge can also be separated by commas\n\t// We need to identify scheme names to know where challenges start\n\n\t// First, split by commas while respecting quoted strings\n\tconst tokens: string[] = [];\n\tlet current = '';\n\tlet inQuotes = false;\n\n\tfor (let i = 0; i < wwwAuthenticateHeaderValue.length; i++) {\n\t\tconst char = wwwAuthenticateHeaderValue[i];\n\n\t\tif (char === '\"') {\n\t\t\tinQuotes = !inQuotes;\n\t\t\tcurrent += char;\n\t\t} else if (char === ',' && !inQuotes) {\n\t\t\tif (current.trim()) {\n\t\t\t\ttokens.push(current.trim());\n\t\t\t}\n\t\t\tcurrent = '';\n\t\t} else {\n\t\t\tcurrent += char;\n\t\t}\n\t}\n\n\tif (current.trim()) {\n\t\ttokens.push(current.trim());\n\t}\n\n\t// Now process tokens to identify challenges\n\t// A challenge starts with a scheme name (a token that doesn't contain '=' and is followed by parameters or is standalone)\n\tlet currentChallenge: { scheme: string; params: Record<string, string> } | undefined;\n\n\tfor (const token of tokens) {\n\t\tconst hasEquals = token.includes('=');\n\n\t\tif (!hasEquals) {\n\t\t\t// This token doesn't have '=', so it's likely a scheme name\n\t\t\tif (currentChallenge) {\n\t\t\t\tchallenges.push(currentChallenge);\n\t\t\t}\n\t\t\tcurrentChallenge = { scheme: token.trim(), params: {} };\n\t\t} else {\n\t\t\t// This token has '=', it could be:\n\t\t\t// 1. A parameter for the current challenge\n\t\t\t// 2. A new challenge that starts with \"Scheme param=value\"\n\n\t\t\tconst spaceIndex = token.indexOf(' ');\n\t\t\tif (spaceIndex > 0) {\n\t\t\t\tconst beforeSpace = token.substring(0, spaceIndex);\n\t\t\t\tconst afterSpace = token.substring(spaceIndex + 1);\n\n\t\t\t\t// Check if what's before the space looks like a scheme name (no '=')\n\t\t\t\tif (!beforeSpace.includes('=') && afterSpace.includes('=')) {\n\t\t\t\t\t// This is a new challenge starting with \"Scheme param=value\"\n\t\t\t\t\tif (currentChallenge) {\n\t\t\t\t\t\tchallenges.push(currentChallenge);\n\t\t\t\t\t}\n\t\t\t\t\tcurrentChallenge = { scheme: beforeSpace.trim(), params: {} };\n\n\t\t\t\t\t// Parse the parameter part\n\t\t\t\t\tconst equalIndex = afterSpace.indexOf('=');\n\t\t\t\t\tif (equalIndex > 0) {\n\t\t\t\t\t\tconst key = afterSpace.substring(0, equalIndex).trim();\n\t\t\t\t\t\tconst value = afterSpace.substring(equalIndex + 1).trim().replace(/^\"|\"$/g, '');\n\t\t\t\t\t\tif (key && value !== undefined) {\n\t\t\t\t\t\t\tcurrentChallenge.params[key] = value;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// This is a parameter for the current challenge\n\t\t\tif (currentChallenge) {\n\t\t\t\tconst equalIndex = token.indexOf('=');\n\t\t\t\tif (equalIndex > 0) {\n\t\t\t\t\tconst key = token.substring(0, equalIndex).trim();\n\t\t\t\t\tconst value = token.substring(equalIndex + 1).trim().replace(/^\"|\"$/g, '');\n\t\t\t\t\tif (key && value !== undefined) {\n\t\t\t\t\t\tcurrentChallenge.params[key] = value;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Don't forget the last challenge\n\tif (currentChallenge) {\n\t\tchallenges.push(currentChallenge);\n\t}\n\n\treturn challenges;\n}\n\nexport function getClaimsFromJWT(token: string): IAuthorizationJWTClaims {\n\tconst parts = token.split('.');\n\tif (parts.length !== 3) {\n\t\tthrow new Error('Invalid JWT token format: token must have three parts separated by dots');\n\t}\n\n\tconst [header, payload, _signature] = parts;\n\n\ttry {\n\t\tconst decodedHeader = JSON.parse(decodeBase64(header).toString());\n\t\tif (typeof decodedHeader !== 'object') {\n\t\t\tthrow new Error('Invalid JWT token format: header is not a JSON object');\n\t\t}\n\n\t\tconst decodedPayload = JSON.parse(decodeBase64(payload).toString());\n\t\tif (typeof decodedPayload !== 'object') {\n\t\t\tthrow new Error('Invalid JWT token format: payload is not a JSON object');\n\t\t}\n\n\t\treturn decodedPayload;\n\t} catch (e) {\n\t\tif (e instanceof Error) {\n\t\t\tthrow new Error(`Failed to parse JWT token: ${e.message}`);\n\t\t}\n\t\tthrow new Error('Failed to parse JWT token');\n\t}\n}\n\n/**\n * Checks if two scope lists are equivalent, regardless of order.\n * This is useful for comparing OAuth scopes where the order should not matter.\n *\n * @param scopes1 First list of scopes to compare (can be undefined)\n * @param scopes2 Second list of scopes to compare (can be undefined)\n * @returns true if the scope lists contain the same scopes (order-independent), false otherwise\n *\n * @example\n * ```typescript\n * scopesMatch(['read', 'write'], ['write', 'read']) // Returns: true\n * scopesMatch(['read'], ['write']) // Returns: false\n * scopesMatch(undefined, undefined) // Returns: true\n * scopesMatch(['read'], undefined) // Returns: false\n * ```\n */\nexport function scopesMatch(scopes1: readonly string[] | undefined, scopes2: readonly string[] | undefined): boolean {\n\tif (scopes1 === scopes2) {\n\t\treturn true;\n\t}\n\tif (!scopes1 || !scopes2) {\n\t\treturn false;\n\t}\n\tif (scopes1.length !== scopes2.length) {\n\t\treturn false;\n\t}\n\n\t// Sort both arrays for comparison to handle different orderings\n\tconst sortedScopes1 = [...scopes1].sort();\n\tconst sortedScopes2 = [...scopes2].sort();\n\n\treturn sortedScopes1.every((scope, index) => scope === sortedScopes2[index]);\n}\n\ninterface CommonResponse {\n\tstatus: number;\n\tstatusText: string;\n\tjson(): Promise<any>;\n\ttext(): Promise<string>;\n}\n\ninterface IFetcher {\n\t(input: string, init: { method: string; headers: Record<string, string> }): Promise<CommonResponse>;\n}\n\nexport interface IFetchResourceMetadataOptions {\n\t/**\n\t * Headers to include only when the resource metadata URL has the same origin as the target resource\n\t */\n\tsameOriginHeaders?: Record<string, string>;\n\t/**\n\t * Optional custom fetch implementation (defaults to global fetch)\n\t */\n\tfetch?: IFetcher;\n}\n\n/**\n * Fetches and validates OAuth 2.0 protected resource metadata from the given URL.\n *\n * @param targetResource The target resource URL to compare origins with (e.g., the MCP server URL)\n * @param resourceMetadataUrl Optional URL to fetch the resource metadata from. If not provided, will try well-known URIs.\n * @param options Configuration options for the fetch operation\n * @returns Promise that resolves to the validated resource metadata\n * @throws Error if the fetch fails, returns non-200 status, or the response is invalid\n */\nexport async function fetchResourceMetadata(\n\ttargetResource: string,\n\tresourceMetadataUrl: string | undefined,\n\toptions: IFetchResourceMetadataOptions = {}\n): Promise<IAuthorizationProtectedResourceMetadata> {\n\tconst {\n\t\tsameOriginHeaders = {},\n\t\tfetch: fetchImpl = fetch\n\t} = options;\n\n\tconst targetResourceUrlObj = new URL(targetResource);\n\n\t// If no resourceMetadataUrl is provided, try well-known URIs as per RFC 9728\n\tlet urlsToTry: string[];\n\tif (!resourceMetadataUrl) {\n\t\t// Try in order: 1) with path appended, 2) at root\n\t\tconst pathComponent = targetResourceUrlObj.pathname === '/' ? undefined : targetResourceUrlObj.pathname;\n\t\tconst rootUrl = `${targetResourceUrlObj.origin}${AUTH_PROTECTED_RESOURCE_METADATA_DISCOVERY_PATH}`;\n\t\tif (pathComponent) {\n\t\t\t// Only try both URLs if we have a path component\n\t\t\turlsToTry = [\n\t\t\t\t`${rootUrl}${pathComponent}`,\n\t\t\t\trootUrl\n\t\t\t];\n\t\t} else {\n\t\t\t// If target is already at root, only try the root URL once\n\t\t\turlsToTry = [rootUrl];\n\t\t}\n\t} else {\n\t\turlsToTry = [resourceMetadataUrl];\n\t}\n\n\tconst errors: Error[] = [];\n\tfor (const urlToTry of urlsToTry) {\n\t\ttry {\n\t\t\t// Determine if we should include same-origin headers\n\t\t\tlet headers: Record<string, string> = {\n\t\t\t\t'Accept': 'application/json'\n\t\t\t};\n\n\t\t\tconst resourceMetadataUrlObj = new URL(urlToTry);\n\t\t\tif (resourceMetadataUrlObj.origin === targetResourceUrlObj.origin) {\n\t\t\t\theaders = {\n\t\t\t\t\t...headers,\n\t\t\t\t\t...sameOriginHeaders\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tconst response = await fetchImpl(urlToTry, { method: 'GET', headers });\n\t\t\tif (response.status !== 200) {\n\t\t\t\tlet errorText: string;\n\t\t\t\ttry {\n\t\t\t\t\terrorText = await response.text();\n\t\t\t\t} catch {\n\t\t\t\t\terrorText = response.statusText;\n\t\t\t\t}\n\t\t\t\terrors.push(new Error(`Failed to fetch resource metadata from ${urlToTry}: ${response.status} ${errorText}`));\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst body = await response.json();\n\t\t\tif (isAuthorizationProtectedResourceMetadata(body)) {\n\t\t\t\t// Use URL constructor for normalization - it handles hostname case and trailing slashes\n\t\t\t\tconst prmValue = new URL(body.resource).toString();\n\t\t\t\tconst targetValue = targetResourceUrlObj.toString();\n\t\t\t\tif (prmValue !== targetValue) {\n\t\t\t\t\tthrow new Error(`Protected Resource Metadata resource property value \"${prmValue}\" (length: ${prmValue.length}) does not match target server url \"${targetValue}\" (length: ${targetValue.length}). These MUST match to follow OAuth spec https://datatracker.ietf.org/doc/html/rfc9728#PRConfigurationValidation`);\n\t\t\t\t}\n\t\t\t\treturn body;\n\t\t\t} else {\n\t\t\t\terrors.push(new Error(`Invalid resource metadata from ${urlToTry}. Expected to follow shape of https://datatracker.ietf.org/doc/html/rfc9728#name-protected-resource-metadata (Hints: is scopes_supported an array? Is resource a string?). Current payload: ${JSON.stringify(body)}`));\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t} catch (e) {\n\t\t\terrors.push(e instanceof Error ? e : new Error(String(e)));\n\t\t\tcontinue;\n\t\t}\n\t}\n\t// If we've tried all URLs and none worked, throw the error(s)\n\tif (errors.length === 1) {\n\t\tthrow errors[0];\n\t} else {\n\t\tthrow new AggregateError(errors, 'Failed to fetch resource metadata from all attempted URLs');\n\t}\n}\n\nexport interface IFetchAuthorizationServerMetadataOptions {\n\t/**\n\t * Headers to include in the requests\n\t */\n\tadditionalHeaders?: Record<string, string>;\n\t/**\n\t * Optional custom fetch implementation (defaults to global fetch)\n\t */\n\tfetch?: IFetcher;\n}\n\n/** Helper to try parsing the response as authorization server metadata */\nasync function tryParseAuthServerMetadata(response: CommonResponse): Promise<IAuthorizationServerMetadata | undefined> {\n\tif (response.status !== 200) {\n\t\treturn undefined;\n\t}\n\ttry {\n\t\tconst body = await response.json();\n\t\tif (isAuthorizationServerMetadata(body)) {\n\t\t\treturn body;\n\t\t}\n\t} catch {\n\t\t// Failed to parse as JSON or not valid metadata\n\t}\n\treturn undefined;\n}\n\n/** Helper to get error text from response */\nasync function getErrText(res: CommonResponse): Promise<string> {\n\ttry {\n\t\treturn await res.text();\n\t} catch {\n\t\treturn res.statusText;\n\t}\n}\n\n/**\n * Fetches and validates OAuth 2.0 authorization server metadata from the given authorization server URL.\n *\n * This function tries multiple discovery endpoints in the following order:\n * 1. OAuth 2.0 Authorization Server Metadata with path insertion (RFC 8414)\n * 2. OpenID Connect Discovery with path insertion\n * 3. OpenID Connect Discovery with path addition\n *\n * Path insertion: For issuer URLs with path components (e.g., https://example.com/tenant),\n * the well-known path is inserted after the origin and before the path:\n * https://example.com/.well-known/oauth-authorization-server/tenant\n *\n * Path addition: The well-known path is simply appended to the existing path:\n * https://example.com/tenant/.well-known/openid-configuration\n *\n * @param authorizationServer The authorization server URL (issuer identifier)\n * @param options Configuration options for the fetch operation\n * @returns Promise that resolves to the validated authorization server metadata\n * @throws Error if all discovery attempts fail or the response is invalid\n *\n * @see https://datatracker.ietf.org/doc/html/rfc8414#section-3\n */\nexport async function fetchAuthorizationServerMetadata(\n\tauthorizationServer: string,\n\toptions: IFetchAuthorizationServerMetadataOptions = {}\n): Promise<IAuthorizationServerMetadata> {\n\tconst {\n\t\tadditionalHeaders = {},\n\t\tfetch: fetchImpl = fetch\n\t} = options;\n\n\tconst authorizationServerUrl = new URL(authorizationServer);\n\tconst extraPath = authorizationServerUrl.pathname === '/' ? '' : authorizationServerUrl.pathname;\n\n\tconst doFetch = async (url: string): Promise<{ metadata: IAuthorizationServerMetadata | undefined; rawResponse: CommonResponse }> => {\n\t\tconst rawResponse = await fetchImpl(url, {\n\t\t\tmethod: 'GET',\n\t\t\theaders: {\n\t\t\t\t...additionalHeaders,\n\t\t\t\t'Accept': 'application/json'\n\t\t\t}\n\t\t});\n\t\tconst metadata = await tryParseAuthServerMetadata(rawResponse);\n\t\treturn { metadata, rawResponse };\n\t};\n\n\t// For the oauth server metadata discovery path, we _INSERT_\n\t// the well known path after the origin and before the path.\n\t// https://datatracker.ietf.org/doc/html/rfc8414#section-3\n\tconst pathToFetch = new URL(AUTH_SERVER_METADATA_DISCOVERY_PATH, authorizationServer).toString() + extraPath;\n\tlet result = await doFetch(pathToFetch);\n\tif (result.metadata) {\n\t\treturn result.metadata;\n\t}\n\n\t// Try fetching the OpenID Connect Discovery with path insertion.\n\t// For issuer URLs with path components, this inserts the well-known path\n\t// after the origin and before the path.\n\tconst openidPathInsertionUrl = new URL(OPENID_CONNECT_DISCOVERY_PATH, authorizationServer).toString() + extraPath;\n\tresult = await doFetch(openidPathInsertionUrl);\n\tif (result.metadata) {\n\t\treturn result.metadata;\n\t}\n\n\t// Try fetching the other discovery URL. For the openid metadata discovery\n\t// path, we _ADD_ the well known path after the existing path.\n\t// https://datatracker.ietf.org/doc/html/rfc8414#section-3\n\tconst openidPathAdditionUrl = authorizationServer.endsWith('/')\n\t\t? authorizationServer + OPENID_CONNECT_DISCOVERY_PATH.substring(1) // Remove leading slash if authServer ends with slash\n\t\t: authorizationServer + OPENID_CONNECT_DISCOVERY_PATH;\n\tresult = await doFetch(openidPathAdditionUrl);\n\tif (result.metadata) {\n\t\treturn result.metadata;\n\t}\n\n\tthrow new Error(`Failed to fetch authorization server metadata: ${result.rawResponse.status} ${await getErrText(result.rawResponse)}`);\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}