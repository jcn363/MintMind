{"version":3,"names":["toDisposable","createDecorator","IRemoteSocketFactoryService","cov_18019uq7qb","s","RemoteSocketFactoryService","factories","register","type","factory","f","push","idx","indexOf","b","splice","getSocketFactory","messagePassing","find","supports","connect","connectTo","path","query","debugLabel","socketFactory","Error"],"sources":["/home/user/Desktop/MintMind/src/vs/platform/remote/common/remoteSocketFactoryService.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IDisposable, toDisposable } from '../../../base/common/lifecycle.js';\nimport { ISocket } from '../../../base/parts/ipc/common/ipc.net.js';\nimport { createDecorator } from '../../instantiation/common/instantiation.js';\nimport { RemoteConnectionOfType, RemoteConnectionType, RemoteConnection } from './remoteAuthorityResolver.js';\n\nexport const IRemoteSocketFactoryService = createDecorator<IRemoteSocketFactoryService>('remoteSocketFactoryService');\n\nexport interface IRemoteSocketFactoryService {\n\treadonly _serviceBrand: undefined;\n\n\t/**\n\t * Register a socket factory for the given message passing type\n\t * @param type passing type to register for\n\t * @param factory function that returns the socket factory, or undefined if\n\t * it can't handle the data.\n\t */\n\tregister<T extends RemoteConnectionType>(type: T, factory: ISocketFactory<T>): IDisposable;\n\n\tconnect(connectTo: RemoteConnection, path: string, query: string, debugLabel: string): Promise<ISocket>;\n}\n\nexport interface ISocketFactory<T extends RemoteConnectionType> {\n\tsupports(connectTo: RemoteConnectionOfType<T>): boolean;\n\tconnect(connectTo: RemoteConnectionOfType<T>, path: string, query: string, debugLabel: string): Promise<ISocket>;\n}\n\nexport class RemoteSocketFactoryService implements IRemoteSocketFactoryService {\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate readonly factories: { [T in RemoteConnectionType]?: ISocketFactory<T>[] } = {};\n\n\tpublic register<T extends RemoteConnectionType>(type: T, factory: ISocketFactory<T>): IDisposable {\n\t\tthis.factories[type] ??= [];\n\t\tthis.factories[type]!.push(factory);\n\t\treturn toDisposable(() => {\n\t\t\tconst idx = this.factories[type]?.indexOf(factory);\n\t\t\tif (typeof idx === 'number' && idx >= 0) {\n\t\t\t\tthis.factories[type]?.splice(idx, 1);\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate getSocketFactory<T extends RemoteConnectionType>(messagePassing: RemoteConnectionOfType<T>): ISocketFactory<T> | undefined {\n\t\tconst factories = (this.factories[messagePassing.type] || []);\n\t\treturn factories.find(factory => factory.supports(messagePassing));\n\t}\n\n\tpublic connect(connectTo: RemoteConnection, path: string, query: string, debugLabel: string): Promise<ISocket> {\n\t\tconst socketFactory = this.getSocketFactory(connectTo);\n\t\tif (!socketFactory) {\n\t\t\tthrow new Error(`No socket factory found for ${connectTo}`);\n\t\t}\n\t\treturn socketFactory.connect(connectTo, path, query, debugLabel);\n\t}\n}\n"],"mappings":"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","ignoreList":[]}