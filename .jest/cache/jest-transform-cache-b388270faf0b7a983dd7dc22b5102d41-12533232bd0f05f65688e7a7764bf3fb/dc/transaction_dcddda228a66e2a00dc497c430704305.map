{"version":3,"names":["cov_cqkqum20d","actualCoverage","handleBugIndicatingErrorRecovery","getFunctionName","getLogger","transaction","fn","getDebugName","f","tx","s","TransactionImpl","finish","_globalTransaction","undefined","globalTransaction","b","asyncTransaction","subtransaction","_fn","_getDebugName","_updatingObservers","constructor","handleBeginTransaction","updateObserver","observer","observable","push","beginUpdate","updatingObservers","i","length","endUpdate","handleEndTransaction","debugGetUpdatingObservers"],"sources":["/home/user/Desktop/MintMind/src/vs/base/common/observableInternal/transaction.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { handleBugIndicatingErrorRecovery, IObservable, IObserver, ITransaction } from './base.js';\nimport { getFunctionName } from './debugName.js';\nimport { getLogger } from './logging/logging.js';\n\n/**\n * Starts a transaction in which many observables can be changed at once.\n * {@link fn} should start with a JS Doc using `@description` to give the transaction a debug name.\n * Reaction run on demand or when the transaction ends.\n */\n\nexport function transaction(fn: (tx: ITransaction) => void, getDebugName?: () => string): void {\n\tconst tx = new TransactionImpl(fn, getDebugName);\n\ttry {\n\t\tfn(tx);\n\t} finally {\n\t\ttx.finish();\n\t}\n}\nlet _globalTransaction: ITransaction | undefined = undefined;\n\nexport function globalTransaction(fn: (tx: ITransaction) => void) {\n\tif (_globalTransaction) {\n\t\tfn(_globalTransaction);\n\t} else {\n\t\tconst tx = new TransactionImpl(fn, undefined);\n\t\t_globalTransaction = tx;\n\t\ttry {\n\t\t\tfn(tx);\n\t\t} finally {\n\t\t\ttx.finish(); // During finish, more actions might be added to the transaction.\n\n\t\t\t// Which is why we only clear the global transaction after finish.\n\t\t\t_globalTransaction = undefined;\n\t\t}\n\t}\n}\n/** @deprecated */\n\nexport async function asyncTransaction(fn: (tx: ITransaction) => Promise<void>, getDebugName?: () => string): Promise<void> {\n\tconst tx = new TransactionImpl(fn, getDebugName);\n\ttry {\n\t\tawait fn(tx);\n\t} finally {\n\t\ttx.finish();\n\t}\n}\n/**\n * Allows to chain transactions.\n */\n\nexport function subtransaction(tx: ITransaction | undefined, fn: (tx: ITransaction) => void, getDebugName?: () => string): void {\n\tif (!tx) {\n\t\ttransaction(fn, getDebugName);\n\t} else {\n\t\tfn(tx);\n\t}\n} export class TransactionImpl implements ITransaction {\n\tprivate _updatingObservers: { observer: IObserver; observable: IObservable<any> }[] | null = [];\n\n\tconstructor(public readonly _fn: Function, private readonly _getDebugName?: () => string) {\n\t\tgetLogger()?.handleBeginTransaction(this);\n\t}\n\n\tpublic getDebugName(): string | undefined {\n\t\tif (this._getDebugName) {\n\t\t\treturn this._getDebugName();\n\t\t}\n\t\treturn getFunctionName(this._fn);\n\t}\n\n\tpublic updateObserver(observer: IObserver, observable: IObservable<any>): void {\n\t\tif (!this._updatingObservers) {\n\t\t\t// This happens when a transaction is used in a callback or async function.\n\t\t\t// If an async transaction is used, make sure the promise awaits all users of the transaction (e.g. no race).\n\t\t\thandleBugIndicatingErrorRecovery('Transaction already finished!');\n\t\t\t// Error recovery\n\t\t\ttransaction(tx => {\n\t\t\t\ttx.updateObserver(observer, observable);\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\t// When this gets called while finish is active, they will still get considered\n\t\tthis._updatingObservers.push({ observer, observable });\n\t\tobserver.beginUpdate(observable);\n\t}\n\n\tpublic finish(): void {\n\t\tconst updatingObservers = this._updatingObservers;\n\t\tif (!updatingObservers) {\n\t\t\thandleBugIndicatingErrorRecovery('transaction.finish() has already been called!');\n\t\t\treturn;\n\t\t}\n\n\t\tfor (let i = 0; i < updatingObservers.length; i++) {\n\t\t\tconst { observer, observable } = updatingObservers[i];\n\t\t\tobserver.endUpdate(observable);\n\t\t}\n\t\t// Prevent anyone from updating observers from now on.\n\t\tthis._updatingObservers = null;\n\t\tgetLogger()?.handleEndTransaction(this);\n\t}\n\n\tpublic debugGetUpdatingObservers() {\n\t\treturn this._updatingObservers;\n\t}\n}\n\n"],"mappings":"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","ignoreList":[]}