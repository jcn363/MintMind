{"version":3,"names":["CancellationTokenSource","toDisposable","derived","ObservablePromise","compare","isObject","createDecorator","isChatContextPickerPickItem","item","cov_1tqrzw2xdr","f","s","b","asAttachment","picksWithPromiseFn","fn","query","token","promise","reader","queryValue","read","cts","store","add","dispose","map","value","result","promiseResult","picks","data","busy","undefined","IChatContextPickService","ChatContextPickService","_picks","items","registerChatContextItem","pick","push","sort","a","valueA","ordinal","valueB","label","index","indexOf","splice"],"sources":["/home/user/Desktop/MintMind/src/vs/workbench/contrib/chat/browser/chatContextPickService.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { CancellationToken, CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { IDisposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { derived, IObservable, ObservablePromise } from '../../../../base/common/observable.js';\nimport { compare } from '../../../../base/common/strings.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { isObject } from '../../../../base/common/types.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IQuickItem, IQuickPickSeparator } from '../../../../platform/quickinput/common/quickInput.js';\nimport { IChatRequestVariableEntry } from '../common/chatVariableEntries.js';\nimport { IChatWidget } from './chat.js';\n\n\nexport interface IChatContextPickerPickItem extends Partial<IQuickItem> {\n\tlabel: string;\n\ticonClass?: string;\n\ticonClasses?: readonly string[];\n\tdescription?: string;\n\tdetail?: string;\n\tdisabled?: boolean;\n\tasAttachment(): ChatContextPickAttachment | Promise<ChatContextPickAttachment>;\n}\n\nexport type ChatContextPickAttachment = IChatRequestVariableEntry | 'noop';\n\nexport function isChatContextPickerPickItem(item: unknown): item is IChatContextPickerPickItem {\n\treturn isObject(item) && typeof (item as IChatContextPickerPickItem).asAttachment === 'function';\n}\n\ninterface IChatContextItem {\n\treadonly label: string;\n\treadonly icon: ThemeIcon;\n\treadonly commandId?: string;\n\treadonly ordinal?: number;\n\tisEnabled?(widget: IChatWidget): Promise<boolean> | boolean;\n}\n\nexport interface IChatContextValueItem extends IChatContextItem {\n\treadonly type: 'valuePick';\n\n\tasAttachment(widget: IChatWidget): Promise<IChatRequestVariableEntry | IChatRequestVariableEntry[] | undefined>;\n}\n\nexport type ChatContextPick = IChatContextPickerPickItem | IQuickPickSeparator;\n\nexport interface IChatContextPicker {\n\treadonly placeholder: string;\n\t/**\n\t * Picks that should either be:\n\t * - A promise that resolves to the picked items\n\t * - A function that maps input query into items to display.\n\t */\n\treadonly picks: Promise<ChatContextPick[]> | ((query: IObservable<string>, token: CancellationToken) => IObservable<{ busy: boolean; picks: ChatContextPick[] }>);\n\n\t/** Return true to cancel the default behavior */\n\treadonly goBack?: () => boolean;\n\n\treadonly configure?: {\n\t\tlabel: string;\n\t\tcommandId: string;\n\t};\n\n\treadonly dispose?: () => void;\n}\n\nexport interface IChatContextPickerItem extends IChatContextItem {\n\treadonly type: 'pickerPick';\n\n\tasPicker(widget: IChatWidget): IChatContextPicker;\n}\n\n/**\n * Helper for use in {@IChatContextPickerItem} that wraps a simple query->promise\n * function into the requisite observable.\n */\nexport function picksWithPromiseFn(fn: (query: string, token: CancellationToken) => Promise<ChatContextPick[]>): (query: IObservable<string>, token: CancellationToken) => IObservable<{ busy: boolean; picks: ChatContextPick[] }> {\n\treturn (query, token) => {\n\t\tconst promise = derived(reader => {\n\t\t\tconst queryValue = query.read(reader);\n\t\t\tconst cts = new CancellationTokenSource(token);\n\t\t\treader.store.add(toDisposable(() => cts.dispose(true)));\n\t\t\treturn new ObservablePromise(fn(queryValue, cts.token));\n\t\t});\n\n\t\treturn promise.map((value, reader) => {\n\t\t\tconst result = value.promiseResult.read(reader);\n\t\t\treturn { picks: result?.data || [], busy: result === undefined };\n\t\t});\n\t};\n}\n\nexport interface IChatContextPickService {\n\t_serviceBrand: undefined;\n\n\titems: Iterable<IChatContextValueItem | IChatContextPickerItem>;\n\n\t/**\n\t * Register a value or  picker to the \"Add Context\" flow. A value directly resolved to a\n\t * chat attachment and a picker first shows a list of items to pick from and then\n\t * resolves the selected item to a chat attachment.\n\t */\n\tregisterChatContextItem(item: IChatContextValueItem | IChatContextPickerItem): IDisposable;\n}\n\nexport const IChatContextPickService = createDecorator<IChatContextPickService>('IContextPickService');\n\nexport class ChatContextPickService implements IChatContextPickService {\n\n\tdeclare _serviceBrand: undefined;\n\n\tprivate readonly _picks: IChatContextValueItem[] = [];\n\n\treadonly items: Iterable<IChatContextValueItem> = this._picks;\n\n\tregisterChatContextItem(pick: IChatContextValueItem): IDisposable {\n\t\tthis._picks.push(pick);\n\n\t\tthis._picks.sort((a, b) => {\n\t\t\tconst valueA = a.ordinal ?? 0;\n\t\t\tconst valueB = b.ordinal ?? 0;\n\t\t\tif (valueA === valueB) {\n\t\t\t\treturn compare(a.label, b.label);\n\t\t\t} else if (valueA < valueB) {\n\t\t\t\treturn 1;\n\t\t\t} else {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t});\n\n\t\treturn toDisposable(() => {\n\t\t\tconst index = this._picks.indexOf(pick);\n\t\t\tif (index >= 0) {\n\t\t\t\tthis._picks.splice(index, 1);\n\t\t\t}\n\t\t});\n\t}\n}\n"],"mappings":"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","ignoreList":[]}