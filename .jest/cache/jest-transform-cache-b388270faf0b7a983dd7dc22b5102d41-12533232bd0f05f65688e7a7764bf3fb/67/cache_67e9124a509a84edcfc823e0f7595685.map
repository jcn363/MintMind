{"version":3,"names":["cov_1v80hvpimn","actualCoverage","CancellationTokenSource","Cache","task","result","s","constructor","f","get","b","cts","promise","token","dispose","cancel","identity","t","LRUCachedFunction","lastCache","undefined","lastArgKey","_fn","_computeKey","arg1","arg2","getCacheKey","arg","key","CachedFunction","_map","Map","_map2","cachedValues","has","value","set","WeakCachedFunction","WeakMap"],"sources":["/home/user/Desktop/MintMind/src/vs/base/common/cache.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CancellationToken, CancellationTokenSource } from './cancellation.js';\nimport { IDisposable } from './lifecycle.js';\n\nexport interface CacheResult<T> extends IDisposable {\n\tpromise: Promise<T>;\n}\n\nexport class Cache<T> {\n\n\tprivate result: CacheResult<T> | null = null;\n\tconstructor(private task: (ct: CancellationToken) => Promise<T>) { }\n\n\tget(): CacheResult<T> {\n\t\tif (this.result) {\n\t\t\treturn this.result;\n\t\t}\n\n\t\tconst cts = new CancellationTokenSource();\n\t\tconst promise = this.task(cts.token);\n\n\t\tthis.result = {\n\t\t\tpromise,\n\t\t\tdispose: () => {\n\t\t\t\tthis.result = null;\n\t\t\t\tcts.cancel();\n\t\t\t\tcts.dispose();\n\t\t\t}\n\t\t};\n\n\t\treturn this.result;\n\t}\n}\n\nexport function identity<T>(t: T): T {\n\treturn t;\n}\n\ninterface ICacheOptions<TArg> {\n\t/**\n\t * The cache key is used to identify the cache entry.\n\t * Strict equality is used to compare cache keys.\n\t*/\n\tgetCacheKey: (arg: TArg) => unknown;\n}\n\n/**\n * Uses a LRU cache to make a given parametrized function cached.\n * Caches just the last key/value.\n*/\nexport class LRUCachedFunction<TArg, TComputed> {\n\tprivate lastCache: TComputed | undefined = undefined;\n\tprivate lastArgKey: unknown | undefined = undefined;\n\n\tprivate readonly _fn: (arg: TArg) => TComputed;\n\tprivate readonly _computeKey: (arg: TArg) => unknown;\n\n\tconstructor(fn: (arg: TArg) => TComputed);\n\tconstructor(options: ICacheOptions<TArg>, fn: (arg: TArg) => TComputed);\n\tconstructor(arg1: ICacheOptions<TArg> | ((arg: TArg) => TComputed), arg2?: (arg: TArg) => TComputed) {\n\t\tif (typeof arg1 === 'function') {\n\t\t\tthis._fn = arg1;\n\t\t\tthis._computeKey = identity;\n\t\t} else {\n\t\t\tthis._fn = arg2!;\n\t\t\tthis._computeKey = arg1.getCacheKey;\n\t\t}\n\t}\n\n\tpublic get(arg: TArg): TComputed {\n\t\tconst key = this._computeKey(arg);\n\t\tif (this.lastArgKey !== key) {\n\t\t\tthis.lastArgKey = key;\n\t\t\tthis.lastCache = this._fn(arg);\n\t\t}\n\t\treturn this.lastCache!;\n\t}\n}\n\n/**\n * Uses an unbounded cache to memoize the results of the given function.\n*/\nexport class CachedFunction<TArg, TComputed> {\n\tprivate readonly _map = new Map<TArg, TComputed>();\n\tprivate readonly _map2 = new Map<unknown, TComputed>();\n\tpublic get cachedValues(): ReadonlyMap<TArg, TComputed> {\n\t\treturn this._map;\n\t}\n\n\tprivate readonly _fn: (arg: TArg) => TComputed;\n\tprivate readonly _computeKey: (arg: TArg) => unknown;\n\n\tconstructor(fn: (arg: TArg) => TComputed);\n\tconstructor(options: ICacheOptions<TArg>, fn: (arg: TArg) => TComputed);\n\tconstructor(arg1: ICacheOptions<TArg> | ((arg: TArg) => TComputed), arg2?: (arg: TArg) => TComputed) {\n\t\tif (typeof arg1 === 'function') {\n\t\t\tthis._fn = arg1;\n\t\t\tthis._computeKey = identity;\n\t\t} else {\n\t\t\tthis._fn = arg2!;\n\t\t\tthis._computeKey = arg1.getCacheKey;\n\t\t}\n\t}\n\n\tpublic get(arg: TArg): TComputed {\n\t\tconst key = this._computeKey(arg);\n\t\tif (this._map2.has(key)) {\n\t\t\treturn this._map2.get(key)!;\n\t\t}\n\n\t\tconst value = this._fn(arg);\n\t\tthis._map.set(arg, value);\n\t\tthis._map2.set(key, value);\n\t\treturn value;\n\t}\n}\n\n/**\n * Uses an unbounded cache to memoize the results of the given function.\n*/\nexport class WeakCachedFunction<TArg, TComputed> {\n\tprivate readonly _map = new WeakMap<WeakKey, TComputed>();\n\n\tprivate readonly _fn: (arg: TArg) => TComputed;\n\tprivate readonly _computeKey: (arg: TArg) => unknown;\n\n\tconstructor(fn: (arg: TArg) => TComputed);\n\tconstructor(options: ICacheOptions<TArg>, fn: (arg: TArg) => TComputed);\n\tconstructor(arg1: ICacheOptions<TArg> | ((arg: TArg) => TComputed), arg2?: (arg: TArg) => TComputed) {\n\t\tif (typeof arg1 === 'function') {\n\t\t\tthis._fn = arg1;\n\t\t\tthis._computeKey = identity;\n\t\t} else {\n\t\t\tthis._fn = arg2!;\n\t\t\tthis._computeKey = arg1.getCacheKey;\n\t\t}\n\t}\n\n\tpublic get(arg: TArg): TComputed {\n\t\tconst key = this._computeKey(arg) as WeakKey;\n\t\tif (this._map.has(key)) {\n\t\t\treturn this._map.get(key)!;\n\t\t}\n\n\t\tconst value = this._fn(arg);\n\t\tthis._map.set(key, value);\n\t\treturn value;\n\t}\n}\n"],"mappings":"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","ignoreList":[]}