{"version":3,"names":["TerminalRecorder","_entries","_totalDataLength","cov_7mgdevdet","s","constructor","cols","rows","f","data","handleResize","length","b","lastEntry","pop","push","handleData","firstEntry","remainingToDelete","shift","substr","generateReplayEventSync","forEach","entry","join","events","map","commands","isWindowsPty","hasRichCommandDetection","promptInputModel","undefined","generateReplayEvent"],"sources":["/home/user/Desktop/MintMind/src/vs/platform/terminal/common/terminalRecorder.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IPtyHostProcessReplayEvent } from './capabilities/capabilities.js';\nimport { ReplayEntry } from './terminalProcess.js';\n\nconst enum Constants {\n\tMaxRecorderDataSize = 10 * 1024 * 1024 // 10MB\n}\n\ninterface RecorderEntry {\n\tcols: number;\n\trows: number;\n\tdata: string[];\n}\n\nexport interface IRemoteTerminalProcessReplayEvent {\n\tevents: ReplayEntry[];\n}\n\nexport class TerminalRecorder {\n\n\tprivate _entries: RecorderEntry[];\n\tprivate _totalDataLength: number = 0;\n\n\tconstructor(cols: number, rows: number) {\n\t\tthis._entries = [{ cols, rows, data: [] }];\n\t}\n\n\thandleResize(cols: number, rows: number): void {\n\t\tif (this._entries.length > 0) {\n\t\t\tconst lastEntry = this._entries[this._entries.length - 1];\n\t\t\tif (lastEntry.data.length === 0) {\n\t\t\t\t// last entry is just a resize, so just remove it\n\t\t\t\tthis._entries.pop();\n\t\t\t}\n\t\t}\n\n\t\tif (this._entries.length > 0) {\n\t\t\tconst lastEntry = this._entries[this._entries.length - 1];\n\t\t\tif (lastEntry.cols === cols && lastEntry.rows === rows) {\n\t\t\t\t// nothing changed\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (lastEntry.cols === 0 && lastEntry.rows === 0) {\n\t\t\t\t// we finally received a good size!\n\t\t\t\tlastEntry.cols = cols;\n\t\t\t\tlastEntry.rows = rows;\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tthis._entries.push({ cols, rows, data: [] });\n\t}\n\n\thandleData(data: string): void {\n\t\tconst lastEntry = this._entries[this._entries.length - 1];\n\t\tlastEntry.data.push(data);\n\n\t\tthis._totalDataLength += data.length;\n\t\twhile (this._totalDataLength > Constants.MaxRecorderDataSize) {\n\t\t\tconst firstEntry = this._entries[0];\n\t\t\tconst remainingToDelete = this._totalDataLength - Constants.MaxRecorderDataSize;\n\t\t\tif (remainingToDelete >= firstEntry.data[0].length) {\n\t\t\t\t// the first data piece must be deleted\n\t\t\t\tthis._totalDataLength -= firstEntry.data[0].length;\n\t\t\t\tfirstEntry.data.shift();\n\t\t\t\tif (firstEntry.data.length === 0) {\n\t\t\t\t\t// the first entry must be deleted\n\t\t\t\t\tthis._entries.shift();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// the first data piece must be partially deleted\n\t\t\t\tfirstEntry.data[0] = firstEntry.data[0].substr(remainingToDelete);\n\t\t\t\tthis._totalDataLength -= remainingToDelete;\n\t\t\t}\n\t\t}\n\t}\n\n\tgenerateReplayEventSync(): IPtyHostProcessReplayEvent {\n\t\t// normalize entries to one element per data array\n\t\tthis._entries.forEach((entry) => {\n\t\t\tif (entry.data.length > 0) {\n\t\t\t\tentry.data = [entry.data.join('')];\n\t\t\t}\n\t\t});\n\t\treturn {\n\t\t\tevents: this._entries.map(entry => ({ cols: entry.cols, rows: entry.rows, data: entry.data[0] ?? '' })),\n\t\t\t// No command restoration is needed when relaunching terminals\n\t\t\tcommands: {\n\t\t\t\tisWindowsPty: false,\n\t\t\t\thasRichCommandDetection: false,\n\t\t\t\tcommands: [],\n\t\t\t\tpromptInputModel: undefined,\n\t\t\t}\n\t\t};\n\t}\n\n\tasync generateReplayEvent(): Promise<IPtyHostProcessReplayEvent> {\n\t\treturn this.generateReplayEventSync();\n\t}\n}\n"],"mappings":"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","ignoreList":[]}