{"version":3,"names":["cov_xitd7olb2","actualCoverage","decodeBase64","encodeBase64","VSBuffer","filter","URI","NotebookCellTextModel","NotebookSetting","BufferMarker","s","ChatEditingNotebookSnapshotScheme","getNotebookSnapshotFileURI","chatSessionId","requestId","undoStop","path","viewType","f","from","scheme","query","JSON","stringify","sessionId","b","parseNotebookSnapshotFileURI","resource","data","parse","createSnapshot","notebook","transientOptions","outputSizeConfig","outputSizeLimit","getValue","outputBackupSizeLimit","serializeSnapshot","context","restoreSnapshot","snapshot","deserializeSnapshot","edits","cells","forEach","cell","index","internalId","internalMetadata","push","editType","applyEdits","undefined","ex","console","error","SnapshotComparer","constructor","initialCotent","isEqual","length","transientDocumentMetadata","notebookMetadata","metadata","key","comparerMetadata","transientCellMetadata","i","notebookCell","comparerCell","fastEqual","cellKind","language","mime","source","transientOutputs","outputs","cellMetadata","comparerCellMetadata","sanitizeCellDto2","ignoreInternalMetadata","map","output","outputId","item","collapseState","dataDto","_key","value","type","transientOptionsStr","dataStr"],"sources":["/home/user/Desktop/MintMind/src/vs/workbench/contrib/chat/browser/chatEditing/notebook/chatEditingModifiedNotebookSnapshot.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { decodeBase64, encodeBase64, VSBuffer } from '../../../../../../base/common/buffer.js';\nimport { filter } from '../../../../../../base/common/objects.js';\nimport { URI } from '../../../../../../base/common/uri.js';\nimport { IConfigurationService } from '../../../../../../platform/configuration/common/configuration.js';\nimport { SnapshotContext } from '../../../../../services/workingCopy/common/fileWorkingCopy.js';\nimport { NotebookCellTextModel } from '../../../../notebook/common/model/notebookCellTextModel.js';\nimport { NotebookTextModel } from '../../../../notebook/common/model/notebookTextModel.js';\nimport { CellEditType, ICellDto2, ICellEditOperation, INotebookTextModel, IOutputItemDto, NotebookData, NotebookSetting, TransientOptions } from '../../../../notebook/common/notebookCommon.js';\n\nconst BufferMarker = 'ArrayBuffer-4f56482b-5a03-49ba-8356-210d3b0c1c3d';\n\ntype ChatEditingSnapshotNotebookContentQueryData = { sessionId: string; requestId: string | undefined; undoStop: string | undefined; viewType: string };\nexport const ChatEditingNotebookSnapshotScheme = 'chat-editing-notebook-snapshot-model';\n\nexport function getNotebookSnapshotFileURI(chatSessionId: string, requestId: string | undefined, undoStop: string | undefined, path: string, viewType: string): URI {\n\treturn URI.from({\n\t\tscheme: ChatEditingNotebookSnapshotScheme,\n\t\tpath,\n\t\tquery: JSON.stringify({ sessionId: chatSessionId, requestId: requestId ?? '', undoStop: undoStop ?? '', viewType } satisfies ChatEditingSnapshotNotebookContentQueryData),\n\t});\n}\n\nexport function parseNotebookSnapshotFileURI(resource: URI): ChatEditingSnapshotNotebookContentQueryData {\n\tconst data: ChatEditingSnapshotNotebookContentQueryData = JSON.parse(resource.query);\n\treturn { sessionId: data.sessionId ?? '', requestId: data.requestId ?? '', undoStop: data.undoStop ?? '', viewType: data.viewType };\n}\n\nexport function createSnapshot(notebook: INotebookTextModel, transientOptions: TransientOptions | undefined, outputSizeConfig: IConfigurationService | number): string {\n\tconst outputSizeLimit = (typeof outputSizeConfig === 'number' ? outputSizeConfig : outputSizeConfig.getValue<number>(NotebookSetting.outputBackupSizeLimit)) * 1024;\n\treturn serializeSnapshot(notebook.createSnapshot({ context: SnapshotContext.Backup, outputSizeLimit, transientOptions }), transientOptions);\n}\n\nexport function restoreSnapshot(notebook: INotebookTextModel, snapshot: string): void {\n\ttry {\n\t\tconst { transientOptions, data } = deserializeSnapshot(snapshot);\n\t\tnotebook.restoreSnapshot(data, transientOptions);\n\t\tconst edits: ICellEditOperation[] = [];\n\t\tdata.cells.forEach((cell, index) => {\n\t\t\tconst internalId = cell.internalMetadata?.internalId;\n\t\t\tif (internalId) {\n\t\t\t\tedits.push({ editType: CellEditType.PartialInternalMetadata, index, internalMetadata: { internalId } });\n\t\t\t}\n\t\t});\n\t\tnotebook.applyEdits(edits, true, undefined, () => undefined, undefined, false);\n\t}\n\tcatch (ex) {\n\t\tconsole.error('Error restoring Notebook snapshot', ex);\n\t}\n}\n\nexport class SnapshotComparer {\n\tprivate readonly data: NotebookData;\n\tprivate readonly transientOptions: TransientOptions | undefined;\n\tconstructor(initialCotent: string) {\n\t\tconst { transientOptions, data } = deserializeSnapshot(initialCotent);\n\t\tthis.transientOptions = transientOptions;\n\t\tthis.data = data;\n\t}\n\n\tisEqual(notebook: NotebookData | NotebookTextModel): boolean {\n\t\tif (notebook.cells.length !== this.data.cells.length) {\n\t\t\treturn false;\n\t\t}\n\t\tconst transientDocumentMetadata = this.transientOptions?.transientDocumentMetadata || {};\n\t\tconst notebookMetadata = filter(notebook.metadata || {}, key => !transientDocumentMetadata[key]);\n\t\tconst comparerMetadata = filter(this.data.metadata || {}, key => !transientDocumentMetadata[key]);\n\t\t// When comparing ignore transient items.\n\t\tif (JSON.stringify(notebookMetadata) !== JSON.stringify(comparerMetadata)) {\n\t\t\treturn false;\n\t\t}\n\t\tconst transientCellMetadata = this.transientOptions?.transientCellMetadata || {};\n\t\tfor (let i = 0; i < notebook.cells.length; i++) {\n\t\t\tconst notebookCell = notebook.cells[i];\n\t\t\tconst comparerCell = this.data.cells[i];\n\t\t\tif (notebookCell instanceof NotebookCellTextModel) {\n\t\t\t\tif (!notebookCell.fastEqual(comparerCell, true)) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (notebookCell.cellKind !== comparerCell.cellKind) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif (notebookCell.language !== comparerCell.language) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif (notebookCell.mime !== comparerCell.mime) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif (notebookCell.source !== comparerCell.source) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif (!this.transientOptions?.transientOutputs && notebookCell.outputs.length !== comparerCell.outputs.length) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\t// When comparing ignore transient items.\n\t\t\t\tconst cellMetadata = filter(notebookCell.metadata || {}, key => !transientCellMetadata[key]);\n\t\t\t\tconst comparerCellMetadata = filter(comparerCell.metadata || {}, key => !transientCellMetadata[key]);\n\t\t\t\tif (JSON.stringify(cellMetadata) !== JSON.stringify(comparerCellMetadata)) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\t// When comparing ignore transient items.\n\t\t\t\tif (JSON.stringify(sanitizeCellDto2(notebookCell, true, this.transientOptions)) !== JSON.stringify(sanitizeCellDto2(comparerCell, true, this.transientOptions))) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n}\n\nfunction sanitizeCellDto2(cell: ICellDto2, ignoreInternalMetadata?: boolean, transientOptions?: TransientOptions): ICellDto2 {\n\tconst transientCellMetadata = transientOptions?.transientCellMetadata || {};\n\tconst outputs = transientOptions?.transientOutputs ? [] : cell.outputs.map(output => {\n\t\t// Ensure we're in full control of the data being stored.\n\t\t// Possible we have classes instead of plain objects.\n\t\treturn {\n\t\t\toutputId: output.outputId,\n\t\t\tmetadata: output.metadata,\n\t\t\toutputs: output.outputs.map(item => {\n\t\t\t\treturn {\n\t\t\t\t\tdata: item.data,\n\t\t\t\t\tmime: item.mime,\n\t\t\t\t} satisfies IOutputItemDto;\n\t\t\t}),\n\t\t};\n\t});\n\t// Ensure we're in full control of the data being stored.\n\t// Possible we have classes instead of plain objects.\n\treturn {\n\t\tcellKind: cell.cellKind,\n\t\tlanguage: cell.language,\n\t\tmetadata: cell.metadata ? filter(cell.metadata, key => !transientCellMetadata[key]) : cell.metadata,\n\t\toutputs,\n\t\tmime: cell.mime,\n\t\tsource: cell.source,\n\t\tcollapseState: cell.collapseState,\n\t\tinternalMetadata: ignoreInternalMetadata ? undefined : cell.internalMetadata\n\t} satisfies ICellDto2;\n}\n\nfunction serializeSnapshot(data: NotebookData, transientOptions: TransientOptions | undefined): string {\n\tconst dataDto: NotebookData = {\n\t\t// Never pass transient options, as we're after a backup here.\n\t\t// Else we end up stripping outputs from backups.\n\t\t// Whether its persisted or not is up to the serializer.\n\t\t// However when reloading/restoring we need to preserve outputs.\n\t\tcells: data.cells.map(cell => sanitizeCellDto2(cell)),\n\t\tmetadata: data.metadata,\n\t};\n\treturn JSON.stringify([\n\t\tJSON.stringify(transientOptions)\n\t\t, JSON.stringify(dataDto, (_key, value) => {\n\t\t\tif (value instanceof VSBuffer) {\n\t\t\t\treturn {\n\t\t\t\t\ttype: BufferMarker,\n\t\t\t\t\tdata: encodeBase64(value)\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn value;\n\t\t})\n\t]);\n}\n\nexport function deserializeSnapshot(snapshot: string): { transientOptions: TransientOptions | undefined; data: NotebookData } {\n\tconst [transientOptionsStr, dataStr] = JSON.parse(snapshot);\n\tconst transientOptions = transientOptionsStr ? JSON.parse(transientOptionsStr) as TransientOptions : undefined;\n\n\tconst data: NotebookData = JSON.parse(dataStr, (_key, value) => {\n\t\tif (value && value.type === BufferMarker) {\n\t\t\treturn decodeBase64(value.data);\n\t\t}\n\t\treturn value;\n\t});\n\n\treturn { transientOptions, data };\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}