{"version":3,"names":["cov_2ptdvvened","actualCoverage","joinPath","VSBuffer","Queue","ConfigurationCache","donotCacheResourcesWithSchemes","fileService","cacheHome","cachedConfigurations","s","Map","constructor","environmentService","f","needsCaching","resource","includes","scheme","read","key","getCachedConfiguration","write","content","save","remove","type","k","cachedConfiguration","get","b","CachedConfiguration","set","queue","cachedConfigurationFolderResource","cachedConfigurationFileResource","readFile","value","toString","e","created","createCachedFolder","writeFile","fromString","del","recursive","useTrash","error","fileOperationResult","exists","createFolder"],"sources":["/home/user/Desktop/MintMind/src/vs/workbench/services/configuration/common/configurationCache.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IConfigurationCache, ConfigurationKey } from './configuration.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { FileOperationError, FileOperationResult, IFileService } from '../../../../platform/files/common/files.js';\nimport { joinPath } from '../../../../base/common/resources.js';\nimport { VSBuffer } from '../../../../base/common/buffer.js';\nimport { Queue } from '../../../../base/common/async.js';\nimport { IEnvironmentService } from '../../../../platform/environment/common/environment.js';\n\nexport class ConfigurationCache implements IConfigurationCache {\n\n\tprivate readonly cacheHome: URI;\n\tprivate readonly cachedConfigurations: Map<string, CachedConfiguration> = new Map<string, CachedConfiguration>();\n\n\tconstructor(\n\t\tprivate readonly donotCacheResourcesWithSchemes: string[],\n\t\tenvironmentService: IEnvironmentService,\n\t\tprivate readonly fileService: IFileService\n\t) {\n\t\tthis.cacheHome = environmentService.cacheHome;\n\t}\n\n\tneedsCaching(resource: URI): boolean {\n\t\t// Cache all non native resources\n\t\treturn !this.donotCacheResourcesWithSchemes.includes(resource.scheme);\n\t}\n\n\tread(key: ConfigurationKey): Promise<string> {\n\t\treturn this.getCachedConfiguration(key).read();\n\t}\n\n\twrite(key: ConfigurationKey, content: string): Promise<void> {\n\t\treturn this.getCachedConfiguration(key).save(content);\n\t}\n\n\tremove(key: ConfigurationKey): Promise<void> {\n\t\treturn this.getCachedConfiguration(key).remove();\n\t}\n\n\tprivate getCachedConfiguration({ type, key }: ConfigurationKey): CachedConfiguration {\n\t\tconst k = `${type}:${key}`;\n\t\tlet cachedConfiguration = this.cachedConfigurations.get(k);\n\t\tif (!cachedConfiguration) {\n\t\t\tcachedConfiguration = new CachedConfiguration({ type, key }, this.cacheHome, this.fileService);\n\t\t\tthis.cachedConfigurations.set(k, cachedConfiguration);\n\t\t}\n\t\treturn cachedConfiguration;\n\t}\n}\n\nclass CachedConfiguration {\n\n\tprivate queue: Queue<void>;\n\tprivate cachedConfigurationFolderResource: URI;\n\tprivate cachedConfigurationFileResource: URI;\n\n\tconstructor(\n\t\t{ type, key }: ConfigurationKey,\n\t\tcacheHome: URI,\n\t\tprivate readonly fileService: IFileService\n\t) {\n\t\tthis.cachedConfigurationFolderResource = joinPath(cacheHome, 'CachedConfigurations', type, key);\n\t\tthis.cachedConfigurationFileResource = joinPath(this.cachedConfigurationFolderResource, type === 'workspaces' ? 'workspace.json' : 'configuration.json');\n\t\tthis.queue = new Queue<void>();\n\t}\n\n\tasync read(): Promise<string> {\n\t\ttry {\n\t\t\tconst content = await this.fileService.readFile(this.cachedConfigurationFileResource);\n\t\t\treturn content.value.toString();\n\t\t} catch (e) {\n\t\t\treturn '';\n\t\t}\n\t}\n\n\tasync save(content: string): Promise<void> {\n\t\tconst created = await this.createCachedFolder();\n\t\tif (created) {\n\t\t\tawait this.queue.queue(async () => {\n\t\t\t\tawait this.fileService.writeFile(this.cachedConfigurationFileResource, VSBuffer.fromString(content));\n\t\t\t});\n\t\t}\n\t}\n\n\tasync remove(): Promise<void> {\n\t\ttry {\n\t\t\tawait this.queue.queue(() => this.fileService.del(this.cachedConfigurationFolderResource, { recursive: true, useTrash: false }));\n\t\t} catch (error) {\n\t\t\tif ((<FileOperationError>error).fileOperationResult !== FileOperationResult.FILE_NOT_FOUND) {\n\t\t\t\tthrow error;\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate async createCachedFolder(): Promise<boolean> {\n\t\tif (await this.fileService.exists(this.cachedConfigurationFolderResource)) {\n\t\t\treturn true;\n\t\t}\n\t\ttry {\n\t\t\tawait this.fileService.createFolder(this.cachedConfigurationFolderResource);\n\t\t\treturn true;\n\t\t} catch (error) {\n\t\t\treturn false;\n\t\t}\n\t}\n}\n\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAuBM;IAAAA,cAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,cAAA;AAvBN;;;;AAQA,SAASE,QAAQ,QAAQ,sCAAsC;AAC/D,SAASC,QAAQ,QAAQ,mCAAmC;AAC5D,SAASC,KAAK,QAAQ,kCAAkC;AAGxD,OAAM,MAAOC,kBAAkB;EAMZC,8BAAA;EAEAC,WAAA;EANDC,SAAS;EACTC,oBAAoB;EAAA;EAAA,CAAAT,cAAA,GAAAU,CAAA,OAAqC,IAAIC,GAAG,EAA+B;EAEhHC,YACkBN,8BAAwC,EACzDO,kBAAuC,EACtBN,WAAyB;IAAA;IAAAP,cAAA,GAAAc,CAAA;IAAAd,cAAA,GAAAU,CAAA;IAFzB,KAAAJ,8BAA8B,GAA9BA,8BAA8B;IAAU;IAAAN,cAAA,GAAAU,CAAA;IAExC,KAAAH,WAAW,GAAXA,WAAW;IAAc;IAAAP,cAAA,GAAAU,CAAA;IAE1C,IAAI,CAACF,SAAS,GAAGK,kBAAkB,CAACL,SAAS;EAC9C;EAEAO,YAAYA,CAACC,QAAa;IAAA;IAAAhB,cAAA,GAAAc,CAAA;IAAAd,cAAA,GAAAU,CAAA;IACzB;IACA,OAAO,CAAC,IAAI,CAACJ,8BAA8B,CAACW,QAAQ,CAACD,QAAQ,CAACE,MAAM,CAAC;EACtE;EAEAC,IAAIA,CAACC,GAAqB;IAAA;IAAApB,cAAA,GAAAc,CAAA;IAAAd,cAAA,GAAAU,CAAA;IACzB,OAAO,IAAI,CAACW,sBAAsB,CAACD,GAAG,CAAC,CAACD,IAAI,EAAE;EAC/C;EAEAG,KAAKA,CAACF,GAAqB,EAAEG,OAAe;IAAA;IAAAvB,cAAA,GAAAc,CAAA;IAAAd,cAAA,GAAAU,CAAA;IAC3C,OAAO,IAAI,CAACW,sBAAsB,CAACD,GAAG,CAAC,CAACI,IAAI,CAACD,OAAO,CAAC;EACtD;EAEAE,MAAMA,CAACL,GAAqB;IAAA;IAAApB,cAAA,GAAAc,CAAA;IAAAd,cAAA,GAAAU,CAAA;IAC3B,OAAO,IAAI,CAACW,sBAAsB,CAACD,GAAG,CAAC,CAACK,MAAM,EAAE;EACjD;EAEQJ,sBAAsBA,CAAC;IAAEK,IAAI;IAAEN;EAAG,CAAoB;IAAA;IAAApB,cAAA,GAAAc,CAAA;IAC7D,MAAMa,CAAC;IAAA;IAAA,CAAA3B,cAAA,GAAAU,CAAA,OAAG,GAAGgB,IAAI,IAAIN,GAAG,EAAE;IAC1B,IAAIQ,mBAAmB;IAAA;IAAA,CAAA5B,cAAA,GAAAU,CAAA,OAAG,IAAI,CAACD,oBAAoB,CAACoB,GAAG,CAACF,CAAC,CAAC;IAAC;IAAA3B,cAAA,GAAAU,CAAA;IAC3D,IAAI,CAACkB,mBAAmB,EAAE;MAAA;MAAA5B,cAAA,GAAA8B,CAAA;MAAA9B,cAAA,GAAAU,CAAA;MACzBkB,mBAAmB,GAAG,IAAIG,mBAAmB,CAAC;QAAEL,IAAI;QAAEN;MAAG,CAAE,EAAE,IAAI,CAACZ,SAAS,EAAE,IAAI,CAACD,WAAW,CAAC;MAAC;MAAAP,cAAA,GAAAU,CAAA;MAC/F,IAAI,CAACD,oBAAoB,CAACuB,GAAG,CAACL,CAAC,EAAEC,mBAAmB,CAAC;IACtD,CAAC;IAAA;IAAA;MAAA5B,cAAA,GAAA8B,CAAA;IAAA;IAAA9B,cAAA,GAAAU,CAAA;IACD,OAAOkB,mBAAmB;EAC3B;;AAGD,MAAMG,mBAAmB;EASNxB,WAAA;EAPV0B,KAAK;EACLC,iCAAiC;EACjCC,+BAA+B;EAEvCvB,YACC;IAAEc,IAAI;IAAEN;EAAG,CAAoB,EAC/BZ,SAAc,EACGD,WAAyB;IAAA;IAAAP,cAAA,GAAAc,CAAA;IAAAd,cAAA,GAAAU,CAAA;IAAzB,KAAAH,WAAW,GAAXA,WAAW;IAAc;IAAAP,cAAA,GAAAU,CAAA;IAE1C,IAAI,CAACwB,iCAAiC,GAAGhC,QAAQ,CAACM,SAAS,EAAE,sBAAsB,EAAEkB,IAAI,EAAEN,GAAG,CAAC;IAAC;IAAApB,cAAA,GAAAU,CAAA;IAChG,IAAI,CAACyB,+BAA+B,GAAGjC,QAAQ,CAAC,IAAI,CAACgC,iCAAiC,EAAER,IAAI,KAAK,YAAY;IAAA;IAAA,CAAA1B,cAAA,GAAA8B,CAAA,UAAG,gBAAgB;IAAA;IAAA,CAAA9B,cAAA,GAAA8B,CAAA,UAAG,oBAAoB,EAAC;IAAC;IAAA9B,cAAA,GAAAU,CAAA;IACzJ,IAAI,CAACuB,KAAK,GAAG,IAAI7B,KAAK,EAAQ;EAC/B;EAEA,MAAMe,IAAIA,CAAA;IAAA;IAAAnB,cAAA,GAAAc,CAAA;IAAAd,cAAA,GAAAU,CAAA;IACT,IAAI;MACH,MAAMa,OAAO;MAAA;MAAA,CAAAvB,cAAA,GAAAU,CAAA,QAAG,MAAM,IAAI,CAACH,WAAW,CAAC6B,QAAQ,CAAC,IAAI,CAACD,+BAA+B,CAAC;MAAC;MAAAnC,cAAA,GAAAU,CAAA;MACtF,OAAOa,OAAO,CAACc,KAAK,CAACC,QAAQ,EAAE;IAChC,CAAC,CAAC,OAAOC,CAAC,EAAE;MAAA;MAAAvC,cAAA,GAAAU,CAAA;MACX,OAAO,EAAE;IACV;EACD;EAEA,MAAMc,IAAIA,CAACD,OAAe;IAAA;IAAAvB,cAAA,GAAAc,CAAA;IACzB,MAAM0B,OAAO;IAAA;IAAA,CAAAxC,cAAA,GAAAU,CAAA,QAAG,MAAM,IAAI,CAAC+B,kBAAkB,EAAE;IAAC;IAAAzC,cAAA,GAAAU,CAAA;IAChD,IAAI8B,OAAO,EAAE;MAAA;MAAAxC,cAAA,GAAA8B,CAAA;MAAA9B,cAAA,GAAAU,CAAA;MACZ,MAAM,IAAI,CAACuB,KAAK,CAACA,KAAK,CAAC,YAAW;QAAA;QAAAjC,cAAA,GAAAc,CAAA;QAAAd,cAAA,GAAAU,CAAA;QACjC,MAAM,IAAI,CAACH,WAAW,CAACmC,SAAS,CAAC,IAAI,CAACP,+BAA+B,EAAEhC,QAAQ,CAACwC,UAAU,CAACpB,OAAO,CAAC,CAAC;MACrG,CAAC,CAAC;IACH,CAAC;IAAA;IAAA;MAAAvB,cAAA,GAAA8B,CAAA;IAAA;EACF;EAEA,MAAML,MAAMA,CAAA;IAAA;IAAAzB,cAAA,GAAAc,CAAA;IAAAd,cAAA,GAAAU,CAAA;IACX,IAAI;MAAA;MAAAV,cAAA,GAAAU,CAAA;MACH,MAAM,IAAI,CAACuB,KAAK,CAACA,KAAK,CAAC,MAAM;QAAA;QAAAjC,cAAA,GAAAc,CAAA;QAAAd,cAAA,GAAAU,CAAA;QAAA,WAAI,CAACH,WAAW,CAACqC,GAAG,CAAC,IAAI,CAACV,iCAAiC,EAAE;UAAEW,SAAS,EAAE,IAAI;UAAEC,QAAQ,EAAE;QAAK,CAAE,CAAC;MAAD,CAAC,CAAC;IACjI,CAAC,CAAC,OAAOC,KAAK,EAAE;MAAA;MAAA/C,cAAA,GAAAU,CAAA;MACf,IAAyBqC,KAAM,CAACC,mBAAmB,iDAAyC;QAAA;QAAAhD,cAAA,GAAA8B,CAAA;QAAA9B,cAAA,GAAAU,CAAA;QAC3F,MAAMqC,KAAK;MACZ,CAAC;MAAA;MAAA;QAAA/C,cAAA,GAAA8B,CAAA;MAAA;IACF;EACD;EAEQ,MAAMW,kBAAkBA,CAAA;IAAA;IAAAzC,cAAA,GAAAc,CAAA;IAAAd,cAAA,GAAAU,CAAA;IAC/B,IAAI,MAAM,IAAI,CAACH,WAAW,CAAC0C,MAAM,CAAC,IAAI,CAACf,iCAAiC,CAAC,EAAE;MAAA;MAAAlC,cAAA,GAAA8B,CAAA;MAAA9B,cAAA,GAAAU,CAAA;MAC1E,OAAO,IAAI;IACZ,CAAC;IAAA;IAAA;MAAAV,cAAA,GAAA8B,CAAA;IAAA;IAAA9B,cAAA,GAAAU,CAAA;IACD,IAAI;MAAA;MAAAV,cAAA,GAAAU,CAAA;MACH,MAAM,IAAI,CAACH,WAAW,CAAC2C,YAAY,CAAC,IAAI,CAAChB,iCAAiC,CAAC;MAAC;MAAAlC,cAAA,GAAAU,CAAA;MAC5E,OAAO,IAAI;IACZ,CAAC,CAAC,OAAOqC,KAAK,EAAE;MAAA;MAAA/C,cAAA,GAAAU,CAAA;MACf,OAAO,KAAK;IACb;EACD","ignoreList":[]}