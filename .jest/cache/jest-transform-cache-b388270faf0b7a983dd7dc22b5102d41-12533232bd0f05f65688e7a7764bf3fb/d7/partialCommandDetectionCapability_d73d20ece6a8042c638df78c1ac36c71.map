{"version":3,"names":["cov_z24m81su0","actualCoverage","Emitter","DisposableStore","PartialCommandDetectionCapability","_terminal","_onDidExecuteText","type","s","_commands","commands","f","_onCommandFinished","add","onCommandFinished","event","constructor","onData","e","_onData","parser","registerCsiHandler","final","params","b","length","_clearCommandsInViewport","_onEnter","data","buffer","active","cursorX","marker","registerMarker","push","fire","count","i","line","baseY","splice"],"sources":["/home/user/Desktop/MintMind/src/vs/platform/terminal/common/capabilities/partialCommandDetectionCapability.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { IPartialCommandDetectionCapability, TerminalCapability } from './capabilities.js';\nimport type { IMarker, Terminal } from '@xterm/headless';\n\nconst enum Constants {\n\t/**\n\t * The minimum size of the prompt in which to assume the line is a command.\n\t */\n\tMinimumPromptLength = 2\n}\n\n/**\n * This capability guesses where commands are based on where the cursor was when enter was pressed.\n * It's very hit or miss but it's often correct and better than nothing.\n */\nexport class PartialCommandDetectionCapability extends DisposableStore implements IPartialCommandDetectionCapability {\n\treadonly type = TerminalCapability.PartialCommandDetection;\n\n\tprivate readonly _commands: IMarker[] = [];\n\n\tget commands(): readonly IMarker[] { return this._commands; }\n\n\tprivate readonly _onCommandFinished = this.add(new Emitter<IMarker>());\n\treadonly onCommandFinished = this._onCommandFinished.event;\n\n\tconstructor(\n\t\tprivate readonly _terminal: Terminal,\n\t\tprivate _onDidExecuteText: Event<void> | undefined\n\t) {\n\t\tsuper();\n\t\tthis.add(this._terminal.onData(e => this._onData(e)));\n\t\tthis.add(this._terminal.parser.registerCsiHandler({ final: 'J' }, params => {\n\t\t\tif (params.length >= 1 && (params[0] === 2 || params[0] === 3)) {\n\t\t\t\tthis._clearCommandsInViewport();\n\t\t\t}\n\t\t\t// We don't want to override xterm.js' default behavior, just augment it\n\t\t\treturn false;\n\t\t}));\n\t\tif (this._onDidExecuteText) {\n\t\t\tthis.add(this._onDidExecuteText(() => this._onEnter()));\n\t\t}\n\t}\n\n\tprivate _onData(data: string): void {\n\t\tif (data === '\\x0d') {\n\t\t\tthis._onEnter();\n\t\t}\n\t}\n\n\tprivate _onEnter(): void {\n\t\tif (!this._terminal) {\n\t\t\treturn;\n\t\t}\n\t\tif (this._terminal.buffer.active.cursorX >= Constants.MinimumPromptLength) {\n\t\t\tconst marker = this._terminal.registerMarker(0);\n\t\t\tif (marker) {\n\t\t\t\tthis._commands.push(marker);\n\t\t\t\tthis._onCommandFinished.fire(marker);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _clearCommandsInViewport(): void {\n\t\t// Find the number of commands on the tail end of the array that are within the viewport\n\t\tlet count = 0;\n\t\tfor (let i = this._commands.length - 1; i >= 0; i--) {\n\t\t\tif (this._commands[i].line < this._terminal.buffer.active.baseY) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcount++;\n\t\t}\n\t\t// Remove them\n\t\tthis._commands.splice(this._commands.length - count, count);\n\t}\n}\n"],"mappings":"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","ignoreList":[]}