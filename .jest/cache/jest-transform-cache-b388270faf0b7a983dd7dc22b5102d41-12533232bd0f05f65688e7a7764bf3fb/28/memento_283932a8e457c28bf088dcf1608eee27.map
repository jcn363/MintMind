{"version":3,"names":["cov_19vdfyi1en","actualCoverage","isEmptyObject","onUnexpectedError","Memento","storageService","applicationMementos","s","Map","profileMementos","workspaceMementos","COMMON_PREFIX","id","constructor","f","getMemento","scope","target","b","workspaceMemento","get","ScopedMemento","set","profileMemento","applicationMemento","onDidChangeValue","disposables","saveMemento","save","reloadMemento","memento","reload","clear","mementoObj","doLoad","getObject","error","name","Object","getOwnPropertyNames","assign","store","remove"],"sources":["/home/user/Desktop/MintMind/src/vs/workbench/common/memento.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IStorageService, IStorageValueChangeEvent, StorageScope, StorageTarget } from '../../platform/storage/common/storage.js';\nimport { isEmptyObject } from '../../base/common/types.js';\nimport { onUnexpectedError } from '../../base/common/errors.js';\nimport { DisposableStore } from '../../base/common/lifecycle.js';\nimport { Event } from '../../base/common/event.js';\n\nexport class Memento<T extends object> {\n\n\tprivate static readonly applicationMementos = new Map<string, ScopedMemento<unknown>>();\n\tprivate static readonly profileMementos = new Map<string, ScopedMemento<unknown>>();\n\tprivate static readonly workspaceMementos = new Map<string, ScopedMemento<unknown>>();\n\n\tprivate static readonly COMMON_PREFIX = 'memento/';\n\n\tprivate readonly id: string;\n\n\tconstructor(id: string, private storageService: IStorageService) {\n\t\tthis.id = Memento.COMMON_PREFIX + id;\n\t}\n\n\tgetMemento(scope: StorageScope, target: StorageTarget): Partial<T> {\n\t\tswitch (scope) {\n\t\t\tcase StorageScope.WORKSPACE: {\n\t\t\t\tlet workspaceMemento = Memento.workspaceMementos.get(this.id);\n\t\t\t\tif (!workspaceMemento) {\n\t\t\t\t\tworkspaceMemento = new ScopedMemento(this.id, scope, target, this.storageService);\n\t\t\t\t\tMemento.workspaceMementos.set(this.id, workspaceMemento);\n\t\t\t\t}\n\n\t\t\t\treturn workspaceMemento.getMemento();\n\t\t\t}\n\n\t\t\tcase StorageScope.PROFILE: {\n\t\t\t\tlet profileMemento = Memento.profileMementos.get(this.id);\n\t\t\t\tif (!profileMemento) {\n\t\t\t\t\tprofileMemento = new ScopedMemento(this.id, scope, target, this.storageService);\n\t\t\t\t\tMemento.profileMementos.set(this.id, profileMemento);\n\t\t\t\t}\n\n\t\t\t\treturn profileMemento.getMemento();\n\t\t\t}\n\n\t\t\tcase StorageScope.APPLICATION: {\n\t\t\t\tlet applicationMemento = Memento.applicationMementos.get(this.id);\n\t\t\t\tif (!applicationMemento) {\n\t\t\t\t\tapplicationMemento = new ScopedMemento(this.id, scope, target, this.storageService);\n\t\t\t\t\tMemento.applicationMementos.set(this.id, applicationMemento);\n\t\t\t\t}\n\n\t\t\t\treturn applicationMemento.getMemento();\n\t\t\t}\n\t\t}\n\t}\n\n\tonDidChangeValue(scope: StorageScope, disposables: DisposableStore): Event<IStorageValueChangeEvent> {\n\t\treturn this.storageService.onDidChangeValue(scope, this.id, disposables);\n\t}\n\n\tsaveMemento(): void {\n\t\tMemento.workspaceMementos.get(this.id)?.save();\n\t\tMemento.profileMementos.get(this.id)?.save();\n\t\tMemento.applicationMementos.get(this.id)?.save();\n\t}\n\n\treloadMemento(scope: StorageScope): void {\n\t\tlet memento: ScopedMemento<unknown> | undefined;\n\t\tswitch (scope) {\n\t\t\tcase StorageScope.APPLICATION:\n\t\t\t\tmemento = Memento.applicationMementos.get(this.id);\n\t\t\t\tbreak;\n\t\t\tcase StorageScope.PROFILE:\n\t\t\t\tmemento = Memento.profileMementos.get(this.id);\n\t\t\t\tbreak;\n\t\t\tcase StorageScope.WORKSPACE:\n\t\t\t\tmemento = Memento.workspaceMementos.get(this.id);\n\t\t\t\tbreak;\n\t\t}\n\n\t\tmemento?.reload();\n\t}\n\n\tstatic clear(scope: StorageScope): void {\n\t\tswitch (scope) {\n\t\t\tcase StorageScope.WORKSPACE:\n\t\t\t\tMemento.workspaceMementos.clear();\n\t\t\t\tbreak;\n\t\t\tcase StorageScope.PROFILE:\n\t\t\t\tMemento.profileMementos.clear();\n\t\t\t\tbreak;\n\t\t\tcase StorageScope.APPLICATION:\n\t\t\t\tMemento.applicationMementos.clear();\n\t\t\t\tbreak;\n\t\t}\n\t}\n}\n\nclass ScopedMemento<T> {\n\n\tprivate mementoObj: Partial<T>;\n\n\tconstructor(private id: string, private scope: StorageScope, private target: StorageTarget, private storageService: IStorageService) {\n\t\tthis.mementoObj = this.doLoad();\n\t}\n\n\tprivate doLoad(): Partial<T> {\n\t\ttry {\n\t\t\treturn this.storageService.getObject(this.id, this.scope, {});\n\t\t} catch (error) {\n\t\t\t// Seeing reports from users unable to open editors\n\t\t\t// from memento parsing exceptions. Log the contents\n\t\t\t// to diagnose further\n\t\t\t// https://github.com/microsoft/vscode/issues/102251\n\t\t\tonUnexpectedError(`[memento]: failed to parse contents: ${error} (id: ${this.id}, scope: ${this.scope}, contents: ${this.storageService.get(this.id, this.scope)})`);\n\t\t}\n\n\t\treturn {};\n\t}\n\n\tgetMemento(): Partial<T> {\n\t\treturn this.mementoObj;\n\t}\n\n\treload(): void {\n\n\t\t// Clear old\n\t\tfor (const name of Object.getOwnPropertyNames(this.mementoObj)) {\n\t\t\tdelete this.mementoObj[name as keyof Partial<T>];\n\t\t}\n\n\t\t// Assign new\n\t\tObject.assign(this.mementoObj, this.doLoad());\n\t}\n\n\tsave(): void {\n\t\tif (!isEmptyObject(this.mementoObj)) {\n\t\t\tthis.storageService.store(this.id, this.mementoObj, this.scope, this.target);\n\t\t} else {\n\t\t\tthis.storageService.remove(this.id, this.scope);\n\t\t}\n\t}\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}