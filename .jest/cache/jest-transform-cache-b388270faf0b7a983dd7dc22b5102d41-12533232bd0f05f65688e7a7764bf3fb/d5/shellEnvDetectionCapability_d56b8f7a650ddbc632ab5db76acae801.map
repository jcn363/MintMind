{"version":3,"names":["cov_1gx7dkk2v9","actualCoverage","Disposable","Emitter","equals","mapsStrictEqualIgnoreOrder","ShellEnvDetectionCapability","type","s","_pendingEnv","_env","value","Map","isTrusted","env","f","_createStateObject","_onDidChangeEnv","_register","onDidChangeEnv","event","setEnvironment","b","clear","key","Object","entries","undefined","set","_fireEnvChange","startEnvironmentSingleVar","setEnvironmentSingleVar","endEnvironmentSingleVar","envDiffers","deleteEnvironmentSingleVar","delete","fire","fromEntries"],"sources":["/home/user/Desktop/MintMind/src/vs/platform/terminal/common/capabilities/shellEnvDetectionCapability.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { IShellEnvDetectionCapability, TerminalCapability, TerminalShellIntegrationEnvironment } from './capabilities.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { equals } from '../../../../base/common/objects.js';\nimport { mapsStrictEqualIgnoreOrder } from '../../../../base/common/map.js';\n\nexport interface IShellEnv {\n\tvalue: Map<string, string>;\n\tisTrusted: boolean;\n}\n\nexport class ShellEnvDetectionCapability extends Disposable implements IShellEnvDetectionCapability {\n\treadonly type = TerminalCapability.ShellEnvDetection;\n\n\tprivate _pendingEnv: IShellEnv | undefined;\n\tprivate _env: IShellEnv = { value: new Map(), isTrusted: true };\n\n\tget env(): TerminalShellIntegrationEnvironment {\n\t\treturn this._createStateObject();\n\t}\n\n\tprivate readonly _onDidChangeEnv = this._register(new Emitter<TerminalShellIntegrationEnvironment>());\n\treadonly onDidChangeEnv = this._onDidChangeEnv.event;\n\n\tsetEnvironment(env: { [key: string]: string | undefined }, isTrusted: boolean): void {\n\t\tif (equals(this.env.value, env)) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._env.value.clear();\n\t\tfor (const [key, value] of Object.entries(env)) {\n\t\t\tif (value !== undefined) {\n\t\t\t\tthis._env.value.set(key, value);\n\t\t\t}\n\t\t}\n\t\tthis._env.isTrusted = isTrusted;\n\n\t\tthis._fireEnvChange();\n\t}\n\n\tstartEnvironmentSingleVar(clear: boolean, isTrusted: boolean): void {\n\t\tif (clear) {\n\t\t\tthis._pendingEnv = {\n\t\t\t\tvalue: new Map(),\n\t\t\t\tisTrusted\n\t\t\t};\n\t\t} else {\n\t\t\tthis._pendingEnv = {\n\t\t\t\tvalue: new Map(this._env.value),\n\t\t\t\tisTrusted: this._env.isTrusted && isTrusted\n\t\t\t};\n\t\t}\n\n\t}\n\n\tsetEnvironmentSingleVar(key: string, value: string | undefined, isTrusted: boolean): void {\n\t\tif (!this._pendingEnv) {\n\t\t\treturn;\n\t\t}\n\t\tif (key !== undefined && value !== undefined) {\n\t\t\tthis._pendingEnv.value.set(key, value);\n\t\t\tthis._pendingEnv.isTrusted &&= isTrusted;\n\t\t}\n\t}\n\n\tendEnvironmentSingleVar(isTrusted: boolean): void {\n\t\tif (!this._pendingEnv) {\n\t\t\treturn;\n\t\t}\n\t\tthis._pendingEnv.isTrusted &&= isTrusted;\n\t\tconst envDiffers = !mapsStrictEqualIgnoreOrder(this._env.value, this._pendingEnv.value);\n\t\tif (envDiffers) {\n\t\t\tthis._env = this._pendingEnv;\n\t\t\tthis._fireEnvChange();\n\t\t}\n\t\tthis._pendingEnv = undefined;\n\t}\n\n\tdeleteEnvironmentSingleVar(key: string, value: string | undefined, isTrusted: boolean): void {\n\t\tif (!this._pendingEnv) {\n\t\t\treturn;\n\t\t}\n\t\tif (key !== undefined && value !== undefined) {\n\t\t\tthis._pendingEnv.value.delete(key);\n\t\t\tthis._pendingEnv.isTrusted &&= isTrusted;\n\t\t}\n\t}\n\n\tprivate _fireEnvChange(): void {\n\t\tthis._onDidChangeEnv.fire(this._createStateObject());\n\t}\n\n\tprivate _createStateObject(): TerminalShellIntegrationEnvironment {\n\t\treturn {\n\t\t\tvalue: Object.fromEntries(this._env.value),\n\t\t\tisTrusted: this._env.isTrusted\n\t\t};\n\t}\n}\n"],"mappings":"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","ignoreList":[]}