{"version":3,"names":["AbstractSignService","_nextId","cov_11zeotgnhm","s","validators","Map","createNewMessage","value","f","validator","getValidator","b","id","String","set","data","e","validate","message","get","delete","dispose","sign","signValue"],"sources":["/home/user/Desktop/MintMind/src/vs/platform/sign/common/abstractSignService.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IMessage, ISignService } from './sign.js';\n\nexport interface IVsdaSigner {\n\tsign(arg: string): string;\n}\n\nexport interface IVsdaValidator {\n\tcreateNewMessage(arg: string): string;\n\tvalidate(arg: string): 'ok' | 'error';\n\tdispose?(): void;\n}\n\nexport abstract class AbstractSignService implements ISignService {\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate static _nextId = 1;\n\tprivate readonly validators = new Map<string, IVsdaValidator>();\n\n\tprotected abstract getValidator(): Promise<IVsdaValidator>;\n\tprotected abstract signValue(arg: string): Promise<string>;\n\n\tpublic async createNewMessage(value: string): Promise<IMessage> {\n\t\ttry {\n\t\t\tconst validator = await this.getValidator();\n\t\t\tif (validator) {\n\t\t\t\tconst id = String(AbstractSignService._nextId++);\n\t\t\t\tthis.validators.set(id, validator);\n\t\t\t\treturn {\n\t\t\t\t\tid: id,\n\t\t\t\t\tdata: validator.createNewMessage(value)\n\t\t\t\t};\n\t\t\t}\n\t\t} catch (e) {\n\t\t\t// ignore errors silently\n\t\t}\n\t\treturn { id: '', data: value };\n\t}\n\n\tasync validate(message: IMessage, value: string): Promise<boolean> {\n\t\tif (!message.id) {\n\t\t\treturn true;\n\t\t}\n\n\t\tconst validator = this.validators.get(message.id);\n\t\tif (!validator) {\n\t\t\treturn false;\n\t\t}\n\t\tthis.validators.delete(message.id);\n\t\ttry {\n\t\t\treturn (validator.validate(value) === 'ok');\n\t\t} catch (e) {\n\t\t\t// ignore errors silently\n\t\t\treturn false;\n\t\t} finally {\n\t\t\tvalidator.dispose?.();\n\t\t}\n\t}\n\n\tasync sign(value: string): Promise<string> {\n\t\ttry {\n\t\t\treturn await this.signValue(value);\n\t\t} catch (e) {\n\t\t\t// ignore errors silently\n\t\t}\n\t\treturn value;\n\t}\n}\n"],"mappings":"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","ignoreList":[]}