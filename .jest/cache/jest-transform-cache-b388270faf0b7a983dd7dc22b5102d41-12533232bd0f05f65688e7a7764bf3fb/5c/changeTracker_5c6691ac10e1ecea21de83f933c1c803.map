{"version":3,"names":["BugIndicatingError","recordChanges","obs","cov_20rry5li3r","f","s","createChangeSummary","_previousChangeSummary","changes","handleChange","ctx","changeSummary","key","didChange","b","push","change","beforeUpdate","reader","read","recordChangesLazy","getObs","undefined"],"sources":["/home/user/Desktop/MintMind/src/vs/base/common/observableInternal/changeTracker.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { BugIndicatingError } from './commonFacade/deps.js';\nimport { IObservableWithChange, IReader } from './base.js';\n\nexport interface IChangeTracker<TChangeSummary> {\n\tcreateChangeSummary(previousChangeSummary: TChangeSummary | undefined): TChangeSummary;\n\thandleChange(ctx: IChangeContext, change: TChangeSummary): boolean;\n\tbeforeUpdate?(reader: IReader, change: TChangeSummary): void;\n}\n\nexport interface IChangeContext {\n\treadonly changedObservable: IObservableWithChange<any, any>;\n\treadonly change: unknown;\n\n\t/**\n\t * Returns if the given observable caused the change.\n\t */\n\tdidChange<T, TChange>(observable: IObservableWithChange<T, TChange>): this is { change: TChange };\n}\n\n/**\n * Subscribes to and records changes and the last value of the given observables.\n * Don't use the key \"changes\", as it is reserved for the changes array!\n*/\nexport function recordChanges<TObs extends Record<any, IObservableWithChange<any, any>>>(obs: TObs):\n\tIChangeTracker<{ [TKey in keyof TObs]: ReturnType<TObs[TKey]['get']> }\n\t\t& { changes: readonly ({ [TKey in keyof TObs]: { key: TKey; change: TObs[TKey]['TChange'] } }[keyof TObs])[] }> {\n\treturn {\n\t\tcreateChangeSummary: (_previousChangeSummary) => {\n\t\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\t\treturn {\n\t\t\t\tchanges: [],\n\t\t\t} as any;\n\t\t},\n\t\thandleChange(ctx, changeSummary) {\n\t\t\tfor (const key in obs) {\n\t\t\t\tif (ctx.didChange(obs[key])) {\n\t\t\t\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\t\t\t\t(changeSummary.changes as any).push({ key, change: ctx.change });\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\t\tbeforeUpdate(reader, changeSummary) {\n\t\t\tfor (const key in obs) {\n\t\t\t\tif (key === 'changes') {\n\t\t\t\t\tthrow new BugIndicatingError('property name \"changes\" is reserved for change tracking');\n\t\t\t\t}\n\t\t\t\tchangeSummary[key] = obs[key].read(reader);\n\t\t\t}\n\t\t}\n\t};\n}\n\n/**\n * Subscribes to and records changes and the last value of the given observables.\n * Don't use the key \"changes\", as it is reserved for the changes array!\n*/\nexport function recordChangesLazy<TObs extends Record<any, IObservableWithChange<any, any>>>(getObs: () => TObs):\n\tIChangeTracker<{ [TKey in keyof TObs]: ReturnType<TObs[TKey]['get']> }\n\t\t& { changes: readonly ({ [TKey in keyof TObs]: { key: TKey; change: TObs[TKey]['TChange'] } }[keyof TObs])[] }> {\n\tlet obs: TObs | undefined = undefined;\n\treturn {\n\t\tcreateChangeSummary: (_previousChangeSummary) => {\n\t\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\t\treturn {\n\t\t\t\tchanges: [],\n\t\t\t} as any;\n\t\t},\n\t\thandleChange(ctx, changeSummary) {\n\t\t\tif (!obs) {\n\t\t\t\tobs = getObs();\n\t\t\t}\n\t\t\tfor (const key in obs) {\n\t\t\t\tif (ctx.didChange(obs[key])) {\n\t\t\t\t\t// eslint-disable-next-line local/code-no-any-casts\n\t\t\t\t\t(changeSummary.changes as any).push({ key, change: ctx.change });\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\t\tbeforeUpdate(reader, changeSummary) {\n\t\t\tif (!obs) {\n\t\t\t\tobs = getObs();\n\t\t\t}\n\t\t\tfor (const key in obs) {\n\t\t\t\tif (key === 'changes') {\n\t\t\t\t\tthrow new BugIndicatingError('property name \"changes\" is reserved for change tracking');\n\t\t\t\t}\n\t\t\t\tchangeSummary[key] = obs[key].read(reader);\n\t\t\t}\n\t\t}\n\t};\n}\n"],"mappings":"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","ignoreList":[]}